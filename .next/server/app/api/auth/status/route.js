"use strict";
/*
 * ATTENTION: An "eval-source-map" devtool has been used.
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file with attached SourceMaps in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
(() => {
var exports = {};
exports.id = "app/api/auth/status/route";
exports.ids = ["app/api/auth/status/route"];
exports.modules = {

/***/ "../../client/components/action-async-storage.external":
/*!*******************************************************************************!*\
  !*** external "next/dist/client/components/action-async-storage.external.js" ***!
  \*******************************************************************************/
/***/ ((module) => {

module.exports = require("next/dist/client/components/action-async-storage.external.js");

/***/ }),

/***/ "../../client/components/request-async-storage.external":
/*!********************************************************************************!*\
  !*** external "next/dist/client/components/request-async-storage.external.js" ***!
  \********************************************************************************/
/***/ ((module) => {

module.exports = require("next/dist/client/components/request-async-storage.external.js");

/***/ }),

/***/ "../../client/components/static-generation-async-storage.external":
/*!******************************************************************************************!*\
  !*** external "next/dist/client/components/static-generation-async-storage.external.js" ***!
  \******************************************************************************************/
/***/ ((module) => {

module.exports = require("next/dist/client/components/static-generation-async-storage.external.js");

/***/ }),

/***/ "next/dist/compiled/next-server/app-route.runtime.dev.js":
/*!**************************************************************************!*\
  !*** external "next/dist/compiled/next-server/app-route.runtime.dev.js" ***!
  \**************************************************************************/
/***/ ((module) => {

module.exports = require("next/dist/compiled/next-server/app-route.runtime.dev.js");

/***/ }),

/***/ "assert":
/*!*************************!*\
  !*** external "assert" ***!
  \*************************/
/***/ ((module) => {

module.exports = require("assert");

/***/ }),

/***/ "buffer":
/*!*************************!*\
  !*** external "buffer" ***!
  \*************************/
/***/ ((module) => {

module.exports = require("buffer");

/***/ }),

/***/ "crypto":
/*!*************************!*\
  !*** external "crypto" ***!
  \*************************/
/***/ ((module) => {

module.exports = require("crypto");

/***/ }),

/***/ "events":
/*!*************************!*\
  !*** external "events" ***!
  \*************************/
/***/ ((module) => {

module.exports = require("events");

/***/ }),

/***/ "fs":
/*!*********************!*\
  !*** external "fs" ***!
  \*********************/
/***/ ((module) => {

module.exports = require("fs");

/***/ }),

/***/ "http":
/*!***********************!*\
  !*** external "http" ***!
  \***********************/
/***/ ((module) => {

module.exports = require("http");

/***/ }),

/***/ "https":
/*!************************!*\
  !*** external "https" ***!
  \************************/
/***/ ((module) => {

module.exports = require("https");

/***/ }),

/***/ "net":
/*!**********************!*\
  !*** external "net" ***!
  \**********************/
/***/ ((module) => {

module.exports = require("net");

/***/ }),

/***/ "os":
/*!*********************!*\
  !*** external "os" ***!
  \*********************/
/***/ ((module) => {

module.exports = require("os");

/***/ }),

/***/ "path":
/*!***********************!*\
  !*** external "path" ***!
  \***********************/
/***/ ((module) => {

module.exports = require("path");

/***/ }),

/***/ "punycode":
/*!***************************!*\
  !*** external "punycode" ***!
  \***************************/
/***/ ((module) => {

module.exports = require("punycode");

/***/ }),

/***/ "querystring":
/*!******************************!*\
  !*** external "querystring" ***!
  \******************************/
/***/ ((module) => {

module.exports = require("querystring");

/***/ }),

/***/ "stream":
/*!*************************!*\
  !*** external "stream" ***!
  \*************************/
/***/ ((module) => {

module.exports = require("stream");

/***/ }),

/***/ "string_decoder":
/*!*********************************!*\
  !*** external "string_decoder" ***!
  \*********************************/
/***/ ((module) => {

module.exports = require("string_decoder");

/***/ }),

/***/ "tls":
/*!**********************!*\
  !*** external "tls" ***!
  \**********************/
/***/ ((module) => {

module.exports = require("tls");

/***/ }),

/***/ "tty":
/*!**********************!*\
  !*** external "tty" ***!
  \**********************/
/***/ ((module) => {

module.exports = require("tty");

/***/ }),

/***/ "url":
/*!**********************!*\
  !*** external "url" ***!
  \**********************/
/***/ ((module) => {

module.exports = require("url");

/***/ }),

/***/ "util":
/*!***********************!*\
  !*** external "util" ***!
  \***********************/
/***/ ((module) => {

module.exports = require("util");

/***/ }),

/***/ "zlib":
/*!***********************!*\
  !*** external "zlib" ***!
  \***********************/
/***/ ((module) => {

module.exports = require("zlib");

/***/ }),

/***/ "(rsc)/./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Fauth%2Fstatus%2Froute&page=%2Fapi%2Fauth%2Fstatus%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fauth%2Fstatus%2Froute.ts&appDir=C%3A%5CInvoiveManagment%5Csrc%5Capp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=C%3A%5CInvoiveManagment&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D!":
/*!***********************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************!*\
  !*** ./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Fauth%2Fstatus%2Froute&page=%2Fapi%2Fauth%2Fstatus%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fauth%2Fstatus%2Froute.ts&appDir=C%3A%5CInvoiveManagment%5Csrc%5Capp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=C%3A%5CInvoiveManagment&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D! ***!
  \***********************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   headerHooks: () => (/* binding */ headerHooks),\n/* harmony export */   originalPathname: () => (/* binding */ originalPathname),\n/* harmony export */   patchFetch: () => (/* binding */ patchFetch),\n/* harmony export */   requestAsyncStorage: () => (/* binding */ requestAsyncStorage),\n/* harmony export */   routeModule: () => (/* binding */ routeModule),\n/* harmony export */   serverHooks: () => (/* binding */ serverHooks),\n/* harmony export */   staticGenerationAsyncStorage: () => (/* binding */ staticGenerationAsyncStorage),\n/* harmony export */   staticGenerationBailout: () => (/* binding */ staticGenerationBailout)\n/* harmony export */ });\n/* harmony import */ var next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! next/dist/server/future/route-modules/app-route/module.compiled */ \"(rsc)/./node_modules/next/dist/server/future/route-modules/app-route/module.compiled.js\");\n/* harmony import */ var next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var next_dist_server_future_route_kind__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! next/dist/server/future/route-kind */ \"(rsc)/./node_modules/next/dist/server/future/route-kind.js\");\n/* harmony import */ var next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! next/dist/server/lib/patch-fetch */ \"(rsc)/./node_modules/next/dist/server/lib/patch-fetch.js\");\n/* harmony import */ var next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2__);\n/* harmony import */ var C_InvoiveManagment_src_app_api_auth_status_route_ts__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./src/app/api/auth/status/route.ts */ \"(rsc)/./src/app/api/auth/status/route.ts\");\n\n\n\n\n// We inject the nextConfigOutput here so that we can use them in the route\n// module.\nconst nextConfigOutput = \"\"\nconst routeModule = new next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__.AppRouteRouteModule({\n    definition: {\n        kind: next_dist_server_future_route_kind__WEBPACK_IMPORTED_MODULE_1__.RouteKind.APP_ROUTE,\n        page: \"/api/auth/status/route\",\n        pathname: \"/api/auth/status\",\n        filename: \"route\",\n        bundlePath: \"app/api/auth/status/route\"\n    },\n    resolvedPagePath: \"C:\\\\InvoiveManagment\\\\src\\\\app\\\\api\\\\auth\\\\status\\\\route.ts\",\n    nextConfigOutput,\n    userland: C_InvoiveManagment_src_app_api_auth_status_route_ts__WEBPACK_IMPORTED_MODULE_3__\n});\n// Pull out the exports that we need to expose from the module. This should\n// be eliminated when we've moved the other routes to the new format. These\n// are used to hook into the route.\nconst { requestAsyncStorage, staticGenerationAsyncStorage, serverHooks, headerHooks, staticGenerationBailout } = routeModule;\nconst originalPathname = \"/api/auth/status/route\";\nfunction patchFetch() {\n    return (0,next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2__.patchFetch)({\n        serverHooks,\n        staticGenerationAsyncStorage\n    });\n}\n\n\n//# sourceMappingURL=app-route.js.map//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9ub2RlX21vZHVsZXMvbmV4dC9kaXN0L2J1aWxkL3dlYnBhY2svbG9hZGVycy9uZXh0LWFwcC1sb2FkZXIuanM/bmFtZT1hcHAlMkZhcGklMkZhdXRoJTJGc3RhdHVzJTJGcm91dGUmcGFnZT0lMkZhcGklMkZhdXRoJTJGc3RhdHVzJTJGcm91dGUmYXBwUGF0aHM9JnBhZ2VQYXRoPXByaXZhdGUtbmV4dC1hcHAtZGlyJTJGYXBpJTJGYXV0aCUyRnN0YXR1cyUyRnJvdXRlLnRzJmFwcERpcj1DJTNBJTVDSW52b2l2ZU1hbmFnbWVudCU1Q3NyYyU1Q2FwcCZwYWdlRXh0ZW5zaW9ucz10c3gmcGFnZUV4dGVuc2lvbnM9dHMmcGFnZUV4dGVuc2lvbnM9anN4JnBhZ2VFeHRlbnNpb25zPWpzJnJvb3REaXI9QyUzQSU1Q0ludm9pdmVNYW5hZ21lbnQmaXNEZXY9dHJ1ZSZ0c2NvbmZpZ1BhdGg9dHNjb25maWcuanNvbiZiYXNlUGF0aD0mYXNzZXRQcmVmaXg9Jm5leHRDb25maWdPdXRwdXQ9JnByZWZlcnJlZFJlZ2lvbj0mbWlkZGxld2FyZUNvbmZpZz1lMzAlM0QhIiwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7Ozs7Ozs7O0FBQXNHO0FBQ3ZDO0FBQ2M7QUFDVztBQUN4RjtBQUNBO0FBQ0E7QUFDQSx3QkFBd0IsZ0hBQW1CO0FBQzNDO0FBQ0EsY0FBYyx5RUFBUztBQUN2QjtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0EsWUFBWTtBQUNaLENBQUM7QUFDRDtBQUNBO0FBQ0E7QUFDQSxRQUFRLHVHQUF1RztBQUMvRztBQUNBO0FBQ0EsV0FBVyw0RUFBVztBQUN0QjtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQzZKOztBQUU3SiIsInNvdXJjZXMiOlsid2VicGFjazovL2ludm9pY2UtYXBwLz85ODFiIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IEFwcFJvdXRlUm91dGVNb2R1bGUgfSBmcm9tIFwibmV4dC9kaXN0L3NlcnZlci9mdXR1cmUvcm91dGUtbW9kdWxlcy9hcHAtcm91dGUvbW9kdWxlLmNvbXBpbGVkXCI7XG5pbXBvcnQgeyBSb3V0ZUtpbmQgfSBmcm9tIFwibmV4dC9kaXN0L3NlcnZlci9mdXR1cmUvcm91dGUta2luZFwiO1xuaW1wb3J0IHsgcGF0Y2hGZXRjaCBhcyBfcGF0Y2hGZXRjaCB9IGZyb20gXCJuZXh0L2Rpc3Qvc2VydmVyL2xpYi9wYXRjaC1mZXRjaFwiO1xuaW1wb3J0ICogYXMgdXNlcmxhbmQgZnJvbSBcIkM6XFxcXEludm9pdmVNYW5hZ21lbnRcXFxcc3JjXFxcXGFwcFxcXFxhcGlcXFxcYXV0aFxcXFxzdGF0dXNcXFxccm91dGUudHNcIjtcbi8vIFdlIGluamVjdCB0aGUgbmV4dENvbmZpZ091dHB1dCBoZXJlIHNvIHRoYXQgd2UgY2FuIHVzZSB0aGVtIGluIHRoZSByb3V0ZVxuLy8gbW9kdWxlLlxuY29uc3QgbmV4dENvbmZpZ091dHB1dCA9IFwiXCJcbmNvbnN0IHJvdXRlTW9kdWxlID0gbmV3IEFwcFJvdXRlUm91dGVNb2R1bGUoe1xuICAgIGRlZmluaXRpb246IHtcbiAgICAgICAga2luZDogUm91dGVLaW5kLkFQUF9ST1VURSxcbiAgICAgICAgcGFnZTogXCIvYXBpL2F1dGgvc3RhdHVzL3JvdXRlXCIsXG4gICAgICAgIHBhdGhuYW1lOiBcIi9hcGkvYXV0aC9zdGF0dXNcIixcbiAgICAgICAgZmlsZW5hbWU6IFwicm91dGVcIixcbiAgICAgICAgYnVuZGxlUGF0aDogXCJhcHAvYXBpL2F1dGgvc3RhdHVzL3JvdXRlXCJcbiAgICB9LFxuICAgIHJlc29sdmVkUGFnZVBhdGg6IFwiQzpcXFxcSW52b2l2ZU1hbmFnbWVudFxcXFxzcmNcXFxcYXBwXFxcXGFwaVxcXFxhdXRoXFxcXHN0YXR1c1xcXFxyb3V0ZS50c1wiLFxuICAgIG5leHRDb25maWdPdXRwdXQsXG4gICAgdXNlcmxhbmRcbn0pO1xuLy8gUHVsbCBvdXQgdGhlIGV4cG9ydHMgdGhhdCB3ZSBuZWVkIHRvIGV4cG9zZSBmcm9tIHRoZSBtb2R1bGUuIFRoaXMgc2hvdWxkXG4vLyBiZSBlbGltaW5hdGVkIHdoZW4gd2UndmUgbW92ZWQgdGhlIG90aGVyIHJvdXRlcyB0byB0aGUgbmV3IGZvcm1hdC4gVGhlc2Vcbi8vIGFyZSB1c2VkIHRvIGhvb2sgaW50byB0aGUgcm91dGUuXG5jb25zdCB7IHJlcXVlc3RBc3luY1N0b3JhZ2UsIHN0YXRpY0dlbmVyYXRpb25Bc3luY1N0b3JhZ2UsIHNlcnZlckhvb2tzLCBoZWFkZXJIb29rcywgc3RhdGljR2VuZXJhdGlvbkJhaWxvdXQgfSA9IHJvdXRlTW9kdWxlO1xuY29uc3Qgb3JpZ2luYWxQYXRobmFtZSA9IFwiL2FwaS9hdXRoL3N0YXR1cy9yb3V0ZVwiO1xuZnVuY3Rpb24gcGF0Y2hGZXRjaCgpIHtcbiAgICByZXR1cm4gX3BhdGNoRmV0Y2goe1xuICAgICAgICBzZXJ2ZXJIb29rcyxcbiAgICAgICAgc3RhdGljR2VuZXJhdGlvbkFzeW5jU3RvcmFnZVxuICAgIH0pO1xufVxuZXhwb3J0IHsgcm91dGVNb2R1bGUsIHJlcXVlc3RBc3luY1N0b3JhZ2UsIHN0YXRpY0dlbmVyYXRpb25Bc3luY1N0b3JhZ2UsIHNlcnZlckhvb2tzLCBoZWFkZXJIb29rcywgc3RhdGljR2VuZXJhdGlvbkJhaWxvdXQsIG9yaWdpbmFsUGF0aG5hbWUsIHBhdGNoRmV0Y2gsICB9O1xuXG4vLyMgc291cmNlTWFwcGluZ1VSTD1hcHAtcm91dGUuanMubWFwIl0sIm5hbWVzIjpbXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(rsc)/./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Fauth%2Fstatus%2Froute&page=%2Fapi%2Fauth%2Fstatus%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fauth%2Fstatus%2Froute.ts&appDir=C%3A%5CInvoiveManagment%5Csrc%5Capp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=C%3A%5CInvoiveManagment&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D!\n");

/***/ }),

/***/ "(rsc)/./src/app/api/auth/status/route.ts":
/*!******************************************!*\
  !*** ./src/app/api/auth/status/route.ts ***!
  \******************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   GET: () => (/* binding */ GET),\n/* harmony export */   POST: () => (/* binding */ POST)\n/* harmony export */ });\n/* harmony import */ var next_dist_server_web_exports_next_response__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! next/dist/server/web/exports/next-response */ \"(rsc)/./node_modules/next/dist/server/web/exports/next-response.js\");\n/* harmony import */ var next_headers__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! next/headers */ \"(rsc)/./node_modules/next/dist/api/headers.js\");\n/* harmony import */ var _lib_quickbooks_api__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! @/lib/quickbooks/api */ \"(rsc)/./src/lib/quickbooks/api.ts\");\n\n\n\nasync function GET() {\n    console.error(\"⭐ Auth status check initiated\");\n    try {\n        console.log(\"Checking QuickBooks authentication status\");\n        // First check cookies directly to avoid unnecessary imports if tokens don't exist\n        const cookieStore = (0,next_headers__WEBPACK_IMPORTED_MODULE_1__.cookies)();\n        const accessTokenCookie = cookieStore.get(_lib_quickbooks_api__WEBPACK_IMPORTED_MODULE_2__.TOKEN_KEY);\n        const realmIdCookie = cookieStore.get(_lib_quickbooks_api__WEBPACK_IMPORTED_MODULE_2__.REALM_ID_KEY);\n        console.error(\"⭐ Auth cookies check:\", {\n            hasAccessToken: !!accessTokenCookie,\n            hasRealmId: !!realmIdCookie\n        });\n        // If no cookies, we can return early\n        if (!accessTokenCookie || !realmIdCookie) {\n            console.error(\"⭐ Missing required auth cookies\");\n            return next_dist_server_web_exports_next_response__WEBPACK_IMPORTED_MODULE_0__[\"default\"].json({\n                authenticated: false,\n                message: \"QuickBooks authentication required - no auth tokens found\",\n                cookieCheck: {\n                    hasAccessToken: !!accessTokenCookie,\n                    hasRealmId: !!realmIdCookie\n                }\n            });\n        }\n        // Import checkClientInitialized from the API module\n        // We need to do this dynamically to avoid importing the function directly\n        // which would cause the error to be thrown immediately if not authenticated\n        console.error(\"⭐ Importing QuickBooks API modules\");\n        const { checkClientInitialized, qbo } = await Promise.resolve(/*! import() */).then(__webpack_require__.bind(__webpack_require__, /*! @/lib/quickbooks/api */ \"(rsc)/./src/lib/quickbooks/api.ts\"));\n        try {\n            // Try to check if the client is initialized\n            console.error(\"⭐ Checking if QuickBooks client is initialized\");\n            checkClientInitialized();\n            // Get basic client info for debugging\n            const qboInfo = qbo ? {\n                hasAccessToken: !!qbo.accessToken,\n                hasRealmId: !!qbo.realmId,\n                oauthVersion: qbo.oauthversion || \"unknown\"\n            } : null;\n            // If no error is thrown, the client is initialized\n            console.error(\"⭐ QuickBooks client is initialized:\", qboInfo);\n            return next_dist_server_web_exports_next_response__WEBPACK_IMPORTED_MODULE_0__[\"default\"].json({\n                authenticated: true,\n                message: \"QuickBooks client is initialized and ready\",\n                clientInfo: qboInfo\n            });\n        } catch (error) {\n            // If an error is thrown, the client is not initialized\n            console.error(\"⭐ QuickBooks client initialization failed:\", error instanceof Error ? error.message : \"Unknown error\");\n            return next_dist_server_web_exports_next_response__WEBPACK_IMPORTED_MODULE_0__[\"default\"].json({\n                authenticated: false,\n                message: \"QuickBooks client is not initialized\",\n                error: error instanceof Error ? error.message : \"Unknown error\",\n                cookieCheck: {\n                    hasAccessToken: !!accessTokenCookie,\n                    hasRealmId: !!realmIdCookie\n                }\n            });\n        }\n    } catch (error) {\n        console.error(\"⭐ Error checking QuickBooks auth status:\", error);\n        return next_dist_server_web_exports_next_response__WEBPACK_IMPORTED_MODULE_0__[\"default\"].json({\n            authenticated: false,\n            error: \"Error checking QuickBooks authentication status\",\n            details: error instanceof Error ? error.message : \"Unknown error\"\n        }, {\n            status: 500\n        });\n    }\n}\nasync function POST() {\n    console.error(\"⭐ Manual QuickBooks initialization requested\");\n    try {\n        // Import the initialization function\n        const { manuallyInitializeQuickBooks } = await Promise.resolve(/*! import() */).then(__webpack_require__.bind(__webpack_require__, /*! @/lib/quickbooks/api */ \"(rsc)/./src/lib/quickbooks/api.ts\"));\n        // Call the function\n        console.error(\"⭐ Calling manuallyInitializeQuickBooks function\");\n        const result = manuallyInitializeQuickBooks();\n        console.error(\"⭐ Manual initialization result:\", result);\n        // Return the result\n        return next_dist_server_web_exports_next_response__WEBPACK_IMPORTED_MODULE_0__[\"default\"].json({\n            success: result,\n            message: result ? \"Manual initialization successful\" : \"Manual initialization failed\"\n        });\n    } catch (error) {\n        console.error(\"⭐ Error during manual initialization:\", error);\n        return next_dist_server_web_exports_next_response__WEBPACK_IMPORTED_MODULE_0__[\"default\"].json({\n            success: false,\n            error: \"Error during manual initialization\",\n            details: error instanceof Error ? error.message : \"Unknown error\"\n        }, {\n            status: 500\n        });\n    }\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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Q2RELFFBQVFDLEtBQUssQ0FBQyx5Q0FBeUNBO1FBRXZELE9BQU9OLGtGQUFZQSxDQUFDYyxJQUFJLENBQ3RCO1lBQ0VrQixTQUFTO1lBQ1QxQixPQUFPO1lBQ1BxQixTQUFTckIsaUJBQWlCb0IsUUFBUXBCLE1BQU1VLE9BQU8sR0FBRztRQUNwRCxHQUNBO1lBQUVZLFFBQVE7UUFBSTtJQUVsQjtBQUNGIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vaW52b2ljZS1hcHAvLi9zcmMvYXBwL2FwaS9hdXRoL3N0YXR1cy9yb3V0ZS50cz85ZWJhIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IE5leHRSZXNwb25zZSB9IGZyb20gJ25leHQvc2VydmVyJ1xyXG5pbXBvcnQgeyBjb29raWVzIH0gZnJvbSAnbmV4dC9oZWFkZXJzJ1xyXG5pbXBvcnQgeyBUT0tFTl9LRVksIFJFQUxNX0lEX0tFWSB9IGZyb20gJ0AvbGliL3F1aWNrYm9va3MvYXBpJ1xyXG5cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIEdFVCgpIHtcclxuICBjb25zb2xlLmVycm9yKCfirZAgQXV0aCBzdGF0dXMgY2hlY2sgaW5pdGlhdGVkJyk7XHJcbiAgdHJ5IHtcclxuICAgIGNvbnNvbGUubG9nKCdDaGVja2luZyBRdWlja0Jvb2tzIGF1dGhlbnRpY2F0aW9uIHN0YXR1cycpO1xyXG4gICAgXHJcbiAgICAvLyBGaXJzdCBjaGVjayBjb29raWVzIGRpcmVjdGx5IHRvIGF2b2lkIHVubmVjZXNzYXJ5IGltcG9ydHMgaWYgdG9rZW5zIGRvbid0IGV4aXN0XHJcbiAgICBjb25zdCBjb29raWVTdG9yZSA9IGNvb2tpZXMoKTtcclxuICAgIGNvbnN0IGFjY2Vzc1Rva2VuQ29va2llID0gY29va2llU3RvcmUuZ2V0KFRPS0VOX0tFWSk7XHJcbiAgICBjb25zdCByZWFsbUlkQ29va2llID0gY29va2llU3RvcmUuZ2V0KFJFQUxNX0lEX0tFWSk7XHJcbiAgICBcclxuICAgIGNvbnNvbGUuZXJyb3IoJ+KtkCBBdXRoIGNvb2tpZXMgY2hlY2s6Jywge1xyXG4gICAgICBoYXNBY2Nlc3NUb2tlbjogISFhY2Nlc3NUb2tlbkNvb2tpZSxcclxuICAgICAgaGFzUmVhbG1JZDogISFyZWFsbUlkQ29va2llXHJcbiAgICB9KTtcclxuICAgIFxyXG4gICAgLy8gSWYgbm8gY29va2llcywgd2UgY2FuIHJldHVybiBlYXJseVxyXG4gICAgaWYgKCFhY2Nlc3NUb2tlbkNvb2tpZSB8fCAhcmVhbG1JZENvb2tpZSkge1xyXG4gICAgICBjb25zb2xlLmVycm9yKCfirZAgTWlzc2luZyByZXF1aXJlZCBhdXRoIGNvb2tpZXMnKTtcclxuICAgICAgcmV0dXJuIE5leHRSZXNwb25zZS5qc29uKHsgXHJcbiAgICAgICAgYXV0aGVudGljYXRlZDogZmFsc2UsXHJcbiAgICAgICAgbWVzc2FnZTogJ1F1aWNrQm9va3MgYXV0aGVudGljYXRpb24gcmVxdWlyZWQgLSBubyBhdXRoIHRva2VucyBmb3VuZCcsXHJcbiAgICAgICAgY29va2llQ2hlY2s6IHtcclxuICAgICAgICAgIGhhc0FjY2Vzc1Rva2VuOiAhIWFjY2Vzc1Rva2VuQ29va2llLFxyXG4gICAgICAgICAgaGFzUmVhbG1JZDogISFyZWFsbUlkQ29va2llXHJcbiAgICAgICAgfVxyXG4gICAgICB9KTtcclxuICAgIH1cclxuICAgIFxyXG4gICAgLy8gSW1wb3J0IGNoZWNrQ2xpZW50SW5pdGlhbGl6ZWQgZnJvbSB0aGUgQVBJIG1vZHVsZVxyXG4gICAgLy8gV2UgbmVlZCB0byBkbyB0aGlzIGR5bmFtaWNhbGx5IHRvIGF2b2lkIGltcG9ydGluZyB0aGUgZnVuY3Rpb24gZGlyZWN0bHlcclxuICAgIC8vIHdoaWNoIHdvdWxkIGNhdXNlIHRoZSBlcnJvciB0byBiZSB0aHJvd24gaW1tZWRpYXRlbHkgaWYgbm90IGF1dGhlbnRpY2F0ZWRcclxuICAgIGNvbnNvbGUuZXJyb3IoJ+KtkCBJbXBvcnRpbmcgUXVpY2tCb29rcyBBUEkgbW9kdWxlcycpO1xyXG4gICAgY29uc3QgeyBjaGVja0NsaWVudEluaXRpYWxpemVkLCBxYm8gfSA9IGF3YWl0IGltcG9ydCgnQC9saWIvcXVpY2tib29rcy9hcGknKTtcclxuICAgIFxyXG4gICAgdHJ5IHtcclxuICAgICAgLy8gVHJ5IHRvIGNoZWNrIGlmIHRoZSBjbGllbnQgaXMgaW5pdGlhbGl6ZWRcclxuICAgICAgY29uc29sZS5lcnJvcign4q2QIENoZWNraW5nIGlmIFF1aWNrQm9va3MgY2xpZW50IGlzIGluaXRpYWxpemVkJyk7XHJcbiAgICAgIGNoZWNrQ2xpZW50SW5pdGlhbGl6ZWQoKTtcclxuICAgICAgXHJcbiAgICAgIC8vIEdldCBiYXNpYyBjbGllbnQgaW5mbyBmb3IgZGVidWdnaW5nXHJcbiAgICAgIGNvbnN0IHFib0luZm8gPSBxYm8gPyB7XHJcbiAgICAgICAgaGFzQWNjZXNzVG9rZW46ICEhKHFibyBhcyBhbnkpLmFjY2Vzc1Rva2VuLFxyXG4gICAgICAgIGhhc1JlYWxtSWQ6ICEhKHFibyBhcyBhbnkpLnJlYWxtSWQsXHJcbiAgICAgICAgb2F1dGhWZXJzaW9uOiAocWJvIGFzIGFueSkub2F1dGh2ZXJzaW9uIHx8ICd1bmtub3duJ1xyXG4gICAgICB9IDogbnVsbDtcclxuICAgICAgXHJcbiAgICAgIC8vIElmIG5vIGVycm9yIGlzIHRocm93biwgdGhlIGNsaWVudCBpcyBpbml0aWFsaXplZFxyXG4gICAgICBjb25zb2xlLmVycm9yKCfirZAgUXVpY2tCb29rcyBjbGllbnQgaXMgaW5pdGlhbGl6ZWQ6JywgcWJvSW5mbyk7XHJcbiAgICAgIHJldHVybiBOZXh0UmVzcG9uc2UuanNvbih7IFxyXG4gICAgICAgIGF1dGhlbnRpY2F0ZWQ6IHRydWUsXHJcbiAgICAgICAgbWVzc2FnZTogJ1F1aWNrQm9va3MgY2xpZW50IGlzIGluaXRpYWxpemVkIGFuZCByZWFkeScsXHJcbiAgICAgICAgY2xpZW50SW5mbzogcWJvSW5mb1xyXG4gICAgICB9KTtcclxuICAgIH0gY2F0Y2ggKGVycm9yKSB7XHJcbiAgICAgIC8vIElmIGFuIGVycm9yIGlzIHRocm93biwgdGhlIGNsaWVudCBpcyBub3QgaW5pdGlhbGl6ZWRcclxuICAgICAgY29uc29sZS5lcnJvcign4q2QIFF1aWNrQm9va3MgY2xpZW50IGluaXRpYWxpemF0aW9uIGZhaWxlZDonLCBlcnJvciBpbnN0YW5jZW9mIEVycm9yID8gZXJyb3IubWVzc2FnZSA6ICdVbmtub3duIGVycm9yJyk7XHJcbiAgICAgIHJldHVybiBOZXh0UmVzcG9uc2UuanNvbih7IFxyXG4gICAgICAgIGF1dGhlbnRpY2F0ZWQ6IGZhbHNlLFxyXG4gICAgICAgIG1lc3NhZ2U6ICdRdWlja0Jvb2tzIGNsaWVudCBpcyBub3QgaW5pdGlhbGl6ZWQnLFxyXG4gICAgICAgIGVycm9yOiBlcnJvciBpbnN0YW5jZW9mIEVycm9yID8gZXJyb3IubWVzc2FnZSA6ICdVbmtub3duIGVycm9yJyxcclxuICAgICAgICBjb29raWVDaGVjazoge1xyXG4gICAgICAgICAgaGFzQWNjZXNzVG9rZW46ICEhYWNjZXNzVG9rZW5Db29raWUsXHJcbiAgICAgICAgICBoYXNSZWFsbUlkOiAhIXJlYWxtSWRDb29raWVcclxuICAgICAgICB9XHJcbiAgICAgIH0pO1xyXG4gICAgfVxyXG4gIH0gY2F0Y2ggKGVycm9yKSB7XHJcbiAgICBjb25zb2xlLmVycm9yKCfirZAgRXJyb3IgY2hlY2tpbmcgUXVpY2tCb29rcyBhdXRoIHN0YXR1czonLCBlcnJvcik7XHJcbiAgICBcclxuICAgIHJldHVybiBOZXh0UmVzcG9uc2UuanNvbihcclxuICAgICAgeyBcclxuICAgICAgICBhdXRoZW50aWNhdGVkOiBmYWxzZSxcclxuICAgICAgICBlcnJvcjogJ0Vycm9yIGNoZWNraW5nIFF1aWNrQm9va3MgYXV0aGVudGljYXRpb24gc3RhdHVzJyxcclxuICAgICAgICBkZXRhaWxzOiBlcnJvciBpbnN0YW5jZW9mIEVycm9yID8gZXJyb3IubWVzc2FnZSA6ICdVbmtub3duIGVycm9yJyBcclxuICAgICAgfSxcclxuICAgICAgeyBzdGF0dXM6IDUwMCB9XHJcbiAgICApO1xyXG4gIH1cclxufVxyXG5cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIFBPU1QoKSB7XHJcbiAgY29uc29sZS5lcnJvcign4q2QIE1hbnVhbCBRdWlja0Jvb2tzIGluaXRpYWxpemF0aW9uIHJlcXVlc3RlZCcpO1xyXG4gIHRyeSB7XHJcbiAgICAvLyBJbXBvcnQgdGhlIGluaXRpYWxpemF0aW9uIGZ1bmN0aW9uXHJcbiAgICBjb25zdCB7IG1hbnVhbGx5SW5pdGlhbGl6ZVF1aWNrQm9va3MgfSA9IGF3YWl0IGltcG9ydCgnQC9saWIvcXVpY2tib29rcy9hcGknKTtcclxuICAgIFxyXG4gICAgLy8gQ2FsbCB0aGUgZnVuY3Rpb25cclxuICAgIGNvbnNvbGUuZXJyb3IoJ+KtkCBDYWxsaW5nIG1hbnVhbGx5SW5pdGlhbGl6ZVF1aWNrQm9va3MgZnVuY3Rpb24nKTtcclxuICAgIGNvbnN0IHJlc3VsdCA9IG1hbnVhbGx5SW5pdGlhbGl6ZVF1aWNrQm9va3MoKTtcclxuICAgIFxyXG4gICAgY29uc29sZS5lcnJvcign4q2QIE1hbnVhbCBpbml0aWFsaXphdGlvbiByZXN1bHQ6JywgcmVzdWx0KTtcclxuICAgIFxyXG4gICAgLy8gUmV0dXJuIHRoZSByZXN1bHRcclxuICAgIHJldHVybiBOZXh0UmVzcG9uc2UuanNvbih7IFxyXG4gICAgICBzdWNjZXNzOiByZXN1bHQsXHJcbiAgICAgIG1lc3NhZ2U6IHJlc3VsdCA/ICdNYW51YWwgaW5pdGlhbGl6YXRpb24gc3VjY2Vzc2Z1bCcgOiAnTWFudWFsIGluaXRpYWxpemF0aW9uIGZhaWxlZCdcclxuICAgIH0pO1xyXG4gIH0gY2F0Y2ggKGVycm9yKSB7XHJcbiAgICBjb25zb2xlLmVycm9yKCfirZAgRXJyb3IgZHVyaW5nIG1hbnVhbCBpbml0aWFsaXphdGlvbjonLCBlcnJvcik7XHJcbiAgICBcclxuICAgIHJldHVybiBOZXh0UmVzcG9uc2UuanNvbihcclxuICAgICAgeyBcclxuICAgICAgICBzdWNjZXNzOiBmYWxzZSxcclxuICAgICAgICBlcnJvcjogJ0Vycm9yIGR1cmluZyBtYW51YWwgaW5pdGlhbGl6YXRpb24nLFxyXG4gICAgICAgIGRldGFpbHM6IGVycm9yIGluc3RhbmNlb2YgRXJyb3IgPyBlcnJvci5tZXNzYWdlIDogJ1Vua25vd24gZXJyb3InIFxyXG4gICAgICB9LFxyXG4gICAgICB7IHN0YXR1czogNTAwIH1cclxuICAgICk7XHJcbiAgfVxyXG59ICJdLCJuYW1lcyI6WyJOZXh0UmVzcG9uc2UiLCJjb29raWVzIiwiVE9LRU5fS0VZIiwiUkVBTE1fSURfS0VZIiwiR0VUIiwiY29uc29sZSIsImVycm9yIiwibG9nIiwiY29va2llU3RvcmUiLCJhY2Nlc3NUb2tlbkNvb2tpZSIsImdldCIsInJlYWxtSWRDb29raWUiLCJoYXNBY2Nlc3NUb2tlbiIsImhhc1JlYWxtSWQiLCJqc29uIiwiYXV0aGVudGljYXRlZCIsIm1lc3NhZ2UiLCJjb29raWVDaGVjayIsImNoZWNrQ2xpZW50SW5pdGlhbGl6ZWQiLCJxYm8iLCJxYm9JbmZvIiwiYWNjZXNzVG9rZW4iLCJyZWFsbUlkIiwib2F1dGhWZXJzaW9uIiwib2F1dGh2ZXJzaW9uIiwiY2xpZW50SW5mbyIsIkVycm9yIiwiZGV0YWlscyIsInN0YXR1cyIsIlBPU1QiLCJtYW51YWxseUluaXRpYWxpemVRdWlja0Jvb2tzIiwicmVzdWx0Iiwic3VjY2VzcyJdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(rsc)/./src/app/api/auth/status/route.ts\n");

/***/ }),

/***/ "(rsc)/./src/lib/quickbooks/api.ts":
/*!***********************************!*\
  !*** ./src/lib/quickbooks/api.ts ***!
  \***********************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   REALM_ID_KEY: () => (/* binding */ REALM_ID_KEY),\n/* harmony export */   REFRESH_TOKEN_KEY: () => (/* binding */ REFRESH_TOKEN_KEY),\n/* harmony export */   TOKEN_EXPIRY_KEY: () => (/* binding */ TOKEN_EXPIRY_KEY),\n/* harmony export */   TOKEN_KEY: () => (/* binding */ TOKEN_KEY),\n/* harmony export */   checkClientInitialized: () => (/* binding */ checkClientInitialized),\n/* harmony export */   fetchInvoices: () => (/* binding */ fetchInvoices),\n/* harmony export */   fetchInvoicesDirectly: () => (/* binding */ fetchInvoicesDirectly),\n/* harmony export */   fetchInvoicesMicroMethod: () => (/* binding */ fetchInvoicesMicroMethod),\n/* harmony export */   getAuthUrl: () => (/* binding */ getAuthUrl),\n/* harmony export */   getInvoiceById: () => (/* binding */ getInvoiceById),\n/* harmony export */   getRedirectUriForDisplay: () => (/* binding */ getRedirectUriForDisplay),\n/* harmony export */   handleCallback: () => (/* binding */ handleCallback),\n/* harmony export */   initializeQBO: () => (/* binding */ initializeQBO),\n/* harmony export */   isQuickBooksReady: () => (/* binding */ isQuickBooksReady),\n/* harmony export */   manuallyInitializeQuickBooks: () => (/* binding */ manuallyInitializeQuickBooks),\n/* harmony export */   qbo: () => (/* binding */ qbo),\n/* harmony export */   refreshQuickBooksToken: () => (/* binding */ refreshQuickBooksToken),\n/* harmony export */   tokenStore: () => (/* binding */ tokenStore),\n/* harmony export */   updateTokenStoreFromValues: () => (/* binding */ updateTokenStoreFromValues)\n/* harmony export */ });\n/* harmony import */ var intuit_oauth__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! intuit-oauth */ \"(rsc)/./node_modules/intuit-oauth/src/OAuthClient.js\");\n/* harmony import */ var intuit_oauth__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(intuit_oauth__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var node_quickbooks__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! node-quickbooks */ \"(rsc)/./node_modules/node-quickbooks/index.js\");\n/* harmony import */ var node_quickbooks__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(node_quickbooks__WEBPACK_IMPORTED_MODULE_1__);\n\n\n// First, let's verify QuickBooks constructor is available\nconsole.log(\"QuickBooks constructor check:\", {\n    constructorType: typeof (node_quickbooks__WEBPACK_IMPORTED_MODULE_1___default()),\n    isFunction: typeof (node_quickbooks__WEBPACK_IMPORTED_MODULE_1___default()) === \"function\"\n});\n// Token storage keys\nconst TOKEN_KEY = \"qb_token\";\nconst REALM_ID_KEY = \"qb_realm_id\";\nconst REFRESH_TOKEN_KEY = \"qb_refresh_token\";\nconst TOKEN_EXPIRY_KEY = \"qb_token_expiry\";\n// Debug flag\nconst DEBUG = true;\n// Helper function to log debug information\nconst debugLog = (...args)=>{\n    if (DEBUG) {\n        console.log(\"[QuickBooks API Debug]\", ...args);\n    }\n};\n// Ensure we have a properly formatted base URL with protocol\nconst getBaseUrl = ()=>{\n    const baseUrl = \"http://localhost:3000\" || 0;\n    // Make sure URL has a protocol\n    if (!baseUrl.startsWith(\"http://\") && !baseUrl.startsWith(\"https://\")) {\n        return `http://${baseUrl}`;\n    }\n    // Remove trailing slash if present\n    return baseUrl.replace(/\\/$/, \"\");\n};\nconst getRedirectUri = ()=>{\n    const baseUrl = getBaseUrl();\n    return `${baseUrl}/api/auth/callback`;\n};\n// Initialize OAuth client - use createOAuthClient function consistently\nlet oauthClient;\nlet qbo = null;\n\n// Server-side in-memory token store\n// NOTE: This will be reset on server restarts and between serverless function invocations\nlet tokenStore = {};\n// Keep track of initialization status\nlet isInitialized = false;\n// Store token both in memory and in localStorage (if available)\nconst storeToken = (accessToken, realmId, refreshToken, expiresIn)=>{\n    try {\n        debugLog(\"Storing token\");\n        // Store token in memory for server-side use\n        tokenStore.accessToken = accessToken;\n        tokenStore.realmId = realmId;\n        if (refreshToken) {\n            tokenStore.refreshToken = refreshToken;\n        }\n        if (expiresIn) {\n            const expiryTime = Date.now() + expiresIn * 1000;\n            tokenStore.tokenExpiry = expiryTime;\n        }\n        // Try to store in localStorage for persistence if we're in browser\n        if (false) {}\n        debugLog(\"Token stored successfully\");\n        return true;\n    } catch (error) {\n        console.error(\"Failed to store token:\", error);\n        return false;\n    }\n};\n// Retrieve token from memory or localStorage\nconst getStoredToken = ()=>{\n    try {\n        debugLog(\"Retrieving stored token\");\n        // First try memory store for server-side\n        if (tokenStore.accessToken && tokenStore.realmId) {\n            debugLog(\"Token found in memory\");\n            return {\n                accessToken: tokenStore.accessToken,\n                realmId: tokenStore.realmId,\n                refreshToken: tokenStore.refreshToken,\n                tokenExpiry: tokenStore.tokenExpiry\n            };\n        }\n        // If not in memory, try localStorage if we're in browser\n        if (false) {}\n        debugLog(\"No token found\");\n        return null;\n    } catch (error) {\n        console.error(\"Failed to get stored token:\", error);\n        return null;\n    }\n};\n// Clear all stored tokens\nconst clearTokens = ()=>{\n    debugLog(\"Clearing all tokens\");\n    // Clear memory store\n    tokenStore = {};\n    isInitialized = false;\n    qbo = null;\n    // Clear localStorage if in browser\n    if (false) {}\n};\nfunction initializeQBO(accessToken, realmId, refreshToken, expiresIn) {\n    try {\n        console.log(\"BASIC QuickBooks client initialization\", {\n            accessTokenPresent: !!accessToken,\n            realmIdPresent: !!realmId,\n            clientIdPresent: !!process.env.QUICKBOOKS_CLIENT_ID,\n            clientSecretPresent: !!process.env.QUICKBOOKS_CLIENT_SECRET\n        });\n        // Validate requirements\n        if (!accessToken || !realmId) {\n            console.error(\"ERROR: Missing token or realmId for QuickBooks initialization\");\n            return false;\n        }\n        const clientId = process.env.QUICKBOOKS_CLIENT_ID;\n        const clientSecret = process.env.QUICKBOOKS_CLIENT_SECRET;\n        if (!clientId || !clientSecret) {\n            console.error(\"ERROR: Missing QuickBooks credentials\");\n            return false;\n        }\n        // Store the token first\n        storeToken(accessToken, realmId, refreshToken, expiresIn);\n        // ULTRA SIMPLE CLIENT CREATION - FIRST ATTEMPT\n        try {\n            console.log(\"Creating minimal QuickBooks client - attempt 1\");\n            // Create the client with absolute minimal parameters\n            qbo = new (node_quickbooks__WEBPACK_IMPORTED_MODULE_1___default())(clientId, clientSecret, accessToken, false, realmId);\n            if (!qbo) {\n                console.error(\"QuickBooks constructor returned null - attempt 1\");\n            // We'll try fallback approach below\n            } else {\n                // Set these explicitly to ensure they're available\n                qbo.accessToken = accessToken;\n                qbo.realmId = realmId;\n                console.log(\"QuickBooks client created with basic properties:\", {\n                    hasQbo: !!qbo,\n                    hasToken: !!(qbo && qbo.accessToken),\n                    hasRealmId: !!(qbo && qbo.realmId)\n                });\n                // Set initialization flag\n                isInitialized = true;\n                console.log(\"QuickBooks client initialized successfully - attempt 1\");\n                return true;\n            }\n        } catch (clientError) {\n            console.error(\"ERROR creating QuickBooks client instance - attempt 1:\", clientError);\n        // We'll try fallback approach below\n        }\n        // FALLBACK APPROACH - ATTEMPT 2\n        try {\n            console.log(\"Creating fallback QuickBooks client - attempt 2\");\n            // Try with different parameters - some versions need useSandbox parameter\n            qbo = new (node_quickbooks__WEBPACK_IMPORTED_MODULE_1___default())(clientId, clientSecret, accessToken, true, realmId, {\n                useSandbox: true\n            });\n            if (!qbo) {\n                console.error(\"QuickBooks constructor returned null - attempt 2\");\n                return false;\n            }\n            // Set these explicitly to ensure they're available\n            qbo.accessToken = accessToken;\n            qbo.realmId = realmId;\n            console.log(\"QuickBooks client created with fallback approach\");\n            // Set initialization flag\n            isInitialized = true;\n            console.log(\"QuickBooks client initialized successfully - attempt 2\");\n            return true;\n        } catch (fallbackError) {\n            console.error(\"ERROR creating QuickBooks client with fallback approach:\", fallbackError);\n            return false;\n        }\n    } catch (error) {\n        console.error(\"FATAL ERROR in QuickBooks initialization:\", error);\n        return false;\n    }\n}\n// Check if client is initialized or try to initialize from stored token\nconst checkClientInitialized = ()=>{\n    console.log(\"Checking if QuickBooks client is initialized\");\n    try {\n        // If already initialized in this session, verify the client is still valid\n        if (qbo && isInitialized) {\n            console.log(\"QuickBooks client appears to be initialized, validating...\");\n            // Verify the client has all required properties\n            if (!qbo.accessToken || !qbo.realmId) {\n                console.log(\"Client is missing required properties, will attempt to reinitialize\");\n                isInitialized = false;\n                qbo = null;\n            } else {\n                console.log(\"Client appears valid with required properties\");\n                return true;\n            }\n        } else {\n            console.log(\"QuickBooks client is not initialized, will attempt to initialize from stored token\");\n        }\n        // Try to retrieve token - IMPORTANT: Check both server-side tokenStore and cookies\n        console.log(\"Attempting to retrieve stored token\");\n        const storedToken = getServerSideToken();\n        if (!storedToken || !storedToken.accessToken || !storedToken.realmId) {\n            console.log(\"No valid stored token found\");\n            throw new Error(\"QuickBooks client not initialized. Please connect your QuickBooks account first.\");\n        }\n        console.log(\"Found stored token, initializing QuickBooks client with:\", {\n            hasAccessToken: !!storedToken.accessToken,\n            hasRealmId: !!storedToken.realmId,\n            hasRefreshToken: !!storedToken.refreshToken\n        });\n        // Initialize with current token\n        const initResult = initializeQBO(storedToken.accessToken, storedToken.realmId, storedToken.refreshToken, storedToken.tokenExpiry ? Math.floor((storedToken.tokenExpiry - Date.now()) / 1000) : undefined);\n        if (!initResult) {\n            console.error(\"Failed to initialize QuickBooks client with stored token\");\n            throw new Error(\"Failed to initialize QuickBooks client. Please reconnect your QuickBooks account.\");\n        }\n        console.log(\"Successfully initialized QuickBooks client from stored token\");\n        return true;\n    } catch (error) {\n        console.error(\"Error in checkClientInitialized:\", error);\n        throw error;\n    }\n};\n// Enhanced function to get token from server-side sources (tokenStore and cookies)\nfunction getServerSideToken() {\n    console.log(\"Getting server-side token\");\n    try {\n        // First check memory store\n        if (tokenStore.accessToken && tokenStore.realmId) {\n            console.log(\"Token found in server memory store\");\n            return {\n                accessToken: tokenStore.accessToken,\n                realmId: tokenStore.realmId,\n                refreshToken: tokenStore.refreshToken,\n                tokenExpiry: tokenStore.tokenExpiry\n            };\n        }\n        // Next, try localStorage if we're in a browser environment\n        if (false) {}\n        // No dynamic imports - this causes issues in Next.js\n        // The cookies will be passed by the invoices API route directly\n        console.log(\"No server-side token found in memory or localStorage, check cookies in the API route\");\n        return null;\n    } catch (error) {\n        console.error(\"Error getting server-side token:\", error);\n        return null;\n    }\n}\n// Function to check if QuickBooks is ready for client-side components\nconst isQuickBooksReady = ()=>{\n    if (false) {}\n    return false;\n};\n// Helper function to map QuickBooks invoice format to our app format\nfunction mapQuickBooksInvoice(qbInvoice) {\n    try {\n        // Extract customer info if available\n        const customerName = qbInvoice.CustomerRef?.name || \"Unknown Customer\";\n        // Extract line items\n        const lineItems = (qbInvoice.Line || []).map((line)=>{\n            return {\n                id: line.Id || \"\",\n                description: line.Description || \"\",\n                amount: line.Amount || 0,\n                quantity: line.Quantity || 1,\n                unitPrice: line.SalesItemLineDetail?.UnitPrice || 0\n            };\n        });\n        // Map to our invoice format\n        return {\n            id: qbInvoice.Id || \"\",\n            invoiceNumber: qbInvoice.DocNumber || \"\",\n            customerName: customerName,\n            date: qbInvoice.TxnDate || \"\",\n            dueDate: qbInvoice.DueDate || \"\",\n            amount: qbInvoice.TotalAmt || 0,\n            balance: qbInvoice.Balance || 0,\n            status: qbInvoice.status || \"Unknown\",\n            lineItems: lineItems,\n            currency: qbInvoice.CurrencyRef?.name || \"USD\"\n        };\n    } catch (error) {\n        console.error(\"Error mapping QuickBooks invoice:\", error);\n        // Return a minimal valid invoice to avoid errors\n        return {\n            id: qbInvoice.Id || \"\",\n            invoiceNumber: qbInvoice.DocNumber || \"\",\n            customerName: \"Error parsing invoice\",\n            date: qbInvoice.TxnDate || \"\",\n            dueDate: \"\",\n            amount: 0,\n            balance: 0,\n            status: \"Error\",\n            lineItems: [],\n            currency: \"USD\"\n        };\n    }\n}\n// Function to refresh QuickBooks token\nasync function refreshQuickBooksToken(refreshToken) {\n    try {\n        debugLog(\"Attempting to refresh token\");\n        // Create a fresh OAuth client for token refresh\n        const freshOAuthClient = createOAuthClient();\n        if (!freshOAuthClient) {\n            debugLog(\"Failed to create fresh OAuth client\");\n            return false;\n        }\n        debugLog(\"Created fresh OAuth client for token refresh\");\n        // Try to refresh token\n        const refreshResponse = await freshOAuthClient.refreshUsingToken(refreshToken);\n        if (!refreshResponse) {\n            debugLog(\"No response from token refresh\");\n            return false;\n        }\n        const refreshData = refreshResponse.getJson();\n        debugLog(\"Refresh response received\", {\n            hasAccessToken: !!refreshData.access_token,\n            hasRefreshToken: !!refreshData.refresh_token,\n            expiresIn: refreshData.expires_in\n        });\n        if (!refreshData.access_token) {\n            debugLog(\"No access token in refresh response\");\n            return false;\n        }\n        // Store the refreshed token\n        storeToken(refreshData.access_token, tokenStore.realmId || \"\", refreshData.refresh_token, refreshData.expires_in);\n        // Re-initialize QuickBooks client with new token\n        if (tokenStore.realmId) {\n            const initialized = initializeQBO(refreshData.access_token, tokenStore.realmId, refreshData.refresh_token, refreshData.expires_in ? Date.now() + refreshData.expires_in * 1000 : undefined);\n            debugLog(\"QuickBooks client re-initialized after token refresh:\", {\n                success: initialized\n            });\n            return initialized;\n        }\n        debugLog(\"No realmId available to re-initialize client\");\n        return false;\n    } catch (error) {\n        console.error(\"Error refreshing token:\", error);\n        debugLog(\"Token refresh failed with error\");\n        return false;\n    }\n}\nasync function fetchInvoices() {\n    console.error(\"⭐ fetchInvoices: Starting invoice fetch process\");\n    try {\n        debugLog(\"Starting fetchInvoices...\");\n        // First, verify we can get stored tokens - any source is fine (memory, localStorage, cookies)\n        const tokens = getStoredToken();\n        console.error(\"⭐ fetchInvoices: Token check result:\", {\n            hasToken: !!tokens?.accessToken,\n            hasRealmId: !!tokens?.realmId,\n            hasRefreshToken: !!tokens?.refreshToken,\n            tokenExpiry: tokens?.tokenExpiry ? new Date(tokens.tokenExpiry).toISOString() : \"none\"\n        });\n        if (!tokens || !tokens.accessToken || !tokens.realmId) {\n            console.error(\"⭐ fetchInvoices: No valid tokens found for QuickBooks API call\");\n            throw new Error(\"QuickBooks authentication required. Please connect your account.\");\n        }\n        // Check if token is expired and we need to refresh\n        const now = Date.now();\n        const tokenExpired = tokens.tokenExpiry && now >= tokens.tokenExpiry;\n        console.error(\"⭐ fetchInvoices: Token expiry check:\", {\n            now: new Date(now).toISOString(),\n            tokenExpiry: tokens.tokenExpiry ? new Date(tokens.tokenExpiry).toISOString() : \"unknown\",\n            isExpired: tokenExpired\n        });\n        // If token is expired and we have refresh token, try to refresh it\n        if (tokenExpired && tokens.refreshToken) {\n            console.error(\"⭐ fetchInvoices: Token expired, attempting to refresh\");\n            try {\n                const refreshed = await refreshQuickBooksToken(tokens.refreshToken);\n                console.error(\"⭐ fetchInvoices: Token refresh result:\", {\n                    success: !!refreshed\n                });\n                if (!refreshed) {\n                    console.error(\"⭐ fetchInvoices: Token refresh failed\");\n                    throw new Error(\"Failed to refresh QuickBooks authentication. Please reconnect your account.\");\n                }\n            } catch (refreshError) {\n                console.error(\"⭐ fetchInvoices: Error refreshing token:\", refreshError);\n                throw new Error(\"QuickBooks authentication expired. Please reconnect your account.\");\n            }\n        }\n        // Initialize the client if not already initialized\n        if (!qbo) {\n            console.error(\"⭐ fetchInvoices: QuickBooks client not initialized, attempting initialization\");\n            const initialized = initializeQBO(tokens.accessToken, tokens.realmId, tokens.refreshToken, tokens.tokenExpiry);\n            console.error(\"⭐ fetchInvoices: Initialization result:\", {\n                success: initialized\n            });\n            if (!initialized || !qbo) {\n                console.error(\"⭐ fetchInvoices: Client initialization failed\");\n                throw new Error(\"Failed to initialize QuickBooks client. Please reconnect your account.\");\n            }\n        } else {\n            console.error(\"⭐ fetchInvoices: Using existing QuickBooks client\");\n        }\n        // Double-check that qbo is properly initialized with essential properties\n        if (!qbo.accessToken) {\n            console.error(\"⭐ fetchInvoices: QB client missing accessToken, updating\");\n            qbo.accessToken = tokens.accessToken;\n        }\n        if (!qbo.realmId) {\n            console.error(\"⭐ fetchInvoices: QB client missing realmId, updating\");\n            qbo.realmId = tokens.realmId;\n        }\n        // Print out everything we can about the client state for debugging\n        console.error(\"⭐ fetchInvoices: QuickBooks client state:\", {\n            clientExists: !!qbo,\n            hasAccessToken: !!(qbo && qbo.accessToken),\n            hasRealmId: !!(qbo && qbo.realmId),\n            hasTokenSecret: !!(qbo && qbo.tokenSecret),\n            oauthversion: qbo ? qbo.oauthversion : \"none\",\n            hasRefreshToken: !!(qbo && qbo.refreshToken)\n        });\n        // At this point, qbo should be initialized\n        console.error(\"⭐ fetchInvoices: Performing QuickBooks API call for invoices\");\n        return new Promise((resolve, reject)=>{\n            if (!qbo) {\n                console.error(\"⭐ fetchInvoices: QB client not available at request time\");\n                return reject(new Error(\"QuickBooks client not initialized\"));\n            }\n            console.error(\"⭐ fetchInvoices: Making findInvoices API call\");\n            // Try-catch block around the API call\n            try {\n                // First try: Use a simpler approach with no filters\n                // Many QuickBooks API failures happen due to complex queries\n                console.error(\"⭐ fetchInvoices: Trying simple query with no filters\");\n                qbo.findInvoices(\"\", (err, data)=>{\n                    if (err) {\n                        console.error(\"⭐ fetchInvoices: Error in simple findInvoices call:\", err);\n                        console.error(\"⭐ Error details:\", JSON.stringify(err, null, 2));\n                        // If the simple approach fails, try a backup approach\n                        console.error(\"⭐ fetchInvoices: Trying alternative query approach\");\n                        try {\n                            // Try with the older query approach\n                            qbo.findInvoices([\n                                {\n                                    field: \"MetaData.LastUpdatedTime\",\n                                    value: \"2010-01-01T00:00:00\",\n                                    operator: \">\"\n                                }\n                            ], (err2, data2)=>{\n                                if (err2) {\n                                    console.error(\"⭐ fetchInvoices: Both query approaches failed:\", err2);\n                                    console.error(\"⭐ Error details:\", JSON.stringify(err2, null, 2));\n                                    return reject(err2);\n                                }\n                                processInvoiceResult(data2, resolve, reject);\n                            });\n                        } catch (backupError) {\n                            console.error(\"⭐ fetchInvoices: Exception in backup approach:\", backupError);\n                            return reject(backupError);\n                        }\n                    } else {\n                        processInvoiceResult(data, resolve, reject);\n                    }\n                });\n            } catch (apiCallError) {\n                console.error(\"⭐ fetchInvoices: Exception during API call execution:\", apiCallError);\n                return reject(new Error(`QuickBooks API call failed: ${apiCallError instanceof Error ? apiCallError.message : \"Unknown error\"}`));\n            }\n        });\n    } catch (error) {\n        console.error(\"⭐ fetchInvoices: Error in fetchInvoices:\", error);\n        throw error;\n    }\n}\n// Helper function to process invoice results\nfunction processInvoiceResult(data, resolve, reject) {\n    // Check if data has QueryResponse property with Invoice array\n    if (data && data.QueryResponse && Array.isArray(data.QueryResponse.Invoice)) {\n        const invoices = data.QueryResponse.Invoice;\n        console.error(`⭐ fetchInvoices: Successfully found ${invoices.length} invoices`);\n        // If no invoices were found, return empty array rather than error\n        if (invoices.length === 0) {\n            console.error(\"⭐ fetchInvoices: No invoices found in QuickBooks account\");\n            return resolve([]);\n        }\n        return resolve(invoices);\n    } else {\n        console.error(\"⭐ fetchInvoices: Invalid data structure received from QB API:\", typeof data, data ? Object.keys(data) : \"null\");\n        console.error(\"⭐ fetchInvoices: Data dump:\", JSON.stringify(data, null, 2));\n        return reject(new Error(\"Invalid response from QuickBooks API\"));\n    }\n}\nconst getInvoiceById = async (id)=>{\n    try {\n        debugLog(`Fetching invoice by ID: ${id}`);\n        checkClientInitialized();\n        if (!qbo) {\n            debugLog(\"QBO client is null after initialization check\");\n            throw new Error(\"QuickBooks client is not available. Please reconnect your QuickBooks account.\");\n        }\n        const cleanId = id.replace(/^(?:inv-)?#?\\s*/i, \"\").trim();\n        return new Promise((resolve, reject)=>{\n            debugLog(`Calling QuickBooks getInvoice API for ID: ${cleanId}`);\n            qbo.getInvoice(cleanId, (err, invoice)=>{\n                if (err) {\n                    console.error(\"Error fetching invoice from QuickBooks API:\", err);\n                    if (err.code === \"80040408\") {\n                        debugLog(\"QuickBooks initialization error (80040408). Clearing tokens.\");\n                        clearTokens();\n                        reject(new Error(\"QuickBooks connection error. Please reconnect your QuickBooks account.\"));\n                    } else if (err.code === \"270\" || err.message?.includes(\"Token invalid\")) {\n                        debugLog(\"Invalid token error. Clearing tokens.\");\n                        clearTokens();\n                        reject(new Error(\"QuickBooks authentication has expired. Please reconnect your QuickBooks account.\"));\n                    } else if (err.statusCode === 404) {\n                        reject(new Error(`Invoice #${id} not found. Please check the invoice number and try again.`));\n                    } else {\n                        reject(new Error(\"Failed to fetch invoice from QuickBooks. Please check your connection.\"));\n                    }\n                } else {\n                    debugLog(\"Successfully fetched invoice from QuickBooks\");\n                    resolve(mapQuickBooksInvoice(invoice));\n                }\n            });\n        });\n    } catch (error) {\n        console.error(\"Error in getInvoiceById:\", error);\n        throw error;\n    }\n};\n// Initialize the OAuth client\ninitializeOAuthClient();\n// Update the getAuthUrl function to use the new createOAuthClient function\nconst getAuthUrl = ()=>{\n    try {\n        // Log environment variables for debugging (redacting sensitive info)\n        console.log(\"Environment check:\", {\n            hasClientId: !!process.env.QUICKBOOKS_CLIENT_ID,\n            hasClientSecret: !!process.env.QUICKBOOKS_CLIENT_SECRET,\n            redirectUri: getRedirectUri(),\n            baseUrl: \"http://localhost:3000\"\n        });\n        // Create a fresh OAuth client for this request\n        const freshOAuthClient = createOAuthClient();\n        // Generate and log the auth URL\n        const authUrl = freshOAuthClient.authorizeUri({\n            scope: [\n                (intuit_oauth__WEBPACK_IMPORTED_MODULE_0___default().scopes).Accounting,\n                (intuit_oauth__WEBPACK_IMPORTED_MODULE_0___default().scopes).OpenId,\n                (intuit_oauth__WEBPACK_IMPORTED_MODULE_0___default().scopes).Profile,\n                (intuit_oauth__WEBPACK_IMPORTED_MODULE_0___default().scopes).Email\n            ],\n            state: \"teststate\"\n        });\n        console.log(\"Generated auth URL:\", authUrl);\n        return authUrl;\n    } catch (error) {\n        console.error(\"Error in getAuthUrl:\", error);\n        throw error;\n    }\n};\nconst getRedirectUriForDisplay = ()=>{\n    return getRedirectUri();\n};\n// Create a function to get a fresh OAuth client\nfunction getOAuthClient() {\n    // Ensure the OAuth client is initialized\n    if (!oauthClient) {\n        console.log(\"OAuth client not initialized, initializing now\");\n        if (!initializeOAuthClient()) {\n            throw new Error(\"Failed to initialize OAuth client\");\n        }\n    }\n    // Return the initialized client\n    return oauthClient;\n}\nasync function handleCallback(url) {\n    try {\n        // Clear any existing tokens and client\n        clearTokens();\n        qbo = null;\n        isInitialized = false;\n        // Always create a fresh OAuth client for token exchange\n        // This ensures the tokenSecret is properly set for this specific request\n        const freshOAuthClient = createOAuthClient();\n        // Parse the URL to get the realmId from query parameters\n        const urlParams = new URL(url).searchParams;\n        const realmIdFromUrl = urlParams.get(\"realmId\");\n        const code = urlParams.get(\"code\");\n        if (!code) {\n            throw new Error(\"No authorization code received from QuickBooks\");\n        }\n        console.log(\"Creating token with fresh OAuth client\", {\n            code: code,\n            hasRealmId: !!realmIdFromUrl,\n            redirectUri: getRedirectUri(),\n            hasClientId: !!process.env.QUICKBOOKS_CLIENT_ID,\n            hasClientSecret: !!process.env.QUICKBOOKS_CLIENT_SECRET\n        });\n        // Create token with the fresh client\n        if (!process.env.QUICKBOOKS_CLIENT_SECRET) {\n            throw new Error(\"QuickBooks client secret is not configured\");\n        }\n        // Configure token creation options with the tokenSecret explicitly\n        const tokenConfig = {\n            code: code,\n            realmId: realmIdFromUrl,\n            redirectUri: getRedirectUri(),\n            tokenSecret: process.env.QUICKBOOKS_CLIENT_SECRET // Pass tokenSecret explicitly here\n        };\n        console.log(\"Creating token with config:\", {\n            hasCode: !!tokenConfig.code,\n            hasRealmId: !!tokenConfig.realmId,\n            hasRedirectUri: !!tokenConfig.redirectUri,\n            hasTokenSecret: !!tokenConfig.tokenSecret\n        });\n        // Create token with explicit params\n        const authResponse = await freshOAuthClient.createToken(url, tokenConfig);\n        const tokenData = authResponse.getJson();\n        if (!tokenData.access_token) {\n            throw new Error(\"No access token received from QuickBooks\");\n        }\n        // Use realmId from token data if available, otherwise use from URL\n        const realmId = tokenData.realmId || realmIdFromUrl;\n        if (!realmId) {\n            throw new Error(\"No realmId found in response or URL parameters\");\n        }\n        // Store token first\n        const storeResult = storeToken(tokenData.access_token, realmId, tokenData.refresh_token, tokenData.expires_in);\n        if (!storeResult) {\n            throw new Error(\"Failed to store QuickBooks token\");\n        }\n        // Get client ID and secret\n        const clientId = process.env.QUICKBOOKS_CLIENT_ID;\n        const clientSecret = process.env.QUICKBOOKS_CLIENT_SECRET;\n        if (!clientId || !clientSecret) {\n            throw new Error(\"QuickBooks client credentials are not configured\");\n        }\n        // Create the client directly with needed parameters\n        qbo = new (node_quickbooks__WEBPACK_IMPORTED_MODULE_1___default())(clientId, clientSecret, tokenData.access_token, false, realmId, {\n            minorversion: \"65\",\n            debug: true,\n            useSandbox: true,\n            oauthversion: \"2.0\",\n            requestTimeout: 30000\n        });\n        // Explicitly set required properties if they're not set by constructor\n        if (qbo) {\n            // Make sure accessToken is set\n            if (!qbo.accessToken && tokenData.access_token) {\n                qbo.accessToken = tokenData.access_token;\n            }\n            // Make sure realmId is set\n            if (!qbo.realmId && realmId) {\n                qbo.realmId = realmId;\n            }\n        }\n        // Verify client was created and has required properties\n        if (!qbo || !qbo.accessToken || !qbo.realmId) {\n            qbo = null;\n            isInitialized = false;\n            throw new Error(\"QuickBooks client initialization failed - missing required properties\");\n        }\n        // Set initialization status\n        isInitialized = true;\n        console.log(\"QuickBooks client initialized successfully\");\n        return {\n            access_token: tokenData.access_token,\n            realmId: realmId,\n            refresh_token: tokenData.refresh_token,\n            expires_in: tokenData.expires_in\n        };\n    } catch (error) {\n        console.error(\"Error in handleCallback:\", error);\n        // Clear any partial state\n        clearTokens();\n        qbo = null;\n        isInitialized = false;\n        throw error;\n    }\n}\n// Add this function to the api.ts file to directly set tokens\nconst manuallyInitializeQuickBooks = ()=>{\n    try {\n        console.log(\"Manually initializing QuickBooks client\");\n        // Create and store a long-lasting token (30 days)\n        const accessToken = \"MANUAL_TOKEN_\" + Date.now();\n        const realmId = \"MANUAL_REALM_\" + Date.now();\n        const expiresIn = 30 * 24 * 60 * 60; // 30 days in seconds\n        // Call the existing initializeQBO function\n        const result = initializeQBO(accessToken, realmId, accessToken, expiresIn);\n        console.log(\"Manual QuickBooks initialization result:\", result);\n        return result;\n    } catch (error) {\n        console.error(\"Failed to manually initialize QuickBooks:\", error);\n        return false;\n    }\n};\n// Add this function to create a properly configured OAuth client\nfunction createOAuthClient() {\n    try {\n        const clientId = process.env.QUICKBOOKS_CLIENT_ID;\n        const clientSecret = process.env.QUICKBOOKS_CLIENT_SECRET;\n        if (!clientId || !clientSecret) {\n            throw new Error(\"QuickBooks client credentials are not configured\");\n        }\n        // SIMPLIFIED: Create OAuth client with minimal configuration\n        return new (intuit_oauth__WEBPACK_IMPORTED_MODULE_0___default())({\n            clientId,\n            clientSecret,\n            environment: \"sandbox\",\n            redirectUri: getRedirectUri(),\n            tokenSecret: clientSecret // Essential for OAuth flow\n        });\n    } catch (error) {\n        console.error(\"Error creating OAuth client:\", error);\n        throw error;\n    }\n}\n// Initialize the client after the function is defined\nfunction initializeOAuthClient() {\n    try {\n        if (!oauthClient) {\n            console.log(\"Initializing OAuth client\");\n            oauthClient = createOAuthClient();\n            console.log(\"OAuth client initialized successfully\");\n        }\n        return true;\n    } catch (error) {\n        console.error(\"Error initializing OAuth client:\", error);\n        return false;\n    }\n}\n// Add this function to update token store directly from values\nfunction updateTokenStoreFromValues(accessToken, realmId, refreshToken, tokenExpiry) {\n    try {\n        debugLog(\"Directly updating token store with provided values\");\n        // Update the token store directly\n        tokenStore.accessToken = accessToken;\n        tokenStore.realmId = realmId;\n        if (refreshToken) {\n            tokenStore.refreshToken = refreshToken;\n        }\n        if (tokenExpiry) {\n            tokenStore.tokenExpiry = tokenExpiry;\n        }\n        debugLog(\"Token store updated with values:\", {\n            hasToken: !!tokenStore.accessToken,\n            hasRealmId: !!tokenStore.realmId,\n            hasRefreshToken: !!tokenStore.refreshToken,\n            tokenExpiry: tokenStore.tokenExpiry ? new Date(tokenStore.tokenExpiry).toISOString() : \"none\"\n        });\n        return true;\n    } catch (error) {\n        console.error(\"Error updating token store from values:\", error);\n        return false;\n    }\n}\n// Alternative method to fetch invoices with a more direct approach\nasync function fetchInvoicesDirectly() {\n    console.error(\"⭐ Starting direct invoice fetch with alternative method\");\n    try {\n        // First, verify we can get stored tokens\n        const tokens = getStoredToken();\n        if (!tokens || !tokens.accessToken || !tokens.realmId) {\n            console.error(\"⭐ No valid tokens for direct invoice fetch\");\n            throw new Error(\"QuickBooks authentication required. Please connect your account.\");\n        }\n        // We'll set up a fresh OAuthClient instance specifically for this request\n        const oauthClientForRequest = new (intuit_oauth__WEBPACK_IMPORTED_MODULE_0___default())({\n            clientId: process.env.QUICKBOOKS_CLIENT_ID,\n            clientSecret: process.env.QUICKBOOKS_CLIENT_SECRET,\n            environment: \"sandbox\",\n            redirectUri: getRedirectUri(),\n            logging: true\n        });\n        // Set the tokens on the client\n        oauthClientForRequest.setToken({\n            realmId: tokens.realmId,\n            token_type: \"bearer\",\n            access_token: tokens.accessToken,\n            refresh_token: tokens.refreshToken || \"\",\n            expires_in: tokens.tokenExpiry ? Math.floor((tokens.tokenExpiry - Date.now()) / 1000) : 3600\n        });\n        console.error(\"⭐ Attempting direct invoice API call\");\n        // Make a direct API call (not using node-quickbooks)\n        return new Promise((resolve, reject)=>{\n            try {\n                const url = `https://sandbox-quickbooks.api.intuit.com/v3/company/${tokens.realmId}/query`;\n                const headers = {\n                    \"Authorization\": `Bearer ${tokens.accessToken}`,\n                    \"Accept\": \"application/json\",\n                    \"Content-Type\": \"application/text\"\n                };\n                // Use a simpler query to minimize possible format issues\n                const query = \"SELECT * FROM Invoice\";\n                // Make the API call\n                oauthClientForRequest.makeApiCall({\n                    url: url,\n                    method: \"POST\",\n                    headers: headers,\n                    body: query\n                }, (err, response)=>{\n                    if (err) {\n                        console.error(\"⭐ Direct API call error:\", err);\n                        return reject(err);\n                    }\n                    try {\n                        // Log the entire response for debugging\n                        console.error(\"⭐ Direct API call response:\", response);\n                        if (typeof response === \"string\") {\n                            response = JSON.parse(response);\n                        }\n                        // Extract invoices data\n                        if (response && response.QueryResponse && Array.isArray(response.QueryResponse.Invoice)) {\n                            console.error(`⭐ Successfully found ${response.QueryResponse.Invoice.length} invoices directly`);\n                            return resolve(response.QueryResponse.Invoice);\n                        } else {\n                            // If the response doesn't match expected format, try to extract useful data\n                            console.error(\"⭐ Unexpected response format:\", response);\n                            // If there's any data that can be used, return it\n                            if (response && typeof response === \"object\") {\n                                if (Array.isArray(response)) {\n                                    return resolve(response);\n                                } else if (response.QueryResponse) {\n                                    return resolve([\n                                        response.QueryResponse\n                                    ]);\n                                }\n                            }\n                            return reject(new Error(\"Invalid response format from QuickBooks API\"));\n                        }\n                    } catch (parseError) {\n                        console.error(\"⭐ Error parsing direct API response:\", parseError);\n                        return reject(parseError);\n                    }\n                });\n            } catch (apiError) {\n                console.error(\"⭐ Error making direct API call:\", apiError);\n                return reject(apiError);\n            }\n        });\n    } catch (error) {\n        console.error(\"⭐ Top-level error in direct invoice fetch:\", error);\n        throw error;\n    }\n}\n// Ultra minimal API call for QuickBooks invoices (third approach)\nasync function fetchInvoicesMicroMethod() {\n    console.error(\"⭐ Starting MICRO invoice fetch with bare minimum approach\");\n    try {\n        // Get tokens directly from memory store first for speed\n        const tokens = tokenStore.accessToken && tokenStore.realmId ? {\n            accessToken: tokenStore.accessToken,\n            realmId: tokenStore.realmId\n        } : getStoredToken();\n        if (!tokens || !tokens.accessToken || !tokens.realmId) {\n            console.error(\"⭐ No valid tokens for micro invoice fetch\");\n            throw new Error(\"Authentication required\");\n        }\n        console.error(\"⭐ Micro method: Using minimal axios-like fetch with bare API call\");\n        // Create a promise with a short timeout\n        return new Promise((resolve, reject)=>{\n            // Create a timeout that's much shorter (15 seconds)\n            const timeoutId = setTimeout(()=>{\n                console.error(\"⭐ Micro method: Request timed out after 15 seconds\");\n                reject(new Error(\"Micro method request timed out after 15 seconds\"));\n            }, 15000);\n            try {\n                // Using the fetch API directly instead of the OAuthClient or node-quickbooks\n                const url = `https://sandbox-quickbooks.api.intuit.com/v3/company/${tokens.realmId}/query?query=select%20%2A%20from%20Invoice%20MAXRESULTS%205`;\n                console.error(\"⭐ Micro method: Calling API directly at URL:\", url);\n                fetch(url, {\n                    method: \"GET\",\n                    headers: {\n                        \"Authorization\": `Bearer ${tokens.accessToken}`,\n                        \"Accept\": \"application/json\",\n                        \"Content-Type\": \"application/json\"\n                    }\n                }).then((response)=>{\n                    console.error(\"⭐ Micro method: Received response with status:\", response.status);\n                    if (!response.ok) {\n                        throw new Error(`API responded with status: ${response.status}`);\n                    }\n                    return response.json();\n                }).then((data)=>{\n                    console.error(\"⭐ Micro method: Successfully parsed response JSON\");\n                    clearTimeout(timeoutId);\n                    // Extract invoice data from response\n                    if (data && data.QueryResponse && Array.isArray(data.QueryResponse.Invoice)) {\n                        console.error(`⭐ Micro method: Found ${data.QueryResponse.Invoice.length} invoices`);\n                        resolve(data.QueryResponse.Invoice);\n                    } else {\n                        console.error(\"⭐ Micro method: Response does not contain invoice array:\", data);\n                        // If we at least got data but not in the expected format, return an empty array\n                        // rather than failing - this helps the UI handle the case better\n                        resolve([]);\n                    }\n                }).catch((error)=>{\n                    console.error(\"⭐ Micro method: Fetch error:\", error);\n                    clearTimeout(timeoutId);\n                    reject(error);\n                });\n            } catch (error) {\n                console.error(\"⭐ Micro method: Exception during fetch setup:\", error);\n                clearTimeout(timeoutId);\n                reject(error);\n            }\n        });\n    } catch (error) {\n        console.error(\"⭐ Micro method: Top-level error:\", error);\n        throw error;\n    }\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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QXFDO29CQUNyQyxJQUFJaEYsUUFBUUEsS0FBS1ksYUFBYSxJQUFJQyxNQUFNQyxPQUFPLENBQUNkLEtBQUtZLGFBQWEsQ0FBQ0csT0FBTyxHQUFHO3dCQUMzRWpKLFFBQVFvQyxLQUFLLENBQUMsQ0FBQyxzQkFBc0IsRUFBRThGLEtBQUtZLGFBQWEsQ0FBQ0csT0FBTyxDQUFDRSxNQUFNLENBQUMsU0FBUyxDQUFDO3dCQUNuRnJCLFFBQVFJLEtBQUtZLGFBQWEsQ0FBQ0csT0FBTztvQkFDcEMsT0FBTzt3QkFDTGpKLFFBQVFvQyxLQUFLLENBQUMsNERBQTREOEY7d0JBQzFFLGdGQUFnRjt3QkFDaEYsaUVBQWlFO3dCQUNqRUosUUFBUSxFQUFFO29CQUNaO2dCQUNGLEdBQ0MyRixLQUFLLENBQUNyTCxDQUFBQTtvQkFDTHBDLFFBQVFvQyxLQUFLLENBQUMsZ0NBQWdDQTtvQkFDOUNvTCxhQUFhTjtvQkFDYm5GLE9BQU8zRjtnQkFDVDtZQUNGLEVBQUUsT0FBT0EsT0FBTztnQkFDZHBDLFFBQVFvQyxLQUFLLENBQUMsaURBQWlEQTtnQkFDL0RvTCxhQUFhTjtnQkFDYm5GLE9BQU8zRjtZQUNUO1FBQ0Y7SUFDRixFQUFFLE9BQU9BLE9BQU87UUFDZHBDLFFBQVFvQyxLQUFLLENBQUMsb0NBQW9DQTtRQUNsRCxNQUFNQTtJQUNSO0FBQ0YiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9pbnZvaWNlLWFwcC8uL3NyYy9saWIvcXVpY2tib29rcy9hcGkudHM/MmNhOCJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBJbnZvaWNlIH0gZnJvbSAnQC90eXBlcy9pbnZvaWNlJ1xuaW1wb3J0IE9BdXRoQ2xpZW50IGZyb20gJ2ludHVpdC1vYXV0aCdcbmltcG9ydCBRdWlja0Jvb2tzIGZyb20gJ25vZGUtcXVpY2tib29rcydcblxuLy8gRmlyc3QsIGxldCdzIHZlcmlmeSBRdWlja0Jvb2tzIGNvbnN0cnVjdG9yIGlzIGF2YWlsYWJsZVxuY29uc29sZS5sb2coJ1F1aWNrQm9va3MgY29uc3RydWN0b3IgY2hlY2s6Jywge1xuICBjb25zdHJ1Y3RvclR5cGU6IHR5cGVvZiBRdWlja0Jvb2tzLFxuICBpc0Z1bmN0aW9uOiB0eXBlb2YgUXVpY2tCb29rcyA9PT0gJ2Z1bmN0aW9uJ1xufSk7XG5cbi8vIFRva2VuIHN0b3JhZ2Uga2V5c1xuZXhwb3J0IGNvbnN0IFRPS0VOX0tFWSA9ICdxYl90b2tlbidcbmV4cG9ydCBjb25zdCBSRUFMTV9JRF9LRVkgPSAncWJfcmVhbG1faWQnXG5leHBvcnQgY29uc3QgUkVGUkVTSF9UT0tFTl9LRVkgPSAncWJfcmVmcmVzaF90b2tlbidcbmV4cG9ydCBjb25zdCBUT0tFTl9FWFBJUllfS0VZID0gJ3FiX3Rva2VuX2V4cGlyeSdcblxuLy8gRGVidWcgZmxhZ1xuY29uc3QgREVCVUcgPSB0cnVlO1xuXG4vLyBIZWxwZXIgZnVuY3Rpb24gdG8gbG9nIGRlYnVnIGluZm9ybWF0aW9uXG5jb25zdCBkZWJ1Z0xvZyA9ICguLi5hcmdzOiBhbnlbXSkgPT4ge1xuICBpZiAoREVCVUcpIHtcbiAgICBjb25zb2xlLmxvZygnW1F1aWNrQm9va3MgQVBJIERlYnVnXScsIC4uLmFyZ3MpO1xuICB9XG59O1xuXG4vLyBFbnN1cmUgd2UgaGF2ZSBhIHByb3Blcmx5IGZvcm1hdHRlZCBiYXNlIFVSTCB3aXRoIHByb3RvY29sXG5jb25zdCBnZXRCYXNlVXJsID0gKCkgPT4geyBcbiAgY29uc3QgYmFzZVVybCA9IHByb2Nlc3MuZW52Lk5FWFRfUFVCTElDX0JBU0VfVVJMIHx8ICdodHRwOi8vbG9jYWxob3N0OjMwMDAnO1xuICBcbiAgLy8gTWFrZSBzdXJlIFVSTCBoYXMgYSBwcm90b2NvbFxuICBpZiAoIWJhc2VVcmwuc3RhcnRzV2l0aCgnaHR0cDovLycpICYmICFiYXNlVXJsLnN0YXJ0c1dpdGgoJ2h0dHBzOi8vJykpIHtcbiAgICByZXR1cm4gYGh0dHA6Ly8ke2Jhc2VVcmx9YDtcbiAgfVxuICBcbiAgLy8gUmVtb3ZlIHRyYWlsaW5nIHNsYXNoIGlmIHByZXNlbnRcbiAgcmV0dXJuIGJhc2VVcmwucmVwbGFjZSgvXFwvJC8sICcnKTtcbn07XG5cbmNvbnN0IGdldFJlZGlyZWN0VXJpID0gKCkgPT4ge1xuICBjb25zdCBiYXNlVXJsID0gZ2V0QmFzZVVybCgpO1xuICByZXR1cm4gYCR7YmFzZVVybH0vYXBpL2F1dGgvY2FsbGJhY2tgO1xufTtcblxuLy8gSW5pdGlhbGl6ZSBPQXV0aCBjbGllbnQgLSB1c2UgY3JlYXRlT0F1dGhDbGllbnQgZnVuY3Rpb24gY29uc2lzdGVudGx5XG5sZXQgb2F1dGhDbGllbnQ6IGFueTtcblxubGV0IHFibzogUXVpY2tCb29rcyB8IG51bGwgPSBudWxsXG5leHBvcnQgeyBxYm8gfTtcblxuLy8gU2VydmVyLXNpZGUgaW4tbWVtb3J5IHRva2VuIHN0b3JlXG4vLyBOT1RFOiBUaGlzIHdpbGwgYmUgcmVzZXQgb24gc2VydmVyIHJlc3RhcnRzIGFuZCBiZXR3ZWVuIHNlcnZlcmxlc3MgZnVuY3Rpb24gaW52b2NhdGlvbnNcbmV4cG9ydCBsZXQgdG9rZW5TdG9yZToge1xuICBhY2Nlc3NUb2tlbj86IHN0cmluZztcbiAgcmVhbG1JZD86IHN0cmluZztcbiAgcmVmcmVzaFRva2VuPzogc3RyaW5nO1xuICB0b2tlbkV4cGlyeT86IG51bWJlcjtcbn0gPSB7fTtcblxuLy8gS2VlcCB0cmFjayBvZiBpbml0aWFsaXphdGlvbiBzdGF0dXNcbmxldCBpc0luaXRpYWxpemVkID0gZmFsc2U7XG5cbi8vIFN0b3JlIHRva2VuIGJvdGggaW4gbWVtb3J5IGFuZCBpbiBsb2NhbFN0b3JhZ2UgKGlmIGF2YWlsYWJsZSlcbmNvbnN0IHN0b3JlVG9rZW4gPSAoYWNjZXNzVG9rZW46IHN0cmluZywgcmVhbG1JZDogc3RyaW5nLCByZWZyZXNoVG9rZW4/OiBzdHJpbmcsIGV4cGlyZXNJbj86IG51bWJlcikgPT4ge1xuICB0cnkge1xuICAgIGRlYnVnTG9nKCdTdG9yaW5nIHRva2VuJyk7XG4gICAgXG4gICAgLy8gU3RvcmUgdG9rZW4gaW4gbWVtb3J5IGZvciBzZXJ2ZXItc2lkZSB1c2VcbiAgICB0b2tlblN0b3JlLmFjY2Vzc1Rva2VuID0gYWNjZXNzVG9rZW47XG4gICAgdG9rZW5TdG9yZS5yZWFsbUlkID0gcmVhbG1JZDtcbiAgICBcbiAgICBpZiAocmVmcmVzaFRva2VuKSB7XG4gICAgICB0b2tlblN0b3JlLnJlZnJlc2hUb2tlbiA9IHJlZnJlc2hUb2tlbjtcbiAgICB9XG4gICAgXG4gICAgaWYgKGV4cGlyZXNJbikge1xuICAgICAgY29uc3QgZXhwaXJ5VGltZSA9IERhdGUubm93KCkgKyAoZXhwaXJlc0luICogMTAwMCk7XG4gICAgICB0b2tlblN0b3JlLnRva2VuRXhwaXJ5ID0gZXhwaXJ5VGltZTtcbiAgICB9XG4gICAgXG4gICAgLy8gVHJ5IHRvIHN0b3JlIGluIGxvY2FsU3RvcmFnZSBmb3IgcGVyc2lzdGVuY2UgaWYgd2UncmUgaW4gYnJvd3NlclxuICAgIGlmICh0eXBlb2Ygd2luZG93ICE9PSAndW5kZWZpbmVkJykge1xuICAgICAgdHJ5IHtcbiAgICAgIGxvY2FsU3RvcmFnZS5zZXRJdGVtKFRPS0VOX0tFWSwgYWNjZXNzVG9rZW4pO1xuICAgICAgbG9jYWxTdG9yYWdlLnNldEl0ZW0oUkVBTE1fSURfS0VZLCByZWFsbUlkKTtcbiAgICAgIFxuICAgICAgaWYgKHJlZnJlc2hUb2tlbikge1xuICAgICAgICBsb2NhbFN0b3JhZ2Uuc2V0SXRlbShSRUZSRVNIX1RPS0VOX0tFWSwgcmVmcmVzaFRva2VuKTtcbiAgICAgIH1cbiAgICAgIFxuICAgICAgaWYgKGV4cGlyZXNJbikge1xuICAgICAgICAgIGNvbnN0IGV4cGlyeVRpbWUgPSBEYXRlLm5vdygpICsgKGV4cGlyZXNJbiAqIDEwMDApO1xuICAgICAgICAgIGxvY2FsU3RvcmFnZS5zZXRJdGVtKFRPS0VOX0VYUElSWV9LRVksIGV4cGlyeVRpbWUudG9TdHJpbmcoKSk7XG4gICAgICAgIH1cbiAgICAgIH0gY2F0Y2ggKGxvY2FsU3RvcmFnZUVycm9yKSB7XG4gICAgICAgIGNvbnNvbGUuZXJyb3IoJ0ZhaWxlZCB0byBzdG9yZSB0b2tlbiBpbiBsb2NhbFN0b3JhZ2U6JywgbG9jYWxTdG9yYWdlRXJyb3IpO1xuICAgICAgfVxuICAgIH1cbiAgICBcbiAgICBkZWJ1Z0xvZygnVG9rZW4gc3RvcmVkIHN1Y2Nlc3NmdWxseScpO1xuICAgIHJldHVybiB0cnVlO1xuICB9IGNhdGNoIChlcnJvcikge1xuICAgIGNvbnNvbGUuZXJyb3IoJ0ZhaWxlZCB0byBzdG9yZSB0b2tlbjonLCBlcnJvcik7XG4gICAgcmV0dXJuIGZhbHNlO1xuICB9XG59O1xuXG4vLyBSZXRyaWV2ZSB0b2tlbiBmcm9tIG1lbW9yeSBvciBsb2NhbFN0b3JhZ2VcbmNvbnN0IGdldFN0b3JlZFRva2VuID0gKCkgPT4ge1xuICB0cnkge1xuICAgIGRlYnVnTG9nKCdSZXRyaWV2aW5nIHN0b3JlZCB0b2tlbicpO1xuICAgIFxuICAgIC8vIEZpcnN0IHRyeSBtZW1vcnkgc3RvcmUgZm9yIHNlcnZlci1zaWRlXG4gICAgaWYgKHRva2VuU3RvcmUuYWNjZXNzVG9rZW4gJiYgdG9rZW5TdG9yZS5yZWFsbUlkKSB7XG4gICAgICBkZWJ1Z0xvZygnVG9rZW4gZm91bmQgaW4gbWVtb3J5Jyk7XG4gICAgICByZXR1cm4geyBcbiAgICAgICAgYWNjZXNzVG9rZW46IHRva2VuU3RvcmUuYWNjZXNzVG9rZW4sIFxuICAgICAgICByZWFsbUlkOiB0b2tlblN0b3JlLnJlYWxtSWQsXG4gICAgICAgIHJlZnJlc2hUb2tlbjogdG9rZW5TdG9yZS5yZWZyZXNoVG9rZW4sXG4gICAgICAgIHRva2VuRXhwaXJ5OiB0b2tlblN0b3JlLnRva2VuRXhwaXJ5XG4gICAgICB9O1xuICAgIH1cbiAgICBcbiAgICAvLyBJZiBub3QgaW4gbWVtb3J5LCB0cnkgbG9jYWxTdG9yYWdlIGlmIHdlJ3JlIGluIGJyb3dzZXJcbiAgICBpZiAodHlwZW9mIHdpbmRvdyAhPT0gJ3VuZGVmaW5lZCcpIHtcbiAgICAgIGNvbnN0IGFjY2Vzc1Rva2VuID0gbG9jYWxTdG9yYWdlLmdldEl0ZW0oVE9LRU5fS0VZKTtcbiAgICAgIGNvbnN0IHJlYWxtSWQgPSBsb2NhbFN0b3JhZ2UuZ2V0SXRlbShSRUFMTV9JRF9LRVkpO1xuICAgICAgY29uc3QgcmVmcmVzaFRva2VuID0gbG9jYWxTdG9yYWdlLmdldEl0ZW0oUkVGUkVTSF9UT0tFTl9LRVkpO1xuICAgICAgY29uc3QgdG9rZW5FeHBpcnlTdHIgPSBsb2NhbFN0b3JhZ2UuZ2V0SXRlbShUT0tFTl9FWFBJUllfS0VZKTtcbiAgICAgIFxuICAgICAgaWYgKGFjY2Vzc1Rva2VuICYmIHJlYWxtSWQpIHtcbiAgICAgICAgZGVidWdMb2coJ1Rva2VuIGZvdW5kIGluIGxvY2FsU3RvcmFnZScpO1xuICAgICAgICBcbiAgICAgICAgLy8gQWxzbyB1cGRhdGUgbWVtb3J5IHN0b3JlIGZvciBmdXR1cmUgdXNlXG4gICAgICAgIHRva2VuU3RvcmUuYWNjZXNzVG9rZW4gPSBhY2Nlc3NUb2tlbjtcbiAgICAgICAgdG9rZW5TdG9yZS5yZWFsbUlkID0gcmVhbG1JZDtcbiAgICAgICAgXG4gICAgICAgIGlmIChyZWZyZXNoVG9rZW4pIHtcbiAgICAgICAgICB0b2tlblN0b3JlLnJlZnJlc2hUb2tlbiA9IHJlZnJlc2hUb2tlbjtcbiAgICAgICAgfVxuICAgICAgICBcbiAgICAgICAgaWYgKHRva2VuRXhwaXJ5U3RyKSB7XG4gICAgICAgICAgdG9rZW5TdG9yZS50b2tlbkV4cGlyeSA9IHBhcnNlSW50KHRva2VuRXhwaXJ5U3RyLCAxMCk7XG4gICAgICAgIH1cbiAgICAgICAgXG4gICAgICAgIHJldHVybiB7IFxuICAgICAgICAgIGFjY2Vzc1Rva2VuLCBcbiAgICAgICAgICByZWFsbUlkLFxuICAgICAgICAgIHJlZnJlc2hUb2tlbjogcmVmcmVzaFRva2VuIHx8IHVuZGVmaW5lZCxcbiAgICAgICAgICB0b2tlbkV4cGlyeTogdG9rZW5FeHBpcnlTdHIgPyBwYXJzZUludCh0b2tlbkV4cGlyeVN0ciwgMTApIDogdW5kZWZpbmVkXG4gICAgICAgIH07XG4gICAgICB9XG4gICAgfVxuICAgIFxuICAgIGRlYnVnTG9nKCdObyB0b2tlbiBmb3VuZCcpO1xuICAgIHJldHVybiBudWxsO1xuICB9IGNhdGNoIChlcnJvcikge1xuICAgIGNvbnNvbGUuZXJyb3IoJ0ZhaWxlZCB0byBnZXQgc3RvcmVkIHRva2VuOicsIGVycm9yKTtcbiAgICByZXR1cm4gbnVsbDtcbiAgfVxufTtcblxuLy8gQ2xlYXIgYWxsIHN0b3JlZCB0b2tlbnNcbmNvbnN0IGNsZWFyVG9rZW5zID0gKCkgPT4ge1xuICBkZWJ1Z0xvZygnQ2xlYXJpbmcgYWxsIHRva2VucycpO1xuICBcbiAgLy8gQ2xlYXIgbWVtb3J5IHN0b3JlXG4gIHRva2VuU3RvcmUgPSB7fTtcbiAgaXNJbml0aWFsaXplZCA9IGZhbHNlO1xuICBxYm8gPSBudWxsO1xuICBcbiAgLy8gQ2xlYXIgbG9jYWxTdG9yYWdlIGlmIGluIGJyb3dzZXJcbiAgaWYgKHR5cGVvZiB3aW5kb3cgIT09ICd1bmRlZmluZWQnKSB7XG4gICAgdHJ5IHtcbiAgICBsb2NhbFN0b3JhZ2UucmVtb3ZlSXRlbShUT0tFTl9LRVkpO1xuICAgIGxvY2FsU3RvcmFnZS5yZW1vdmVJdGVtKFJFQUxNX0lEX0tFWSk7XG4gICAgbG9jYWxTdG9yYWdlLnJlbW92ZUl0ZW0oUkVGUkVTSF9UT0tFTl9LRVkpO1xuICAgIGxvY2FsU3RvcmFnZS5yZW1vdmVJdGVtKFRPS0VOX0VYUElSWV9LRVkpO1xuICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICBjb25zb2xlLmVycm9yKCdGYWlsZWQgdG8gY2xlYXIgbG9jYWxTdG9yYWdlOicsIGVycm9yKTtcbiAgICB9XG4gIH1cbn07XG5cbmV4cG9ydCBmdW5jdGlvbiBpbml0aWFsaXplUUJPKGFjY2Vzc1Rva2VuOiBzdHJpbmcsIHJlYWxtSWQ6IHN0cmluZywgcmVmcmVzaFRva2VuPzogc3RyaW5nLCBleHBpcmVzSW4/OiBudW1iZXIpOiBib29sZWFuIHtcbiAgdHJ5IHtcbiAgICBjb25zb2xlLmxvZygnQkFTSUMgUXVpY2tCb29rcyBjbGllbnQgaW5pdGlhbGl6YXRpb24nLCB7XG4gICAgICBhY2Nlc3NUb2tlblByZXNlbnQ6ICEhYWNjZXNzVG9rZW4sXG4gICAgICByZWFsbUlkUHJlc2VudDogISFyZWFsbUlkLFxuICAgICAgY2xpZW50SWRQcmVzZW50OiAhIXByb2Nlc3MuZW52LlFVSUNLQk9PS1NfQ0xJRU5UX0lELFxuICAgICAgY2xpZW50U2VjcmV0UHJlc2VudDogISFwcm9jZXNzLmVudi5RVUlDS0JPT0tTX0NMSUVOVF9TRUNSRVRcbiAgICB9KTtcbiAgICBcbiAgICAvLyBWYWxpZGF0ZSByZXF1aXJlbWVudHNcbiAgICBpZiAoIWFjY2Vzc1Rva2VuIHx8ICFyZWFsbUlkKSB7XG4gICAgICBjb25zb2xlLmVycm9yKCdFUlJPUjogTWlzc2luZyB0b2tlbiBvciByZWFsbUlkIGZvciBRdWlja0Jvb2tzIGluaXRpYWxpemF0aW9uJyk7XG4gICAgICByZXR1cm4gZmFsc2U7XG4gICAgfVxuICAgIFxuICAgIGNvbnN0IGNsaWVudElkID0gcHJvY2Vzcy5lbnYuUVVJQ0tCT09LU19DTElFTlRfSUQ7XG4gICAgY29uc3QgY2xpZW50U2VjcmV0ID0gcHJvY2Vzcy5lbnYuUVVJQ0tCT09LU19DTElFTlRfU0VDUkVUO1xuICAgIFxuICAgIGlmICghY2xpZW50SWQgfHwgIWNsaWVudFNlY3JldCkge1xuICAgICAgY29uc29sZS5lcnJvcignRVJST1I6IE1pc3NpbmcgUXVpY2tCb29rcyBjcmVkZW50aWFscycpO1xuICAgICAgcmV0dXJuIGZhbHNlO1xuICAgIH1cbiAgICBcbiAgICAvLyBTdG9yZSB0aGUgdG9rZW4gZmlyc3RcbiAgICBzdG9yZVRva2VuKGFjY2Vzc1Rva2VuLCByZWFsbUlkLCByZWZyZXNoVG9rZW4sIGV4cGlyZXNJbik7XG4gICAgXG4gICAgLy8gVUxUUkEgU0lNUExFIENMSUVOVCBDUkVBVElPTiAtIEZJUlNUIEFUVEVNUFRcbiAgICB0cnkge1xuICAgICAgY29uc29sZS5sb2coJ0NyZWF0aW5nIG1pbmltYWwgUXVpY2tCb29rcyBjbGllbnQgLSBhdHRlbXB0IDEnKTtcbiAgICAgIFxuICAgICAgLy8gQ3JlYXRlIHRoZSBjbGllbnQgd2l0aCBhYnNvbHV0ZSBtaW5pbWFsIHBhcmFtZXRlcnNcbiAgICBxYm8gPSBuZXcgUXVpY2tCb29rcyhcbiAgICAgICAgY2xpZW50SWQsXG4gICAgICAgIGNsaWVudFNlY3JldCxcbiAgICAgIGFjY2Vzc1Rva2VuLFxuICAgICAgICBmYWxzZSwgLy8gVXNlIE9BdXRoMS4wYSBpbnN0ZWFkIG9mIE9BdXRoMiBcbiAgICAgIHJlYWxtSWRcbiAgICApO1xuICAgIFxuICAgICAgaWYgKCFxYm8pIHtcbiAgICAgICAgY29uc29sZS5lcnJvcignUXVpY2tCb29rcyBjb25zdHJ1Y3RvciByZXR1cm5lZCBudWxsIC0gYXR0ZW1wdCAxJyk7XG4gICAgICAgIC8vIFdlJ2xsIHRyeSBmYWxsYmFjayBhcHByb2FjaCBiZWxvd1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgLy8gU2V0IHRoZXNlIGV4cGxpY2l0bHkgdG8gZW5zdXJlIHRoZXkncmUgYXZhaWxhYmxlXG4gICAgICAgIHFiby5hY2Nlc3NUb2tlbiA9IGFjY2Vzc1Rva2VuO1xuICAgICAgICBxYm8ucmVhbG1JZCA9IHJlYWxtSWQ7XG4gICAgICAgIFxuICAgICAgICBjb25zb2xlLmxvZygnUXVpY2tCb29rcyBjbGllbnQgY3JlYXRlZCB3aXRoIGJhc2ljIHByb3BlcnRpZXM6Jywge1xuICAgICAgICAgIGhhc1FibzogISFxYm8sXG4gICAgICAgICAgaGFzVG9rZW46ICEhKHFibyAmJiBxYm8uYWNjZXNzVG9rZW4pLFxuICAgICAgICAgIGhhc1JlYWxtSWQ6ICEhKHFibyAmJiBxYm8ucmVhbG1JZCksXG4gICAgICAgIH0pO1xuICAgICAgICBcbiAgICAgICAgLy8gU2V0IGluaXRpYWxpemF0aW9uIGZsYWdcbiAgICAgICAgaXNJbml0aWFsaXplZCA9IHRydWU7XG4gICAgICAgIGNvbnNvbGUubG9nKCdRdWlja0Jvb2tzIGNsaWVudCBpbml0aWFsaXplZCBzdWNjZXNzZnVsbHkgLSBhdHRlbXB0IDEnKTtcbiAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICB9XG4gICAgfVxuICAgIGNhdGNoIChjbGllbnRFcnJvcikge1xuICAgICAgY29uc29sZS5lcnJvcignRVJST1IgY3JlYXRpbmcgUXVpY2tCb29rcyBjbGllbnQgaW5zdGFuY2UgLSBhdHRlbXB0IDE6JywgY2xpZW50RXJyb3IpO1xuICAgICAgLy8gV2UnbGwgdHJ5IGZhbGxiYWNrIGFwcHJvYWNoIGJlbG93XG4gICAgfVxuICAgIFxuICAgIC8vIEZBTExCQUNLIEFQUFJPQUNIIC0gQVRURU1QVCAyXG4gICAgdHJ5IHtcbiAgICAgIGNvbnNvbGUubG9nKCdDcmVhdGluZyBmYWxsYmFjayBRdWlja0Jvb2tzIGNsaWVudCAtIGF0dGVtcHQgMicpO1xuICAgICAgXG4gICAgICAvLyBUcnkgd2l0aCBkaWZmZXJlbnQgcGFyYW1ldGVycyAtIHNvbWUgdmVyc2lvbnMgbmVlZCB1c2VTYW5kYm94IHBhcmFtZXRlclxuICAgICAgcWJvID0gbmV3IFF1aWNrQm9va3MoXG4gICAgICAgIGNsaWVudElkLFxuICAgICAgICBjbGllbnRTZWNyZXQsXG4gICAgICAgIGFjY2Vzc1Rva2VuLFxuICAgICAgICB0cnVlLCAvLyBUcnkgd2l0aCBPQXV0aDIgbW9kZSBcbiAgICAgICAgcmVhbG1JZCxcbiAgICAgICAge1xuICAgICAgICAgIHVzZVNhbmRib3g6IHRydWVcbiAgICAgICAgfVxuICAgICAgKTtcbiAgICAgIFxuICAgICAgaWYgKCFxYm8pIHtcbiAgICAgICAgY29uc29sZS5lcnJvcignUXVpY2tCb29rcyBjb25zdHJ1Y3RvciByZXR1cm5lZCBudWxsIC0gYXR0ZW1wdCAyJyk7XG4gICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgIH1cbiAgICAgIFxuICAgICAgLy8gU2V0IHRoZXNlIGV4cGxpY2l0bHkgdG8gZW5zdXJlIHRoZXkncmUgYXZhaWxhYmxlXG4gICAgICBxYm8uYWNjZXNzVG9rZW4gPSBhY2Nlc3NUb2tlbjtcbiAgICAgIHFiby5yZWFsbUlkID0gcmVhbG1JZDtcbiAgICAgIFxuICAgICAgY29uc29sZS5sb2coJ1F1aWNrQm9va3MgY2xpZW50IGNyZWF0ZWQgd2l0aCBmYWxsYmFjayBhcHByb2FjaCcpO1xuICAgICAgXG4gICAgICAvLyBTZXQgaW5pdGlhbGl6YXRpb24gZmxhZ1xuICAgIGlzSW5pdGlhbGl6ZWQgPSB0cnVlO1xuICAgICAgY29uc29sZS5sb2coJ1F1aWNrQm9va3MgY2xpZW50IGluaXRpYWxpemVkIHN1Y2Nlc3NmdWxseSAtIGF0dGVtcHQgMicpO1xuICAgIHJldHVybiB0cnVlO1xuICAgIH1cbiAgICBjYXRjaCAoZmFsbGJhY2tFcnJvcikge1xuICAgICAgY29uc29sZS5lcnJvcignRVJST1IgY3JlYXRpbmcgUXVpY2tCb29rcyBjbGllbnQgd2l0aCBmYWxsYmFjayBhcHByb2FjaDonLCBmYWxsYmFja0Vycm9yKTtcbiAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9XG4gIH1cbiAgY2F0Y2ggKGVycm9yKSB7XG4gICAgY29uc29sZS5lcnJvcignRkFUQUwgRVJST1IgaW4gUXVpY2tCb29rcyBpbml0aWFsaXphdGlvbjonLCBlcnJvcik7XG4gICAgcmV0dXJuIGZhbHNlO1xuICB9XG59XG5cbi8vIENoZWNrIGlmIGNsaWVudCBpcyBpbml0aWFsaXplZCBvciB0cnkgdG8gaW5pdGlhbGl6ZSBmcm9tIHN0b3JlZCB0b2tlblxuZXhwb3J0IGNvbnN0IGNoZWNrQ2xpZW50SW5pdGlhbGl6ZWQgPSAoKSA9PiB7XG4gIGNvbnNvbGUubG9nKCdDaGVja2luZyBpZiBRdWlja0Jvb2tzIGNsaWVudCBpcyBpbml0aWFsaXplZCcpO1xuICBcbiAgdHJ5IHtcbiAgICAvLyBJZiBhbHJlYWR5IGluaXRpYWxpemVkIGluIHRoaXMgc2Vzc2lvbiwgdmVyaWZ5IHRoZSBjbGllbnQgaXMgc3RpbGwgdmFsaWRcbiAgICBpZiAocWJvICYmIGlzSW5pdGlhbGl6ZWQpIHtcbiAgICAgIGNvbnNvbGUubG9nKCdRdWlja0Jvb2tzIGNsaWVudCBhcHBlYXJzIHRvIGJlIGluaXRpYWxpemVkLCB2YWxpZGF0aW5nLi4uJyk7XG4gICAgICBcbiAgICAgIC8vIFZlcmlmeSB0aGUgY2xpZW50IGhhcyBhbGwgcmVxdWlyZWQgcHJvcGVydGllc1xuICAgICAgaWYgKCFxYm8uYWNjZXNzVG9rZW4gfHwgIXFiby5yZWFsbUlkKSB7XG4gICAgICAgIGNvbnNvbGUubG9nKCdDbGllbnQgaXMgbWlzc2luZyByZXF1aXJlZCBwcm9wZXJ0aWVzLCB3aWxsIGF0dGVtcHQgdG8gcmVpbml0aWFsaXplJyk7XG4gICAgICAgIGlzSW5pdGlhbGl6ZWQgPSBmYWxzZTtcbiAgICAgICAgcWJvID0gbnVsbDtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIGNvbnNvbGUubG9nKCdDbGllbnQgYXBwZWFycyB2YWxpZCB3aXRoIHJlcXVpcmVkIHByb3BlcnRpZXMnKTtcbiAgICAgIHJldHVybiB0cnVlO1xuICAgICAgfVxuICAgIH0gZWxzZSB7XG4gICAgICBjb25zb2xlLmxvZygnUXVpY2tCb29rcyBjbGllbnQgaXMgbm90IGluaXRpYWxpemVkLCB3aWxsIGF0dGVtcHQgdG8gaW5pdGlhbGl6ZSBmcm9tIHN0b3JlZCB0b2tlbicpO1xuICAgIH1cbiAgICBcbiAgICAvLyBUcnkgdG8gcmV0cmlldmUgdG9rZW4gLSBJTVBPUlRBTlQ6IENoZWNrIGJvdGggc2VydmVyLXNpZGUgdG9rZW5TdG9yZSBhbmQgY29va2llc1xuICAgIGNvbnNvbGUubG9nKCdBdHRlbXB0aW5nIHRvIHJldHJpZXZlIHN0b3JlZCB0b2tlbicpO1xuICAgIGNvbnN0IHN0b3JlZFRva2VuID0gZ2V0U2VydmVyU2lkZVRva2VuKCk7XG4gICAgXG4gICAgaWYgKCFzdG9yZWRUb2tlbiB8fCAhc3RvcmVkVG9rZW4uYWNjZXNzVG9rZW4gfHwgIXN0b3JlZFRva2VuLnJlYWxtSWQpIHtcbiAgICAgIGNvbnNvbGUubG9nKCdObyB2YWxpZCBzdG9yZWQgdG9rZW4gZm91bmQnKTtcbiAgICAgIHRocm93IG5ldyBFcnJvcignUXVpY2tCb29rcyBjbGllbnQgbm90IGluaXRpYWxpemVkLiBQbGVhc2UgY29ubmVjdCB5b3VyIFF1aWNrQm9va3MgYWNjb3VudCBmaXJzdC4nKTtcbiAgICB9XG4gICAgXG4gICAgY29uc29sZS5sb2coJ0ZvdW5kIHN0b3JlZCB0b2tlbiwgaW5pdGlhbGl6aW5nIFF1aWNrQm9va3MgY2xpZW50IHdpdGg6Jywge1xuICAgICAgaGFzQWNjZXNzVG9rZW46ICEhc3RvcmVkVG9rZW4uYWNjZXNzVG9rZW4sXG4gICAgICBoYXNSZWFsbUlkOiAhIXN0b3JlZFRva2VuLnJlYWxtSWQsXG4gICAgICBoYXNSZWZyZXNoVG9rZW46ICEhc3RvcmVkVG9rZW4ucmVmcmVzaFRva2VuLFxuICAgIH0pO1xuICAgIFxuICAgIC8vIEluaXRpYWxpemUgd2l0aCBjdXJyZW50IHRva2VuXG4gICAgY29uc3QgaW5pdFJlc3VsdCA9IGluaXRpYWxpemVRQk8oXG4gICAgICBzdG9yZWRUb2tlbi5hY2Nlc3NUb2tlbiwgXG4gICAgICBzdG9yZWRUb2tlbi5yZWFsbUlkLFxuICAgICAgc3RvcmVkVG9rZW4ucmVmcmVzaFRva2VuLFxuICAgICAgc3RvcmVkVG9rZW4udG9rZW5FeHBpcnkgPyBNYXRoLmZsb29yKChzdG9yZWRUb2tlbi50b2tlbkV4cGlyeSAtIERhdGUubm93KCkpIC8gMTAwMCkgOiB1bmRlZmluZWRcbiAgICApO1xuICAgIFxuICAgIGlmICghaW5pdFJlc3VsdCkge1xuICAgICAgY29uc29sZS5lcnJvcignRmFpbGVkIHRvIGluaXRpYWxpemUgUXVpY2tCb29rcyBjbGllbnQgd2l0aCBzdG9yZWQgdG9rZW4nKTtcbiAgICAgIHRocm93IG5ldyBFcnJvcignRmFpbGVkIHRvIGluaXRpYWxpemUgUXVpY2tCb29rcyBjbGllbnQuIFBsZWFzZSByZWNvbm5lY3QgeW91ciBRdWlja0Jvb2tzIGFjY291bnQuJyk7XG4gICAgfVxuICAgIFxuICAgIGNvbnNvbGUubG9nKCdTdWNjZXNzZnVsbHkgaW5pdGlhbGl6ZWQgUXVpY2tCb29rcyBjbGllbnQgZnJvbSBzdG9yZWQgdG9rZW4nKTtcbiAgICByZXR1cm4gdHJ1ZTtcbiAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICBjb25zb2xlLmVycm9yKCdFcnJvciBpbiBjaGVja0NsaWVudEluaXRpYWxpemVkOicsIGVycm9yKTtcbiAgICB0aHJvdyBlcnJvcjtcbiAgfVxufTtcblxuLy8gRW5oYW5jZWQgZnVuY3Rpb24gdG8gZ2V0IHRva2VuIGZyb20gc2VydmVyLXNpZGUgc291cmNlcyAodG9rZW5TdG9yZSBhbmQgY29va2llcylcbmZ1bmN0aW9uIGdldFNlcnZlclNpZGVUb2tlbigpIHtcbiAgY29uc29sZS5sb2coJ0dldHRpbmcgc2VydmVyLXNpZGUgdG9rZW4nKTtcbiAgXG4gIHRyeSB7XG4gICAgLy8gRmlyc3QgY2hlY2sgbWVtb3J5IHN0b3JlXG4gICAgaWYgKHRva2VuU3RvcmUuYWNjZXNzVG9rZW4gJiYgdG9rZW5TdG9yZS5yZWFsbUlkKSB7XG4gICAgICBjb25zb2xlLmxvZygnVG9rZW4gZm91bmQgaW4gc2VydmVyIG1lbW9yeSBzdG9yZScpO1xuICAgICAgcmV0dXJuIHtcbiAgICAgICAgYWNjZXNzVG9rZW46IHRva2VuU3RvcmUuYWNjZXNzVG9rZW4sXG4gICAgICAgIHJlYWxtSWQ6IHRva2VuU3RvcmUucmVhbG1JZCxcbiAgICAgICAgcmVmcmVzaFRva2VuOiB0b2tlblN0b3JlLnJlZnJlc2hUb2tlbixcbiAgICAgICAgdG9rZW5FeHBpcnk6IHRva2VuU3RvcmUudG9rZW5FeHBpcnlcbiAgICAgIH07XG4gICAgfVxuXG4gICAgLy8gTmV4dCwgdHJ5IGxvY2FsU3RvcmFnZSBpZiB3ZSdyZSBpbiBhIGJyb3dzZXIgZW52aXJvbm1lbnRcbiAgICBpZiAodHlwZW9mIHdpbmRvdyAhPT0gJ3VuZGVmaW5lZCcpIHtcbiAgICAgIGNvbnN0IGFjY2Vzc1Rva2VuID0gbG9jYWxTdG9yYWdlLmdldEl0ZW0oVE9LRU5fS0VZKTtcbiAgICAgIGNvbnN0IHJlYWxtSWQgPSBsb2NhbFN0b3JhZ2UuZ2V0SXRlbShSRUFMTV9JRF9LRVkpO1xuICAgICAgXG4gICAgICBpZiAoYWNjZXNzVG9rZW4gJiYgcmVhbG1JZCkge1xuICAgICAgICBjb25zb2xlLmxvZygnVG9rZW4gZm91bmQgaW4gbG9jYWxTdG9yYWdlJyk7XG4gICAgICAgIFxuICAgICAgICBjb25zdCByZWZyZXNoVG9rZW4gPSBsb2NhbFN0b3JhZ2UuZ2V0SXRlbShSRUZSRVNIX1RPS0VOX0tFWSk7XG4gICAgICAgIGNvbnN0IHRva2VuRXhwaXJ5U3RyID0gbG9jYWxTdG9yYWdlLmdldEl0ZW0oVE9LRU5fRVhQSVJZX0tFWSk7XG4gICAgICAgIFxuICAgICAgICAvLyBVcGRhdGUgbWVtb3J5IHN0b3JlIGZvciBmdXR1cmUgdXNlXG4gICAgICAgIHRva2VuU3RvcmUuYWNjZXNzVG9rZW4gPSBhY2Nlc3NUb2tlbjtcbiAgICAgICAgdG9rZW5TdG9yZS5yZWFsbUlkID0gcmVhbG1JZDtcbiAgICAgICAgXG4gICAgICAgIGlmIChyZWZyZXNoVG9rZW4pIHtcbiAgICAgICAgICB0b2tlblN0b3JlLnJlZnJlc2hUb2tlbiA9IHJlZnJlc2hUb2tlbjtcbiAgICAgICAgfVxuICAgICAgICBcbiAgICAgICAgaWYgKHRva2VuRXhwaXJ5U3RyKSB7XG4gICAgICAgICAgdG9rZW5TdG9yZS50b2tlbkV4cGlyeSA9IHBhcnNlSW50KHRva2VuRXhwaXJ5U3RyLCAxMCk7XG4gICAgICAgIH1cbiAgICAgICAgXG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgYWNjZXNzVG9rZW4sXG4gICAgICAgICAgcmVhbG1JZCxcbiAgICAgICAgICByZWZyZXNoVG9rZW46IHJlZnJlc2hUb2tlbiB8fCB1bmRlZmluZWQsXG4gICAgICAgICAgdG9rZW5FeHBpcnk6IHRva2VuRXhwaXJ5U3RyID8gcGFyc2VJbnQodG9rZW5FeHBpcnlTdHIsIDEwKSA6IHVuZGVmaW5lZFxuICAgICAgICB9O1xuICAgICAgfVxuICAgIH1cbiAgICBcbiAgICAvLyBObyBkeW5hbWljIGltcG9ydHMgLSB0aGlzIGNhdXNlcyBpc3N1ZXMgaW4gTmV4dC5qc1xuICAgIC8vIFRoZSBjb29raWVzIHdpbGwgYmUgcGFzc2VkIGJ5IHRoZSBpbnZvaWNlcyBBUEkgcm91dGUgZGlyZWN0bHlcbiAgICBjb25zb2xlLmxvZygnTm8gc2VydmVyLXNpZGUgdG9rZW4gZm91bmQgaW4gbWVtb3J5IG9yIGxvY2FsU3RvcmFnZSwgY2hlY2sgY29va2llcyBpbiB0aGUgQVBJIHJvdXRlJyk7XG4gICAgcmV0dXJuIG51bGw7XG4gIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgY29uc29sZS5lcnJvcignRXJyb3IgZ2V0dGluZyBzZXJ2ZXItc2lkZSB0b2tlbjonLCBlcnJvcik7XG4gICAgcmV0dXJuIG51bGw7XG4gIH1cbn1cblxuLy8gRnVuY3Rpb24gdG8gY2hlY2sgaWYgUXVpY2tCb29rcyBpcyByZWFkeSBmb3IgY2xpZW50LXNpZGUgY29tcG9uZW50c1xuZXhwb3J0IGNvbnN0IGlzUXVpY2tCb29rc1JlYWR5ID0gKCk6IGJvb2xlYW4gPT4ge1xuICBpZiAodHlwZW9mIHdpbmRvdyAhPT0gJ3VuZGVmaW5lZCcpIHtcbiAgICBjb25zdCBhY2Nlc3NUb2tlbiA9IGxvY2FsU3RvcmFnZS5nZXRJdGVtKFRPS0VOX0tFWSk7XG4gICAgY29uc3QgcmVhbG1JZCA9IGxvY2FsU3RvcmFnZS5nZXRJdGVtKFJFQUxNX0lEX0tFWSk7XG4gICAgY29uc3QgdG9rZW5FeHBpcnlTdHIgPSBsb2NhbFN0b3JhZ2UuZ2V0SXRlbShUT0tFTl9FWFBJUllfS0VZKTtcbiAgICBcbiAgICAvLyBJZiB0b2tlbiBpcyBleHBpcmVkLCBjb25zaWRlciBub3QgcmVhZHlcbiAgICBpZiAodG9rZW5FeHBpcnlTdHIpIHtcbiAgICAgIGNvbnN0IHRva2VuRXhwaXJ5ID0gcGFyc2VJbnQodG9rZW5FeHBpcnlTdHIsIDEwKTtcbiAgICAgIGlmIChEYXRlLm5vdygpID4gdG9rZW5FeHBpcnkpIHtcbiAgICAgICAgZGVidWdMb2coJ0NsaWVudC1zaWRlIHRva2VuIGlzIGV4cGlyZWQnKTtcbiAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgfVxuICAgIH1cbiAgICBcbiAgICBjb25zdCBpc1JlYWR5ID0gISFhY2Nlc3NUb2tlbiAmJiAhIXJlYWxtSWQ7XG4gICAgZGVidWdMb2coJ0NsaWVudC1zaWRlIFF1aWNrQm9va3MgcmVhZHkgc3RhdGU6JywgaXNSZWFkeSk7XG4gICAgcmV0dXJuIGlzUmVhZHk7XG4gIH1cbiAgcmV0dXJuIGZhbHNlO1xufTtcblxuLy8gSGVscGVyIGZ1bmN0aW9uIHRvIG1hcCBRdWlja0Jvb2tzIGludm9pY2UgZm9ybWF0IHRvIG91ciBhcHAgZm9ybWF0XG5mdW5jdGlvbiBtYXBRdWlja0Jvb2tzSW52b2ljZShxYkludm9pY2U6IGFueSk6IEludm9pY2Uge1xuICB0cnkge1xuICAgIC8vIEV4dHJhY3QgY3VzdG9tZXIgaW5mbyBpZiBhdmFpbGFibGVcbiAgICBjb25zdCBjdXN0b21lck5hbWUgPSBxYkludm9pY2UuQ3VzdG9tZXJSZWY/Lm5hbWUgfHwgJ1Vua25vd24gQ3VzdG9tZXInO1xuICAgIFxuICAgIC8vIEV4dHJhY3QgbGluZSBpdGVtc1xuICAgIGNvbnN0IGxpbmVJdGVtcyA9IChxYkludm9pY2UuTGluZSB8fCBbXSkubWFwKChsaW5lOiBhbnkpID0+IHtcbiAgICAgIHJldHVybiB7XG4gICAgICAgIGlkOiBsaW5lLklkIHx8ICcnLFxuICAgICAgICBkZXNjcmlwdGlvbjogbGluZS5EZXNjcmlwdGlvbiB8fCAnJyxcbiAgICAgICAgYW1vdW50OiBsaW5lLkFtb3VudCB8fCAwLFxuICAgICAgICBxdWFudGl0eTogbGluZS5RdWFudGl0eSB8fCAxLFxuICAgICAgICB1bml0UHJpY2U6IGxpbmUuU2FsZXNJdGVtTGluZURldGFpbD8uVW5pdFByaWNlIHx8IDAsXG4gICAgICB9O1xuICAgIH0pO1xuICAgIFxuICAgIC8vIE1hcCB0byBvdXIgaW52b2ljZSBmb3JtYXRcbiAgcmV0dXJuIHtcbiAgICAgIGlkOiBxYkludm9pY2UuSWQgfHwgJycsXG4gICAgICBpbnZvaWNlTnVtYmVyOiBxYkludm9pY2UuRG9jTnVtYmVyIHx8ICcnLFxuICAgICAgY3VzdG9tZXJOYW1lOiBjdXN0b21lck5hbWUsXG4gICAgICBkYXRlOiBxYkludm9pY2UuVHhuRGF0ZSB8fCAnJyxcbiAgICAgIGR1ZURhdGU6IHFiSW52b2ljZS5EdWVEYXRlIHx8ICcnLFxuICAgICAgYW1vdW50OiBxYkludm9pY2UuVG90YWxBbXQgfHwgMCxcbiAgICAgIGJhbGFuY2U6IHFiSW52b2ljZS5CYWxhbmNlIHx8IDAsXG4gICAgICBzdGF0dXM6IHFiSW52b2ljZS5zdGF0dXMgfHwgJ1Vua25vd24nLFxuICAgICAgbGluZUl0ZW1zOiBsaW5lSXRlbXMsXG4gICAgICBjdXJyZW5jeTogcWJJbnZvaWNlLkN1cnJlbmN5UmVmPy5uYW1lIHx8ICdVU0QnXG4gICAgfTtcbiAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICBjb25zb2xlLmVycm9yKCdFcnJvciBtYXBwaW5nIFF1aWNrQm9va3MgaW52b2ljZTonLCBlcnJvcik7XG4gICAgLy8gUmV0dXJuIGEgbWluaW1hbCB2YWxpZCBpbnZvaWNlIHRvIGF2b2lkIGVycm9yc1xuICAgIHJldHVybiB7XG4gICAgICBpZDogcWJJbnZvaWNlLklkIHx8ICcnLFxuICAgICAgaW52b2ljZU51bWJlcjogcWJJbnZvaWNlLkRvY051bWJlciB8fCAnJyxcbiAgICAgIGN1c3RvbWVyTmFtZTogJ0Vycm9yIHBhcnNpbmcgaW52b2ljZScsXG4gICAgICBkYXRlOiBxYkludm9pY2UuVHhuRGF0ZSB8fCAnJyxcbiAgICAgIGR1ZURhdGU6ICcnLFxuICAgICAgYW1vdW50OiAwLFxuICAgICAgYmFsYW5jZTogMCxcbiAgICAgIHN0YXR1czogJ0Vycm9yJyxcbiAgICAgIGxpbmVJdGVtczogW10sXG4gICAgICBjdXJyZW5jeTogJ1VTRCdcbiAgICB9O1xuICB9XG59XG5cbi8vIEZ1bmN0aW9uIHRvIHJlZnJlc2ggUXVpY2tCb29rcyB0b2tlblxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIHJlZnJlc2hRdWlja0Jvb2tzVG9rZW4ocmVmcmVzaFRva2VuOiBzdHJpbmcpOiBQcm9taXNlPGJvb2xlYW4+IHtcbiAgdHJ5IHtcbiAgICBkZWJ1Z0xvZygnQXR0ZW1wdGluZyB0byByZWZyZXNoIHRva2VuJyk7XG4gICAgXG4gICAgLy8gQ3JlYXRlIGEgZnJlc2ggT0F1dGggY2xpZW50IGZvciB0b2tlbiByZWZyZXNoXG4gICAgY29uc3QgZnJlc2hPQXV0aENsaWVudCA9IGNyZWF0ZU9BdXRoQ2xpZW50KCk7XG4gICAgXG4gICAgaWYgKCFmcmVzaE9BdXRoQ2xpZW50KSB7XG4gICAgICBkZWJ1Z0xvZygnRmFpbGVkIHRvIGNyZWF0ZSBmcmVzaCBPQXV0aCBjbGllbnQnKTtcbiAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9XG4gICAgXG4gICAgZGVidWdMb2coJ0NyZWF0ZWQgZnJlc2ggT0F1dGggY2xpZW50IGZvciB0b2tlbiByZWZyZXNoJyk7XG4gICAgXG4gICAgLy8gVHJ5IHRvIHJlZnJlc2ggdG9rZW5cbiAgICBjb25zdCByZWZyZXNoUmVzcG9uc2UgPSBhd2FpdCBmcmVzaE9BdXRoQ2xpZW50LnJlZnJlc2hVc2luZ1Rva2VuKHJlZnJlc2hUb2tlbik7XG4gICAgXG4gICAgaWYgKCFyZWZyZXNoUmVzcG9uc2UpIHtcbiAgICAgIGRlYnVnTG9nKCdObyByZXNwb25zZSBmcm9tIHRva2VuIHJlZnJlc2gnKTtcbiAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9XG4gICAgXG4gICAgY29uc3QgcmVmcmVzaERhdGEgPSByZWZyZXNoUmVzcG9uc2UuZ2V0SnNvbigpO1xuICAgIGRlYnVnTG9nKCdSZWZyZXNoIHJlc3BvbnNlIHJlY2VpdmVkJywgeyBcbiAgICAgIGhhc0FjY2Vzc1Rva2VuOiAhIXJlZnJlc2hEYXRhLmFjY2Vzc190b2tlbixcbiAgICAgIGhhc1JlZnJlc2hUb2tlbjogISFyZWZyZXNoRGF0YS5yZWZyZXNoX3Rva2VuLFxuICAgICAgZXhwaXJlc0luOiByZWZyZXNoRGF0YS5leHBpcmVzX2luXG4gICAgfSk7XG4gICAgXG4gICAgaWYgKCFyZWZyZXNoRGF0YS5hY2Nlc3NfdG9rZW4pIHtcbiAgICAgIGRlYnVnTG9nKCdObyBhY2Nlc3MgdG9rZW4gaW4gcmVmcmVzaCByZXNwb25zZScpO1xuICAgICAgcmV0dXJuIGZhbHNlO1xuICAgIH1cbiAgICBcbiAgICAvLyBTdG9yZSB0aGUgcmVmcmVzaGVkIHRva2VuXG4gICAgc3RvcmVUb2tlbihcbiAgICAgIHJlZnJlc2hEYXRhLmFjY2Vzc190b2tlbixcbiAgICAgIHRva2VuU3RvcmUucmVhbG1JZCB8fCAnJywgLy8gVXNlIGV4aXN0aW5nIHJlYWxtSWRcbiAgICAgIHJlZnJlc2hEYXRhLnJlZnJlc2hfdG9rZW4sXG4gICAgICByZWZyZXNoRGF0YS5leHBpcmVzX2luXG4gICAgKTtcbiAgICBcbiAgICAvLyBSZS1pbml0aWFsaXplIFF1aWNrQm9va3MgY2xpZW50IHdpdGggbmV3IHRva2VuXG4gICAgaWYgKHRva2VuU3RvcmUucmVhbG1JZCkge1xuICAgICAgY29uc3QgaW5pdGlhbGl6ZWQgPSBpbml0aWFsaXplUUJPKFxuICAgICAgICByZWZyZXNoRGF0YS5hY2Nlc3NfdG9rZW4sXG4gICAgICAgIHRva2VuU3RvcmUucmVhbG1JZCxcbiAgICAgICAgcmVmcmVzaERhdGEucmVmcmVzaF90b2tlbixcbiAgICAgICAgcmVmcmVzaERhdGEuZXhwaXJlc19pbiA/IERhdGUubm93KCkgKyAocmVmcmVzaERhdGEuZXhwaXJlc19pbiAqIDEwMDApIDogdW5kZWZpbmVkXG4gICAgICApO1xuICAgICAgXG4gICAgICBkZWJ1Z0xvZygnUXVpY2tCb29rcyBjbGllbnQgcmUtaW5pdGlhbGl6ZWQgYWZ0ZXIgdG9rZW4gcmVmcmVzaDonLCB7IHN1Y2Nlc3M6IGluaXRpYWxpemVkIH0pO1xuICAgICAgcmV0dXJuIGluaXRpYWxpemVkO1xuICAgIH1cbiAgICBcbiAgICBkZWJ1Z0xvZygnTm8gcmVhbG1JZCBhdmFpbGFibGUgdG8gcmUtaW5pdGlhbGl6ZSBjbGllbnQnKTtcbiAgICByZXR1cm4gZmFsc2U7XG4gIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgY29uc29sZS5lcnJvcignRXJyb3IgcmVmcmVzaGluZyB0b2tlbjonLCBlcnJvcik7XG4gICAgZGVidWdMb2coJ1Rva2VuIHJlZnJlc2ggZmFpbGVkIHdpdGggZXJyb3InKTtcbiAgICByZXR1cm4gZmFsc2U7XG4gIH1cbn1cblxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGZldGNoSW52b2ljZXMoKTogUHJvbWlzZTxJbnZvaWNlW10gfCBudWxsPiB7XG4gIGNvbnNvbGUuZXJyb3IoJ+KtkCBmZXRjaEludm9pY2VzOiBTdGFydGluZyBpbnZvaWNlIGZldGNoIHByb2Nlc3MnKTtcbiAgdHJ5IHtcbiAgICBkZWJ1Z0xvZygnU3RhcnRpbmcgZmV0Y2hJbnZvaWNlcy4uLicpO1xuICAgIFxuICAgIC8vIEZpcnN0LCB2ZXJpZnkgd2UgY2FuIGdldCBzdG9yZWQgdG9rZW5zIC0gYW55IHNvdXJjZSBpcyBmaW5lIChtZW1vcnksIGxvY2FsU3RvcmFnZSwgY29va2llcylcbiAgICBjb25zdCB0b2tlbnMgPSBnZXRTdG9yZWRUb2tlbigpO1xuICAgIFxuICAgIGNvbnNvbGUuZXJyb3IoJ+KtkCBmZXRjaEludm9pY2VzOiBUb2tlbiBjaGVjayByZXN1bHQ6JywgeyBcbiAgICAgIGhhc1Rva2VuOiAhIXRva2Vucz8uYWNjZXNzVG9rZW4sXG4gICAgICBoYXNSZWFsbUlkOiAhIXRva2Vucz8ucmVhbG1JZCxcbiAgICAgIGhhc1JlZnJlc2hUb2tlbjogISF0b2tlbnM/LnJlZnJlc2hUb2tlbixcbiAgICAgIHRva2VuRXhwaXJ5OiB0b2tlbnM/LnRva2VuRXhwaXJ5ID8gbmV3IERhdGUodG9rZW5zLnRva2VuRXhwaXJ5KS50b0lTT1N0cmluZygpIDogJ25vbmUnXG4gICAgfSk7XG4gICAgXG4gICAgaWYgKCF0b2tlbnMgfHwgIXRva2Vucy5hY2Nlc3NUb2tlbiB8fCAhdG9rZW5zLnJlYWxtSWQpIHtcbiAgICAgIGNvbnNvbGUuZXJyb3IoJ+KtkCBmZXRjaEludm9pY2VzOiBObyB2YWxpZCB0b2tlbnMgZm91bmQgZm9yIFF1aWNrQm9va3MgQVBJIGNhbGwnKTtcbiAgICAgIHRocm93IG5ldyBFcnJvcignUXVpY2tCb29rcyBhdXRoZW50aWNhdGlvbiByZXF1aXJlZC4gUGxlYXNlIGNvbm5lY3QgeW91ciBhY2NvdW50LicpO1xuICAgIH1cbiAgICBcbiAgICAvLyBDaGVjayBpZiB0b2tlbiBpcyBleHBpcmVkIGFuZCB3ZSBuZWVkIHRvIHJlZnJlc2hcbiAgICBjb25zdCBub3cgPSBEYXRlLm5vdygpO1xuICAgIGNvbnN0IHRva2VuRXhwaXJlZCA9IHRva2Vucy50b2tlbkV4cGlyeSAmJiBub3cgPj0gdG9rZW5zLnRva2VuRXhwaXJ5O1xuICAgIFxuICAgIGNvbnNvbGUuZXJyb3IoJ+KtkCBmZXRjaEludm9pY2VzOiBUb2tlbiBleHBpcnkgY2hlY2s6Jywge1xuICAgICAgbm93OiBuZXcgRGF0ZShub3cpLnRvSVNPU3RyaW5nKCksXG4gICAgICB0b2tlbkV4cGlyeTogdG9rZW5zLnRva2VuRXhwaXJ5ID8gbmV3IERhdGUodG9rZW5zLnRva2VuRXhwaXJ5KS50b0lTT1N0cmluZygpIDogJ3Vua25vd24nLFxuICAgICAgaXNFeHBpcmVkOiB0b2tlbkV4cGlyZWRcbiAgICB9KTtcbiAgICBcbiAgICAvLyBJZiB0b2tlbiBpcyBleHBpcmVkIGFuZCB3ZSBoYXZlIHJlZnJlc2ggdG9rZW4sIHRyeSB0byByZWZyZXNoIGl0XG4gICAgaWYgKHRva2VuRXhwaXJlZCAmJiB0b2tlbnMucmVmcmVzaFRva2VuKSB7XG4gICAgICBjb25zb2xlLmVycm9yKCfirZAgZmV0Y2hJbnZvaWNlczogVG9rZW4gZXhwaXJlZCwgYXR0ZW1wdGluZyB0byByZWZyZXNoJyk7XG4gICAgICBcbiAgICAgIHRyeSB7XG4gICAgICAgIGNvbnN0IHJlZnJlc2hlZCA9IGF3YWl0IHJlZnJlc2hRdWlja0Jvb2tzVG9rZW4odG9rZW5zLnJlZnJlc2hUb2tlbik7XG4gICAgICAgIGNvbnNvbGUuZXJyb3IoJ+KtkCBmZXRjaEludm9pY2VzOiBUb2tlbiByZWZyZXNoIHJlc3VsdDonLCB7IHN1Y2Nlc3M6ICEhcmVmcmVzaGVkIH0pO1xuICAgICAgICBcbiAgICAgICAgaWYgKCFyZWZyZXNoZWQpIHtcbiAgICAgICAgICBjb25zb2xlLmVycm9yKCfirZAgZmV0Y2hJbnZvaWNlczogVG9rZW4gcmVmcmVzaCBmYWlsZWQnKTtcbiAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ0ZhaWxlZCB0byByZWZyZXNoIFF1aWNrQm9va3MgYXV0aGVudGljYXRpb24uIFBsZWFzZSByZWNvbm5lY3QgeW91ciBhY2NvdW50LicpO1xuICAgICAgICB9XG4gICAgICB9IGNhdGNoIChyZWZyZXNoRXJyb3IpIHtcbiAgICAgICAgY29uc29sZS5lcnJvcign4q2QIGZldGNoSW52b2ljZXM6IEVycm9yIHJlZnJlc2hpbmcgdG9rZW46JywgcmVmcmVzaEVycm9yKTtcbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdRdWlja0Jvb2tzIGF1dGhlbnRpY2F0aW9uIGV4cGlyZWQuIFBsZWFzZSByZWNvbm5lY3QgeW91ciBhY2NvdW50LicpO1xuICAgICAgfVxuICAgIH1cbiAgICBcbiAgICAvLyBJbml0aWFsaXplIHRoZSBjbGllbnQgaWYgbm90IGFscmVhZHkgaW5pdGlhbGl6ZWRcbiAgICBpZiAoIXFibykge1xuICAgICAgY29uc29sZS5lcnJvcign4q2QIGZldGNoSW52b2ljZXM6IFF1aWNrQm9va3MgY2xpZW50IG5vdCBpbml0aWFsaXplZCwgYXR0ZW1wdGluZyBpbml0aWFsaXphdGlvbicpO1xuICAgICAgY29uc3QgaW5pdGlhbGl6ZWQgPSBpbml0aWFsaXplUUJPKHRva2Vucy5hY2Nlc3NUb2tlbiwgdG9rZW5zLnJlYWxtSWQsIHRva2Vucy5yZWZyZXNoVG9rZW4sIHRva2Vucy50b2tlbkV4cGlyeSk7XG4gICAgICBcbiAgICAgIGNvbnNvbGUuZXJyb3IoJ+KtkCBmZXRjaEludm9pY2VzOiBJbml0aWFsaXphdGlvbiByZXN1bHQ6JywgeyBzdWNjZXNzOiBpbml0aWFsaXplZCB9KTtcbiAgICAgIFxuICAgICAgaWYgKCFpbml0aWFsaXplZCB8fCAhcWJvKSB7XG4gICAgICAgIGNvbnNvbGUuZXJyb3IoJ+KtkCBmZXRjaEludm9pY2VzOiBDbGllbnQgaW5pdGlhbGl6YXRpb24gZmFpbGVkJyk7XG4gICAgICAgIHRocm93IG5ldyBFcnJvcignRmFpbGVkIHRvIGluaXRpYWxpemUgUXVpY2tCb29rcyBjbGllbnQuIFBsZWFzZSByZWNvbm5lY3QgeW91ciBhY2NvdW50LicpO1xuICAgICAgfVxuICAgIH0gZWxzZSB7XG4gICAgICBjb25zb2xlLmVycm9yKCfirZAgZmV0Y2hJbnZvaWNlczogVXNpbmcgZXhpc3RpbmcgUXVpY2tCb29rcyBjbGllbnQnKTtcbiAgICB9XG4gICAgXG4gICAgLy8gRG91YmxlLWNoZWNrIHRoYXQgcWJvIGlzIHByb3Blcmx5IGluaXRpYWxpemVkIHdpdGggZXNzZW50aWFsIHByb3BlcnRpZXNcbiAgICBpZiAoIXFiby5hY2Nlc3NUb2tlbikge1xuICAgICAgY29uc29sZS5lcnJvcign4q2QIGZldGNoSW52b2ljZXM6IFFCIGNsaWVudCBtaXNzaW5nIGFjY2Vzc1Rva2VuLCB1cGRhdGluZycpO1xuICAgICAgcWJvLmFjY2Vzc1Rva2VuID0gdG9rZW5zLmFjY2Vzc1Rva2VuO1xuICAgIH1cbiAgICBcbiAgICBpZiAoIXFiby5yZWFsbUlkKSB7XG4gICAgICBjb25zb2xlLmVycm9yKCfirZAgZmV0Y2hJbnZvaWNlczogUUIgY2xpZW50IG1pc3NpbmcgcmVhbG1JZCwgdXBkYXRpbmcnKTtcbiAgICAgIHFiby5yZWFsbUlkID0gdG9rZW5zLnJlYWxtSWQ7XG4gICAgfVxuICAgIFxuICAgIC8vIFByaW50IG91dCBldmVyeXRoaW5nIHdlIGNhbiBhYm91dCB0aGUgY2xpZW50IHN0YXRlIGZvciBkZWJ1Z2dpbmdcbiAgICBjb25zb2xlLmVycm9yKCfirZAgZmV0Y2hJbnZvaWNlczogUXVpY2tCb29rcyBjbGllbnQgc3RhdGU6Jywge1xuICAgICAgY2xpZW50RXhpc3RzOiAhIXFibyxcbiAgICAgIGhhc0FjY2Vzc1Rva2VuOiAhIShxYm8gJiYgcWJvLmFjY2Vzc1Rva2VuKSxcbiAgICAgIGhhc1JlYWxtSWQ6ICEhKHFibyAmJiBxYm8ucmVhbG1JZCksXG4gICAgICBoYXNUb2tlblNlY3JldDogISEocWJvICYmIChxYm8gYXMgYW55KS50b2tlblNlY3JldCksXG4gICAgICBvYXV0aHZlcnNpb246IHFibyA/IChxYm8gYXMgYW55KS5vYXV0aHZlcnNpb24gOiAnbm9uZScsXG4gICAgICBoYXNSZWZyZXNoVG9rZW46ICEhKHFibyAmJiAocWJvIGFzIGFueSkucmVmcmVzaFRva2VuKSxcbiAgICB9KTtcbiAgICBcbiAgICAvLyBBdCB0aGlzIHBvaW50LCBxYm8gc2hvdWxkIGJlIGluaXRpYWxpemVkXG4gICAgY29uc29sZS5lcnJvcign4q2QIGZldGNoSW52b2ljZXM6IFBlcmZvcm1pbmcgUXVpY2tCb29rcyBBUEkgY2FsbCBmb3IgaW52b2ljZXMnKTtcbiAgICBcbiAgICByZXR1cm4gbmV3IFByb21pc2UoKHJlc29sdmUsIHJlamVjdCkgPT4ge1xuICAgICAgaWYgKCFxYm8pIHtcbiAgICAgICAgY29uc29sZS5lcnJvcign4q2QIGZldGNoSW52b2ljZXM6IFFCIGNsaWVudCBub3QgYXZhaWxhYmxlIGF0IHJlcXVlc3QgdGltZScpO1xuICAgICAgICByZXR1cm4gcmVqZWN0KG5ldyBFcnJvcignUXVpY2tCb29rcyBjbGllbnQgbm90IGluaXRpYWxpemVkJykpO1xuICAgICAgfVxuICAgICAgXG4gICAgICBjb25zb2xlLmVycm9yKCfirZAgZmV0Y2hJbnZvaWNlczogTWFraW5nIGZpbmRJbnZvaWNlcyBBUEkgY2FsbCcpO1xuICAgICAgXG4gICAgICAvLyBUcnktY2F0Y2ggYmxvY2sgYXJvdW5kIHRoZSBBUEkgY2FsbFxuICAgICAgdHJ5IHtcbiAgICAgICAgLy8gRmlyc3QgdHJ5OiBVc2UgYSBzaW1wbGVyIGFwcHJvYWNoIHdpdGggbm8gZmlsdGVyc1xuICAgICAgICAvLyBNYW55IFF1aWNrQm9va3MgQVBJIGZhaWx1cmVzIGhhcHBlbiBkdWUgdG8gY29tcGxleCBxdWVyaWVzXG4gICAgICAgIGNvbnNvbGUuZXJyb3IoJ+KtkCBmZXRjaEludm9pY2VzOiBUcnlpbmcgc2ltcGxlIHF1ZXJ5IHdpdGggbm8gZmlsdGVycycpO1xuICAgICAgICBcbiAgICAgICAgcWJvLmZpbmRJbnZvaWNlcygnJywgKGVycjogYW55LCBkYXRhOiBhbnkpID0+IHtcbiAgICAgICAgaWYgKGVycikge1xuICAgICAgICAgICAgY29uc29sZS5lcnJvcign4q2QIGZldGNoSW52b2ljZXM6IEVycm9yIGluIHNpbXBsZSBmaW5kSW52b2ljZXMgY2FsbDonLCBlcnIpO1xuICAgICAgICAgICAgY29uc29sZS5lcnJvcign4q2QIEVycm9yIGRldGFpbHM6JywgSlNPTi5zdHJpbmdpZnkoZXJyLCBudWxsLCAyKSk7XG4gICAgICAgICAgICBcbiAgICAgICAgICAgIC8vIElmIHRoZSBzaW1wbGUgYXBwcm9hY2ggZmFpbHMsIHRyeSBhIGJhY2t1cCBhcHByb2FjaFxuICAgICAgICAgICAgY29uc29sZS5lcnJvcign4q2QIGZldGNoSW52b2ljZXM6IFRyeWluZyBhbHRlcm5hdGl2ZSBxdWVyeSBhcHByb2FjaCcpO1xuICAgICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgICAgLy8gVHJ5IHdpdGggdGhlIG9sZGVyIHF1ZXJ5IGFwcHJvYWNoXG4gICAgICAgICAgICAgIHFiby5maW5kSW52b2ljZXMoW1xuICAgICAgICAgICAgICAgIHsgZmllbGQ6ICdNZXRhRGF0YS5MYXN0VXBkYXRlZFRpbWUnLCB2YWx1ZTogJzIwMTAtMDEtMDFUMDA6MDA6MDAnLCBvcGVyYXRvcjogJz4nIH1cbiAgICAgICAgICAgICAgXSwgKGVycjI6IGFueSwgZGF0YTI6IGFueSkgPT4ge1xuICAgICAgICAgICAgICAgIGlmIChlcnIyKSB7XG4gICAgICAgICAgICAgICAgICBjb25zb2xlLmVycm9yKCfirZAgZmV0Y2hJbnZvaWNlczogQm90aCBxdWVyeSBhcHByb2FjaGVzIGZhaWxlZDonLCBlcnIyKTtcbiAgICAgICAgICAgICAgICAgIGNvbnNvbGUuZXJyb3IoJ+KtkCBFcnJvciBkZXRhaWxzOicsIEpTT04uc3RyaW5naWZ5KGVycjIsIG51bGwsIDIpKTtcbiAgICAgICAgICAgICAgICAgIHJldHVybiByZWplY3QoZXJyMik7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgIHByb2Nlc3NJbnZvaWNlUmVzdWx0KGRhdGEyLCByZXNvbHZlLCByZWplY3QpO1xuICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH0gY2F0Y2ggKGJhY2t1cEVycm9yKSB7XG4gICAgICAgICAgICAgIGNvbnNvbGUuZXJyb3IoJ+KtkCBmZXRjaEludm9pY2VzOiBFeGNlcHRpb24gaW4gYmFja3VwIGFwcHJvYWNoOicsIGJhY2t1cEVycm9yKTtcbiAgICAgICAgICAgICAgcmV0dXJuIHJlamVjdChiYWNrdXBFcnJvcik7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIHByb2Nlc3NJbnZvaWNlUmVzdWx0KGRhdGEsIHJlc29sdmUsIHJlamVjdCk7XG4gICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICAgIH0gY2F0Y2ggKGFwaUNhbGxFcnJvcikge1xuICAgICAgICBjb25zb2xlLmVycm9yKCfirZAgZmV0Y2hJbnZvaWNlczogRXhjZXB0aW9uIGR1cmluZyBBUEkgY2FsbCBleGVjdXRpb246JywgYXBpQ2FsbEVycm9yKTtcbiAgICAgICAgcmV0dXJuIHJlamVjdChuZXcgRXJyb3IoYFF1aWNrQm9va3MgQVBJIGNhbGwgZmFpbGVkOiAke2FwaUNhbGxFcnJvciBpbnN0YW5jZW9mIEVycm9yID8gYXBpQ2FsbEVycm9yLm1lc3NhZ2UgOiAnVW5rbm93biBlcnJvcid9YCkpO1xuICAgICAgfVxuICAgIH0pO1xuICB9IGNhdGNoIChlcnJvcikge1xuICAgIGNvbnNvbGUuZXJyb3IoJ+KtkCBmZXRjaEludm9pY2VzOiBFcnJvciBpbiBmZXRjaEludm9pY2VzOicsIGVycm9yKTtcbiAgICB0aHJvdyBlcnJvcjtcbiAgfVxufVxuXG4vLyBIZWxwZXIgZnVuY3Rpb24gdG8gcHJvY2VzcyBpbnZvaWNlIHJlc3VsdHNcbmZ1bmN0aW9uIHByb2Nlc3NJbnZvaWNlUmVzdWx0KGRhdGE6IGFueSwgcmVzb2x2ZTogRnVuY3Rpb24sIHJlamVjdDogRnVuY3Rpb24pIHtcbiAgLy8gQ2hlY2sgaWYgZGF0YSBoYXMgUXVlcnlSZXNwb25zZSBwcm9wZXJ0eSB3aXRoIEludm9pY2UgYXJyYXlcbiAgaWYgKGRhdGEgJiYgZGF0YS5RdWVyeVJlc3BvbnNlICYmIEFycmF5LmlzQXJyYXkoZGF0YS5RdWVyeVJlc3BvbnNlLkludm9pY2UpKSB7XG4gICAgY29uc3QgaW52b2ljZXMgPSBkYXRhLlF1ZXJ5UmVzcG9uc2UuSW52b2ljZTtcbiAgICBjb25zb2xlLmVycm9yKGDirZAgZmV0Y2hJbnZvaWNlczogU3VjY2Vzc2Z1bGx5IGZvdW5kICR7aW52b2ljZXMubGVuZ3RofSBpbnZvaWNlc2ApO1xuICAgIFxuICAgIC8vIElmIG5vIGludm9pY2VzIHdlcmUgZm91bmQsIHJldHVybiBlbXB0eSBhcnJheSByYXRoZXIgdGhhbiBlcnJvclxuICAgIGlmIChpbnZvaWNlcy5sZW5ndGggPT09IDApIHtcbiAgICAgIGNvbnNvbGUuZXJyb3IoJ+KtkCBmZXRjaEludm9pY2VzOiBObyBpbnZvaWNlcyBmb3VuZCBpbiBRdWlja0Jvb2tzIGFjY291bnQnKTtcbiAgICAgIHJldHVybiByZXNvbHZlKFtdKTtcbiAgICB9XG4gICAgXG4gICAgcmV0dXJuIHJlc29sdmUoaW52b2ljZXMpO1xuICB9IGVsc2Uge1xuICAgIGNvbnNvbGUuZXJyb3IoJ+KtkCBmZXRjaEludm9pY2VzOiBJbnZhbGlkIGRhdGEgc3RydWN0dXJlIHJlY2VpdmVkIGZyb20gUUIgQVBJOicsIHR5cGVvZiBkYXRhLCBkYXRhID8gT2JqZWN0LmtleXMoZGF0YSkgOiAnbnVsbCcpO1xuICAgIGNvbnNvbGUuZXJyb3IoJ+KtkCBmZXRjaEludm9pY2VzOiBEYXRhIGR1bXA6JywgSlNPTi5zdHJpbmdpZnkoZGF0YSwgbnVsbCwgMikpO1xuICAgIHJldHVybiByZWplY3QobmV3IEVycm9yKCdJbnZhbGlkIHJlc3BvbnNlIGZyb20gUXVpY2tCb29rcyBBUEknKSk7XG4gIH1cbn1cblxuZXhwb3J0IGNvbnN0IGdldEludm9pY2VCeUlkID0gYXN5bmMgKGlkOiBzdHJpbmcpOiBQcm9taXNlPEludm9pY2U+ID0+IHtcbiAgdHJ5IHtcbiAgICBkZWJ1Z0xvZyhgRmV0Y2hpbmcgaW52b2ljZSBieSBJRDogJHtpZH1gKTtcbiAgICBjaGVja0NsaWVudEluaXRpYWxpemVkKCk7XG4gICAgXG4gICAgaWYgKCFxYm8pIHtcbiAgICAgIGRlYnVnTG9nKCdRQk8gY2xpZW50IGlzIG51bGwgYWZ0ZXIgaW5pdGlhbGl6YXRpb24gY2hlY2snKTtcbiAgICAgIHRocm93IG5ldyBFcnJvcignUXVpY2tCb29rcyBjbGllbnQgaXMgbm90IGF2YWlsYWJsZS4gUGxlYXNlIHJlY29ubmVjdCB5b3VyIFF1aWNrQm9va3MgYWNjb3VudC4nKTtcbiAgICB9XG4gICAgXG4gICAgY29uc3QgY2xlYW5JZCA9IGlkLnJlcGxhY2UoL14oPzppbnYtKT8jP1xccyovaSwgJycpLnRyaW0oKTtcbiAgICBcbiAgICByZXR1cm4gbmV3IFByb21pc2UoKHJlc29sdmUsIHJlamVjdCkgPT4ge1xuICAgICAgZGVidWdMb2coYENhbGxpbmcgUXVpY2tCb29rcyBnZXRJbnZvaWNlIEFQSSBmb3IgSUQ6ICR7Y2xlYW5JZH1gKTtcbiAgICAgIHFibyEuZ2V0SW52b2ljZShjbGVhbklkLCAoZXJyOiBhbnksIGludm9pY2U6IGFueSkgPT4ge1xuICAgICAgICBpZiAoZXJyKSB7XG4gICAgICAgICAgY29uc29sZS5lcnJvcignRXJyb3IgZmV0Y2hpbmcgaW52b2ljZSBmcm9tIFF1aWNrQm9va3MgQVBJOicsIGVycik7XG4gICAgICAgICAgXG4gICAgICAgICAgaWYgKGVyci5jb2RlID09PSAnODAwNDA0MDgnKSB7XG4gICAgICAgICAgICBkZWJ1Z0xvZygnUXVpY2tCb29rcyBpbml0aWFsaXphdGlvbiBlcnJvciAoODAwNDA0MDgpLiBDbGVhcmluZyB0b2tlbnMuJyk7XG4gICAgICAgICAgICBjbGVhclRva2VucygpO1xuICAgICAgICAgICAgcmVqZWN0KG5ldyBFcnJvcignUXVpY2tCb29rcyBjb25uZWN0aW9uIGVycm9yLiBQbGVhc2UgcmVjb25uZWN0IHlvdXIgUXVpY2tCb29rcyBhY2NvdW50LicpKTtcbiAgICAgICAgICB9IGVsc2UgaWYgKGVyci5jb2RlID09PSAnMjcwJyB8fCBlcnIubWVzc2FnZT8uaW5jbHVkZXMoJ1Rva2VuIGludmFsaWQnKSkge1xuICAgICAgICAgICAgZGVidWdMb2coJ0ludmFsaWQgdG9rZW4gZXJyb3IuIENsZWFyaW5nIHRva2Vucy4nKTtcbiAgICAgICAgICAgIGNsZWFyVG9rZW5zKCk7XG4gICAgICAgICAgICByZWplY3QobmV3IEVycm9yKCdRdWlja0Jvb2tzIGF1dGhlbnRpY2F0aW9uIGhhcyBleHBpcmVkLiBQbGVhc2UgcmVjb25uZWN0IHlvdXIgUXVpY2tCb29rcyBhY2NvdW50LicpKTtcbiAgICAgICAgICB9IGVsc2UgaWYgKGVyci5zdGF0dXNDb2RlID09PSA0MDQpIHtcbiAgICAgICAgICAgIHJlamVjdChuZXcgRXJyb3IoYEludm9pY2UgIyR7aWR9IG5vdCBmb3VuZC4gUGxlYXNlIGNoZWNrIHRoZSBpbnZvaWNlIG51bWJlciBhbmQgdHJ5IGFnYWluLmApKTtcbiAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgcmVqZWN0KG5ldyBFcnJvcignRmFpbGVkIHRvIGZldGNoIGludm9pY2UgZnJvbSBRdWlja0Jvb2tzLiBQbGVhc2UgY2hlY2sgeW91ciBjb25uZWN0aW9uLicpKTtcbiAgICAgICAgICB9XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgZGVidWdMb2coJ1N1Y2Nlc3NmdWxseSBmZXRjaGVkIGludm9pY2UgZnJvbSBRdWlja0Jvb2tzJyk7XG4gICAgICAgICAgcmVzb2x2ZShtYXBRdWlja0Jvb2tzSW52b2ljZShpbnZvaWNlKSk7XG4gICAgICAgIH1cbiAgICAgIH0pO1xuICAgIH0pO1xuICB9IGNhdGNoIChlcnJvcikge1xuICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIGluIGdldEludm9pY2VCeUlkOicsIGVycm9yKTtcbiAgICB0aHJvdyBlcnJvcjtcbiAgfVxufTtcblxuLy8gSW5pdGlhbGl6ZSB0aGUgT0F1dGggY2xpZW50XG5pbml0aWFsaXplT0F1dGhDbGllbnQoKTtcblxuLy8gVXBkYXRlIHRoZSBnZXRBdXRoVXJsIGZ1bmN0aW9uIHRvIHVzZSB0aGUgbmV3IGNyZWF0ZU9BdXRoQ2xpZW50IGZ1bmN0aW9uXG5leHBvcnQgY29uc3QgZ2V0QXV0aFVybCA9ICgpID0+IHtcbiAgdHJ5IHtcbiAgICAvLyBMb2cgZW52aXJvbm1lbnQgdmFyaWFibGVzIGZvciBkZWJ1Z2dpbmcgKHJlZGFjdGluZyBzZW5zaXRpdmUgaW5mbylcbiAgICBjb25zb2xlLmxvZygnRW52aXJvbm1lbnQgY2hlY2s6Jywge1xuICAgICAgaGFzQ2xpZW50SWQ6ICEhcHJvY2Vzcy5lbnYuUVVJQ0tCT09LU19DTElFTlRfSUQsXG4gICAgICBoYXNDbGllbnRTZWNyZXQ6ICEhcHJvY2Vzcy5lbnYuUVVJQ0tCT09LU19DTElFTlRfU0VDUkVULFxuICAgICAgcmVkaXJlY3RVcmk6IGdldFJlZGlyZWN0VXJpKCksXG4gICAgICBiYXNlVXJsOiBwcm9jZXNzLmVudi5ORVhUX1BVQkxJQ19CQVNFX1VSTFxuICAgIH0pO1xuXG4gICAgLy8gQ3JlYXRlIGEgZnJlc2ggT0F1dGggY2xpZW50IGZvciB0aGlzIHJlcXVlc3RcbiAgICBjb25zdCBmcmVzaE9BdXRoQ2xpZW50ID0gY3JlYXRlT0F1dGhDbGllbnQoKTtcblxuICAgIC8vIEdlbmVyYXRlIGFuZCBsb2cgdGhlIGF1dGggVVJMXG4gICAgY29uc3QgYXV0aFVybCA9IGZyZXNoT0F1dGhDbGllbnQuYXV0aG9yaXplVXJpKHtcbiAgICAgIHNjb3BlOiBbXG4gICAgICAgIE9BdXRoQ2xpZW50LnNjb3Blcy5BY2NvdW50aW5nLFxuICAgICAgICBPQXV0aENsaWVudC5zY29wZXMuT3BlbklkLFxuICAgICAgICBPQXV0aENsaWVudC5zY29wZXMuUHJvZmlsZSxcbiAgICAgICAgT0F1dGhDbGllbnQuc2NvcGVzLkVtYWlsLFxuICAgICAgXSxcbiAgICAgIHN0YXRlOiAndGVzdHN0YXRlJyxcbiAgICB9KTtcblxuICAgIGNvbnNvbGUubG9nKCdHZW5lcmF0ZWQgYXV0aCBVUkw6JywgYXV0aFVybCk7XG4gICAgcmV0dXJuIGF1dGhVcmw7XG4gIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgY29uc29sZS5lcnJvcignRXJyb3IgaW4gZ2V0QXV0aFVybDonLCBlcnJvcik7XG4gICAgdGhyb3cgZXJyb3I7XG4gIH1cbn07XG5cbmV4cG9ydCBjb25zdCBnZXRSZWRpcmVjdFVyaUZvckRpc3BsYXkgPSAoKSA9PiB7XG4gIHJldHVybiBnZXRSZWRpcmVjdFVyaSgpO1xufTtcblxuLy8gQ3JlYXRlIGEgZnVuY3Rpb24gdG8gZ2V0IGEgZnJlc2ggT0F1dGggY2xpZW50XG5mdW5jdGlvbiBnZXRPQXV0aENsaWVudCgpIHtcbiAgLy8gRW5zdXJlIHRoZSBPQXV0aCBjbGllbnQgaXMgaW5pdGlhbGl6ZWRcbiAgaWYgKCFvYXV0aENsaWVudCkge1xuICAgIGNvbnNvbGUubG9nKCdPQXV0aCBjbGllbnQgbm90IGluaXRpYWxpemVkLCBpbml0aWFsaXppbmcgbm93Jyk7XG4gICAgaWYgKCFpbml0aWFsaXplT0F1dGhDbGllbnQoKSkge1xuICAgICAgdGhyb3cgbmV3IEVycm9yKCdGYWlsZWQgdG8gaW5pdGlhbGl6ZSBPQXV0aCBjbGllbnQnKTtcbiAgICB9XG4gIH1cbiAgXG4gIC8vIFJldHVybiB0aGUgaW5pdGlhbGl6ZWQgY2xpZW50XG4gIHJldHVybiBvYXV0aENsaWVudDtcbn1cblxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGhhbmRsZUNhbGxiYWNrKHVybDogc3RyaW5nKSB7XG4gIHRyeSB7XG4gICAgLy8gQ2xlYXIgYW55IGV4aXN0aW5nIHRva2VucyBhbmQgY2xpZW50XG4gICAgY2xlYXJUb2tlbnMoKTtcbiAgICBxYm8gPSBudWxsO1xuICAgIGlzSW5pdGlhbGl6ZWQgPSBmYWxzZTtcbiAgICBcbiAgICAvLyBBbHdheXMgY3JlYXRlIGEgZnJlc2ggT0F1dGggY2xpZW50IGZvciB0b2tlbiBleGNoYW5nZVxuICAgIC8vIFRoaXMgZW5zdXJlcyB0aGUgdG9rZW5TZWNyZXQgaXMgcHJvcGVybHkgc2V0IGZvciB0aGlzIHNwZWNpZmljIHJlcXVlc3RcbiAgICBjb25zdCBmcmVzaE9BdXRoQ2xpZW50ID0gY3JlYXRlT0F1dGhDbGllbnQoKTtcbiAgICBcbiAgICAvLyBQYXJzZSB0aGUgVVJMIHRvIGdldCB0aGUgcmVhbG1JZCBmcm9tIHF1ZXJ5IHBhcmFtZXRlcnNcbiAgICBjb25zdCB1cmxQYXJhbXMgPSBuZXcgVVJMKHVybCkuc2VhcmNoUGFyYW1zO1xuICAgIGNvbnN0IHJlYWxtSWRGcm9tVXJsID0gdXJsUGFyYW1zLmdldCgncmVhbG1JZCcpO1xuICAgIGNvbnN0IGNvZGUgPSB1cmxQYXJhbXMuZ2V0KCdjb2RlJyk7XG4gICAgXG4gICAgaWYgKCFjb2RlKSB7XG4gICAgICB0aHJvdyBuZXcgRXJyb3IoJ05vIGF1dGhvcml6YXRpb24gY29kZSByZWNlaXZlZCBmcm9tIFF1aWNrQm9va3MnKTtcbiAgICB9XG4gICAgXG4gICAgY29uc29sZS5sb2coJ0NyZWF0aW5nIHRva2VuIHdpdGggZnJlc2ggT0F1dGggY2xpZW50Jywge1xuICAgICAgY29kZTogY29kZSxcbiAgICAgIGhhc1JlYWxtSWQ6ICEhcmVhbG1JZEZyb21VcmwsXG4gICAgICByZWRpcmVjdFVyaTogZ2V0UmVkaXJlY3RVcmkoKSxcbiAgICAgIGhhc0NsaWVudElkOiAhIXByb2Nlc3MuZW52LlFVSUNLQk9PS1NfQ0xJRU5UX0lELFxuICAgICAgaGFzQ2xpZW50U2VjcmV0OiAhIXByb2Nlc3MuZW52LlFVSUNLQk9PS1NfQ0xJRU5UX1NFQ1JFVFxuICAgIH0pO1xuICAgIFxuICAgIC8vIENyZWF0ZSB0b2tlbiB3aXRoIHRoZSBmcmVzaCBjbGllbnRcbiAgICBpZiAoIXByb2Nlc3MuZW52LlFVSUNLQk9PS1NfQ0xJRU5UX1NFQ1JFVCkge1xuICAgICAgdGhyb3cgbmV3IEVycm9yKCdRdWlja0Jvb2tzIGNsaWVudCBzZWNyZXQgaXMgbm90IGNvbmZpZ3VyZWQnKTtcbiAgICB9XG4gICAgXG4gICAgLy8gQ29uZmlndXJlIHRva2VuIGNyZWF0aW9uIG9wdGlvbnMgd2l0aCB0aGUgdG9rZW5TZWNyZXQgZXhwbGljaXRseVxuICAgIGNvbnN0IHRva2VuQ29uZmlnID0ge1xuICAgICAgY29kZTogY29kZSxcbiAgICAgIHJlYWxtSWQ6IHJlYWxtSWRGcm9tVXJsLFxuICAgICAgcmVkaXJlY3RVcmk6IGdldFJlZGlyZWN0VXJpKCksXG4gICAgICB0b2tlblNlY3JldDogcHJvY2Vzcy5lbnYuUVVJQ0tCT09LU19DTElFTlRfU0VDUkVUIC8vIFBhc3MgdG9rZW5TZWNyZXQgZXhwbGljaXRseSBoZXJlXG4gICAgfTtcbiAgICBcbiAgICBjb25zb2xlLmxvZygnQ3JlYXRpbmcgdG9rZW4gd2l0aCBjb25maWc6Jywge1xuICAgICAgaGFzQ29kZTogISF0b2tlbkNvbmZpZy5jb2RlLFxuICAgICAgaGFzUmVhbG1JZDogISF0b2tlbkNvbmZpZy5yZWFsbUlkLFxuICAgICAgaGFzUmVkaXJlY3RVcmk6ICEhdG9rZW5Db25maWcucmVkaXJlY3RVcmksXG4gICAgICBoYXNUb2tlblNlY3JldDogISF0b2tlbkNvbmZpZy50b2tlblNlY3JldFxuICAgIH0pO1xuICAgIFxuICAgIC8vIENyZWF0ZSB0b2tlbiB3aXRoIGV4cGxpY2l0IHBhcmFtc1xuICAgIGNvbnN0IGF1dGhSZXNwb25zZSA9IGF3YWl0IGZyZXNoT0F1dGhDbGllbnQuY3JlYXRlVG9rZW4odXJsLCB0b2tlbkNvbmZpZyk7XG4gICAgY29uc3QgdG9rZW5EYXRhID0gYXV0aFJlc3BvbnNlLmdldEpzb24oKTtcbiAgICBcbiAgICBpZiAoIXRva2VuRGF0YS5hY2Nlc3NfdG9rZW4pIHtcbiAgICAgIHRocm93IG5ldyBFcnJvcignTm8gYWNjZXNzIHRva2VuIHJlY2VpdmVkIGZyb20gUXVpY2tCb29rcycpO1xuICAgIH1cbiAgICBcbiAgICAvLyBVc2UgcmVhbG1JZCBmcm9tIHRva2VuIGRhdGEgaWYgYXZhaWxhYmxlLCBvdGhlcndpc2UgdXNlIGZyb20gVVJMXG4gICAgY29uc3QgcmVhbG1JZCA9IHRva2VuRGF0YS5yZWFsbUlkIHx8IHJlYWxtSWRGcm9tVXJsO1xuICAgIFxuICAgIGlmICghcmVhbG1JZCkge1xuICAgICAgdGhyb3cgbmV3IEVycm9yKCdObyByZWFsbUlkIGZvdW5kIGluIHJlc3BvbnNlIG9yIFVSTCBwYXJhbWV0ZXJzJyk7XG4gICAgfVxuICAgIFxuICAgIC8vIFN0b3JlIHRva2VuIGZpcnN0XG4gICAgY29uc3Qgc3RvcmVSZXN1bHQgPSBzdG9yZVRva2VuKFxuICAgICAgdG9rZW5EYXRhLmFjY2Vzc190b2tlbixcbiAgICAgIHJlYWxtSWQsXG4gICAgICB0b2tlbkRhdGEucmVmcmVzaF90b2tlbixcbiAgICAgIHRva2VuRGF0YS5leHBpcmVzX2luXG4gICAgKTtcbiAgICBcbiAgICBpZiAoIXN0b3JlUmVzdWx0KSB7XG4gICAgICB0aHJvdyBuZXcgRXJyb3IoJ0ZhaWxlZCB0byBzdG9yZSBRdWlja0Jvb2tzIHRva2VuJyk7XG4gICAgfVxuICAgIFxuICAgIC8vIEdldCBjbGllbnQgSUQgYW5kIHNlY3JldFxuICAgIGNvbnN0IGNsaWVudElkID0gcHJvY2Vzcy5lbnYuUVVJQ0tCT09LU19DTElFTlRfSUQ7XG4gICAgY29uc3QgY2xpZW50U2VjcmV0ID0gcHJvY2Vzcy5lbnYuUVVJQ0tCT09LU19DTElFTlRfU0VDUkVUO1xuICAgIFxuICAgIGlmICghY2xpZW50SWQgfHwgIWNsaWVudFNlY3JldCkge1xuICAgICAgdGhyb3cgbmV3IEVycm9yKCdRdWlja0Jvb2tzIGNsaWVudCBjcmVkZW50aWFscyBhcmUgbm90IGNvbmZpZ3VyZWQnKTtcbiAgICB9XG4gICAgXG4gICAgLy8gQ3JlYXRlIHRoZSBjbGllbnQgZGlyZWN0bHkgd2l0aCBuZWVkZWQgcGFyYW1ldGVyc1xuICAgIHFibyA9IG5ldyBRdWlja0Jvb2tzKFxuICAgICAgY2xpZW50SWQsXG4gICAgICBjbGllbnRTZWNyZXQsXG4gICAgICB0b2tlbkRhdGEuYWNjZXNzX3Rva2VuLFxuICAgICAgZmFsc2UsIC8vIFNldCB0byBmYWxzZSBmb3IgcmVndWxhciBPQXV0aFxuICAgICAgcmVhbG1JZCxcbiAgICAgIHtcbiAgICAgICAgbWlub3J2ZXJzaW9uOiAnNjUnLFxuICAgICAgICBkZWJ1ZzogdHJ1ZSxcbiAgICAgICAgdXNlU2FuZGJveDogdHJ1ZSxcbiAgICAgICAgb2F1dGh2ZXJzaW9uOiAnMi4wJywgLy8gRXhwbGljaXRseSBzZXQgT0F1dGggdmVyc2lvbiB0byAyLjBcbiAgICAgICAgcmVxdWVzdFRpbWVvdXQ6IDMwMDAwXG4gICAgICB9XG4gICAgKTtcbiAgICBcbiAgICAvLyBFeHBsaWNpdGx5IHNldCByZXF1aXJlZCBwcm9wZXJ0aWVzIGlmIHRoZXkncmUgbm90IHNldCBieSBjb25zdHJ1Y3RvclxuICAgIGlmIChxYm8pIHtcbiAgICAgIC8vIE1ha2Ugc3VyZSBhY2Nlc3NUb2tlbiBpcyBzZXRcbiAgICAgIGlmICghcWJvLmFjY2Vzc1Rva2VuICYmIHRva2VuRGF0YS5hY2Nlc3NfdG9rZW4pIHtcbiAgICAgICAgcWJvLmFjY2Vzc1Rva2VuID0gdG9rZW5EYXRhLmFjY2Vzc190b2tlbjtcbiAgICAgIH1cbiAgICAgIFxuICAgICAgLy8gTWFrZSBzdXJlIHJlYWxtSWQgaXMgc2V0XG4gICAgICBpZiAoIXFiby5yZWFsbUlkICYmIHJlYWxtSWQpIHtcbiAgICAgICAgcWJvLnJlYWxtSWQgPSByZWFsbUlkO1xuICAgICAgfVxuICAgIH1cbiAgICBcbiAgICAvLyBWZXJpZnkgY2xpZW50IHdhcyBjcmVhdGVkIGFuZCBoYXMgcmVxdWlyZWQgcHJvcGVydGllc1xuICAgIGlmICghcWJvIHx8ICFxYm8uYWNjZXNzVG9rZW4gfHwgIXFiby5yZWFsbUlkKSB7XG4gICAgICBxYm8gPSBudWxsO1xuICAgICAgaXNJbml0aWFsaXplZCA9IGZhbHNlO1xuICAgICAgdGhyb3cgbmV3IEVycm9yKCdRdWlja0Jvb2tzIGNsaWVudCBpbml0aWFsaXphdGlvbiBmYWlsZWQgLSBtaXNzaW5nIHJlcXVpcmVkIHByb3BlcnRpZXMnKTtcbiAgICB9XG4gICAgXG4gICAgLy8gU2V0IGluaXRpYWxpemF0aW9uIHN0YXR1c1xuICAgIGlzSW5pdGlhbGl6ZWQgPSB0cnVlO1xuICAgIGNvbnNvbGUubG9nKCdRdWlja0Jvb2tzIGNsaWVudCBpbml0aWFsaXplZCBzdWNjZXNzZnVsbHknKTtcbiAgICBcbiAgICByZXR1cm4ge1xuICAgICAgYWNjZXNzX3Rva2VuOiB0b2tlbkRhdGEuYWNjZXNzX3Rva2VuLFxuICAgICAgcmVhbG1JZDogcmVhbG1JZCxcbiAgICAgIHJlZnJlc2hfdG9rZW46IHRva2VuRGF0YS5yZWZyZXNoX3Rva2VuLFxuICAgICAgZXhwaXJlc19pbjogdG9rZW5EYXRhLmV4cGlyZXNfaW5cbiAgICB9O1xuICB9IGNhdGNoIChlcnJvcikge1xuICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIGluIGhhbmRsZUNhbGxiYWNrOicsIGVycm9yKTtcbiAgICAvLyBDbGVhciBhbnkgcGFydGlhbCBzdGF0ZVxuICAgIGNsZWFyVG9rZW5zKCk7XG4gICAgcWJvID0gbnVsbDtcbiAgICBpc0luaXRpYWxpemVkID0gZmFsc2U7XG4gICAgdGhyb3cgZXJyb3I7XG4gIH1cbn1cblxuLy8gQWRkIHRoaXMgZnVuY3Rpb24gdG8gdGhlIGFwaS50cyBmaWxlIHRvIGRpcmVjdGx5IHNldCB0b2tlbnNcbmV4cG9ydCBjb25zdCBtYW51YWxseUluaXRpYWxpemVRdWlja0Jvb2tzID0gKCkgPT4ge1xuICB0cnkge1xuICAgIGNvbnNvbGUubG9nKCdNYW51YWxseSBpbml0aWFsaXppbmcgUXVpY2tCb29rcyBjbGllbnQnKTtcbiAgICBcbiAgICAvLyBDcmVhdGUgYW5kIHN0b3JlIGEgbG9uZy1sYXN0aW5nIHRva2VuICgzMCBkYXlzKVxuICAgIGNvbnN0IGFjY2Vzc1Rva2VuID0gJ01BTlVBTF9UT0tFTl8nICsgRGF0ZS5ub3coKTtcbiAgICBjb25zdCByZWFsbUlkID0gJ01BTlVBTF9SRUFMTV8nICsgRGF0ZS5ub3coKTtcbiAgICBjb25zdCBleHBpcmVzSW4gPSAzMCAqIDI0ICogNjAgKiA2MDsgLy8gMzAgZGF5cyBpbiBzZWNvbmRzXG4gICAgXG4gICAgLy8gQ2FsbCB0aGUgZXhpc3RpbmcgaW5pdGlhbGl6ZVFCTyBmdW5jdGlvblxuICAgIGNvbnN0IHJlc3VsdCA9IGluaXRpYWxpemVRQk8oYWNjZXNzVG9rZW4sIHJlYWxtSWQsIGFjY2Vzc1Rva2VuLCBleHBpcmVzSW4pO1xuICAgIFxuICAgIGNvbnNvbGUubG9nKCdNYW51YWwgUXVpY2tCb29rcyBpbml0aWFsaXphdGlvbiByZXN1bHQ6JywgcmVzdWx0KTtcbiAgICByZXR1cm4gcmVzdWx0O1xuICB9IGNhdGNoIChlcnJvcikge1xuICAgIGNvbnNvbGUuZXJyb3IoJ0ZhaWxlZCB0byBtYW51YWxseSBpbml0aWFsaXplIFF1aWNrQm9va3M6JywgZXJyb3IpO1xuICAgIHJldHVybiBmYWxzZTtcbiAgfVxufTtcblxuLy8gQWRkIHRoaXMgZnVuY3Rpb24gdG8gY3JlYXRlIGEgcHJvcGVybHkgY29uZmlndXJlZCBPQXV0aCBjbGllbnRcbmZ1bmN0aW9uIGNyZWF0ZU9BdXRoQ2xpZW50KCkge1xuICB0cnkge1xuICAgIGNvbnN0IGNsaWVudElkID0gcHJvY2Vzcy5lbnYuUVVJQ0tCT09LU19DTElFTlRfSUQ7XG4gICAgY29uc3QgY2xpZW50U2VjcmV0ID0gcHJvY2Vzcy5lbnYuUVVJQ0tCT09LU19DTElFTlRfU0VDUkVUO1xuICAgIFxuICAgIGlmICghY2xpZW50SWQgfHwgIWNsaWVudFNlY3JldCkge1xuICAgICAgdGhyb3cgbmV3IEVycm9yKCdRdWlja0Jvb2tzIGNsaWVudCBjcmVkZW50aWFscyBhcmUgbm90IGNvbmZpZ3VyZWQnKTtcbiAgICB9XG4gICAgXG4gICAgLy8gU0lNUExJRklFRDogQ3JlYXRlIE9BdXRoIGNsaWVudCB3aXRoIG1pbmltYWwgY29uZmlndXJhdGlvblxuICAgIHJldHVybiBuZXcgT0F1dGhDbGllbnQoe1xuICAgICAgY2xpZW50SWQsXG4gICAgICBjbGllbnRTZWNyZXQsXG4gICAgICBlbnZpcm9ubWVudDogJ3NhbmRib3gnLFxuICAgICAgcmVkaXJlY3RVcmk6IGdldFJlZGlyZWN0VXJpKCksXG4gICAgICB0b2tlblNlY3JldDogY2xpZW50U2VjcmV0IC8vIEVzc2VudGlhbCBmb3IgT0F1dGggZmxvd1xuICAgIH0pO1xuICB9IGNhdGNoIChlcnJvcikge1xuICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIGNyZWF0aW5nIE9BdXRoIGNsaWVudDonLCBlcnJvcik7XG4gICAgdGhyb3cgZXJyb3I7XG4gIH1cbn1cblxuLy8gSW5pdGlhbGl6ZSB0aGUgY2xpZW50IGFmdGVyIHRoZSBmdW5jdGlvbiBpcyBkZWZpbmVkXG5mdW5jdGlvbiBpbml0aWFsaXplT0F1dGhDbGllbnQoKSB7XG4gIHRyeSB7XG4gICAgaWYgKCFvYXV0aENsaWVudCkge1xuICAgICAgY29uc29sZS5sb2coJ0luaXRpYWxpemluZyBPQXV0aCBjbGllbnQnKTtcbiAgICAgIG9hdXRoQ2xpZW50ID0gY3JlYXRlT0F1dGhDbGllbnQoKTtcbiAgICAgIGNvbnNvbGUubG9nKCdPQXV0aCBjbGllbnQgaW5pdGlhbGl6ZWQgc3VjY2Vzc2Z1bGx5Jyk7XG4gICAgfVxuICAgIHJldHVybiB0cnVlO1xuICB9IGNhdGNoIChlcnJvcikge1xuICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIGluaXRpYWxpemluZyBPQXV0aCBjbGllbnQ6JywgZXJyb3IpO1xuICAgIHJldHVybiBmYWxzZTtcbiAgfVxufVxuXG4vLyBBZGQgdGhpcyBmdW5jdGlvbiB0byB1cGRhdGUgdG9rZW4gc3RvcmUgZGlyZWN0bHkgZnJvbSB2YWx1ZXNcbmV4cG9ydCBmdW5jdGlvbiB1cGRhdGVUb2tlblN0b3JlRnJvbVZhbHVlcyhcbiAgYWNjZXNzVG9rZW46IHN0cmluZyxcbiAgcmVhbG1JZDogc3RyaW5nLFxuICByZWZyZXNoVG9rZW4/OiBzdHJpbmcsXG4gIHRva2VuRXhwaXJ5PzogbnVtYmVyXG4pOiBib29sZWFuIHtcbiAgdHJ5IHtcbiAgICBkZWJ1Z0xvZygnRGlyZWN0bHkgdXBkYXRpbmcgdG9rZW4gc3RvcmUgd2l0aCBwcm92aWRlZCB2YWx1ZXMnKTtcbiAgICBcbiAgICAvLyBVcGRhdGUgdGhlIHRva2VuIHN0b3JlIGRpcmVjdGx5XG4gICAgdG9rZW5TdG9yZS5hY2Nlc3NUb2tlbiA9IGFjY2Vzc1Rva2VuO1xuICAgIHRva2VuU3RvcmUucmVhbG1JZCA9IHJlYWxtSWQ7XG4gICAgXG4gICAgaWYgKHJlZnJlc2hUb2tlbikge1xuICAgICAgdG9rZW5TdG9yZS5yZWZyZXNoVG9rZW4gPSByZWZyZXNoVG9rZW47XG4gICAgfVxuICAgIFxuICAgIGlmICh0b2tlbkV4cGlyeSkge1xuICAgICAgdG9rZW5TdG9yZS50b2tlbkV4cGlyeSA9IHRva2VuRXhwaXJ5O1xuICAgIH1cbiAgICBcbiAgICBkZWJ1Z0xvZygnVG9rZW4gc3RvcmUgdXBkYXRlZCB3aXRoIHZhbHVlczonLCB7XG4gICAgICBoYXNUb2tlbjogISF0b2tlblN0b3JlLmFjY2Vzc1Rva2VuLFxuICAgICAgaGFzUmVhbG1JZDogISF0b2tlblN0b3JlLnJlYWxtSWQsXG4gICAgICBoYXNSZWZyZXNoVG9rZW46ICEhdG9rZW5TdG9yZS5yZWZyZXNoVG9rZW4sXG4gICAgICB0b2tlbkV4cGlyeTogdG9rZW5TdG9yZS50b2tlbkV4cGlyeSA/IG5ldyBEYXRlKHRva2VuU3RvcmUudG9rZW5FeHBpcnkpLnRvSVNPU3RyaW5nKCkgOiAnbm9uZSdcbiAgICB9KTtcbiAgICBcbiAgICByZXR1cm4gdHJ1ZTtcbiAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICBjb25zb2xlLmVycm9yKCdFcnJvciB1cGRhdGluZyB0b2tlbiBzdG9yZSBmcm9tIHZhbHVlczonLCBlcnJvcik7XG4gICAgcmV0dXJuIGZhbHNlO1xuICB9XG59XG5cbi8vIEFsdGVybmF0aXZlIG1ldGhvZCB0byBmZXRjaCBpbnZvaWNlcyB3aXRoIGEgbW9yZSBkaXJlY3QgYXBwcm9hY2hcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBmZXRjaEludm9pY2VzRGlyZWN0bHkoKTogUHJvbWlzZTxhbnlbXT4ge1xuICBjb25zb2xlLmVycm9yKCfirZAgU3RhcnRpbmcgZGlyZWN0IGludm9pY2UgZmV0Y2ggd2l0aCBhbHRlcm5hdGl2ZSBtZXRob2QnKTtcbiAgXG4gIHRyeSB7XG4gICAgLy8gRmlyc3QsIHZlcmlmeSB3ZSBjYW4gZ2V0IHN0b3JlZCB0b2tlbnNcbiAgICBjb25zdCB0b2tlbnMgPSBnZXRTdG9yZWRUb2tlbigpO1xuICAgIFxuICAgIGlmICghdG9rZW5zIHx8ICF0b2tlbnMuYWNjZXNzVG9rZW4gfHwgIXRva2Vucy5yZWFsbUlkKSB7XG4gICAgICBjb25zb2xlLmVycm9yKCfirZAgTm8gdmFsaWQgdG9rZW5zIGZvciBkaXJlY3QgaW52b2ljZSBmZXRjaCcpO1xuICAgICAgdGhyb3cgbmV3IEVycm9yKCdRdWlja0Jvb2tzIGF1dGhlbnRpY2F0aW9uIHJlcXVpcmVkLiBQbGVhc2UgY29ubmVjdCB5b3VyIGFjY291bnQuJyk7XG4gICAgfVxuICAgIFxuICAgIC8vIFdlJ2xsIHNldCB1cCBhIGZyZXNoIE9BdXRoQ2xpZW50IGluc3RhbmNlIHNwZWNpZmljYWxseSBmb3IgdGhpcyByZXF1ZXN0XG4gICAgY29uc3Qgb2F1dGhDbGllbnRGb3JSZXF1ZXN0ID0gbmV3IE9BdXRoQ2xpZW50KHtcbiAgICAgIGNsaWVudElkOiBwcm9jZXNzLmVudi5RVUlDS0JPT0tTX0NMSUVOVF9JRCEsXG4gICAgICBjbGllbnRTZWNyZXQ6IHByb2Nlc3MuZW52LlFVSUNLQk9PS1NfQ0xJRU5UX1NFQ1JFVCEsXG4gICAgICBlbnZpcm9ubWVudDogJ3NhbmRib3gnLFxuICAgICAgcmVkaXJlY3RVcmk6IGdldFJlZGlyZWN0VXJpKCksXG4gICAgICBsb2dnaW5nOiB0cnVlXG4gICAgfSk7XG4gICAgXG4gICAgLy8gU2V0IHRoZSB0b2tlbnMgb24gdGhlIGNsaWVudFxuICAgIG9hdXRoQ2xpZW50Rm9yUmVxdWVzdC5zZXRUb2tlbih7XG4gICAgICByZWFsbUlkOiB0b2tlbnMucmVhbG1JZCxcbiAgICAgIHRva2VuX3R5cGU6ICdiZWFyZXInLFxuICAgICAgYWNjZXNzX3Rva2VuOiB0b2tlbnMuYWNjZXNzVG9rZW4sXG4gICAgICByZWZyZXNoX3Rva2VuOiB0b2tlbnMucmVmcmVzaFRva2VuIHx8ICcnLFxuICAgICAgZXhwaXJlc19pbjogdG9rZW5zLnRva2VuRXhwaXJ5ID8gTWF0aC5mbG9vcigodG9rZW5zLnRva2VuRXhwaXJ5IC0gRGF0ZS5ub3coKSkgLyAxMDAwKSA6IDM2MDBcbiAgICB9KTtcbiAgICBcbiAgICBjb25zb2xlLmVycm9yKCfirZAgQXR0ZW1wdGluZyBkaXJlY3QgaW52b2ljZSBBUEkgY2FsbCcpO1xuICAgIFxuICAgIC8vIE1ha2UgYSBkaXJlY3QgQVBJIGNhbGwgKG5vdCB1c2luZyBub2RlLXF1aWNrYm9va3MpXG4gICAgcmV0dXJuIG5ldyBQcm9taXNlKChyZXNvbHZlLCByZWplY3QpID0+IHtcbiAgICAgIHRyeSB7XG4gICAgICAgIGNvbnN0IHVybCA9IGBodHRwczovL3NhbmRib3gtcXVpY2tib29rcy5hcGkuaW50dWl0LmNvbS92My9jb21wYW55LyR7dG9rZW5zLnJlYWxtSWR9L3F1ZXJ5YDtcbiAgICAgICAgY29uc3QgaGVhZGVycyA9IHtcbiAgICAgICAgICAnQXV0aG9yaXphdGlvbic6IGBCZWFyZXIgJHt0b2tlbnMuYWNjZXNzVG9rZW59YCxcbiAgICAgICAgICAnQWNjZXB0JzogJ2FwcGxpY2F0aW9uL2pzb24nLFxuICAgICAgICAgICdDb250ZW50LVR5cGUnOiAnYXBwbGljYXRpb24vdGV4dCdcbiAgICAgICAgfTtcbiAgICAgICAgXG4gICAgICAgIC8vIFVzZSBhIHNpbXBsZXIgcXVlcnkgdG8gbWluaW1pemUgcG9zc2libGUgZm9ybWF0IGlzc3Vlc1xuICAgICAgICBjb25zdCBxdWVyeSA9IFwiU0VMRUNUICogRlJPTSBJbnZvaWNlXCI7XG4gICAgICAgIFxuICAgICAgICAvLyBNYWtlIHRoZSBBUEkgY2FsbFxuICAgICAgICBvYXV0aENsaWVudEZvclJlcXVlc3QubWFrZUFwaUNhbGwoe1xuICAgICAgICAgIHVybDogdXJsLFxuICAgICAgICAgIG1ldGhvZDogJ1BPU1QnLFxuICAgICAgICAgIGhlYWRlcnM6IGhlYWRlcnMsXG4gICAgICAgICAgYm9keTogcXVlcnlcbiAgICAgICAgfSwgKGVycjogYW55LCByZXNwb25zZTogYW55KSA9PiB7XG4gICAgICAgICAgaWYgKGVycikge1xuICAgICAgICAgICAgY29uc29sZS5lcnJvcign4q2QIERpcmVjdCBBUEkgY2FsbCBlcnJvcjonLCBlcnIpO1xuICAgICAgICAgICAgcmV0dXJuIHJlamVjdChlcnIpO1xuICAgICAgICAgIH1cbiAgICAgICAgICBcbiAgICAgICAgICB0cnkge1xuICAgICAgICAgICAgLy8gTG9nIHRoZSBlbnRpcmUgcmVzcG9uc2UgZm9yIGRlYnVnZ2luZ1xuICAgICAgICAgICAgY29uc29sZS5lcnJvcign4q2QIERpcmVjdCBBUEkgY2FsbCByZXNwb25zZTonLCByZXNwb25zZSk7XG4gICAgICAgICAgICBcbiAgICAgICAgICAgIGlmICh0eXBlb2YgcmVzcG9uc2UgPT09ICdzdHJpbmcnKSB7XG4gICAgICAgICAgICAgIHJlc3BvbnNlID0gSlNPTi5wYXJzZShyZXNwb25zZSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBcbiAgICAgICAgICAgIC8vIEV4dHJhY3QgaW52b2ljZXMgZGF0YVxuICAgICAgICAgICAgaWYgKHJlc3BvbnNlICYmIHJlc3BvbnNlLlF1ZXJ5UmVzcG9uc2UgJiYgQXJyYXkuaXNBcnJheShyZXNwb25zZS5RdWVyeVJlc3BvbnNlLkludm9pY2UpKSB7XG4gICAgICAgICAgICAgIGNvbnNvbGUuZXJyb3IoYOKtkCBTdWNjZXNzZnVsbHkgZm91bmQgJHtyZXNwb25zZS5RdWVyeVJlc3BvbnNlLkludm9pY2UubGVuZ3RofSBpbnZvaWNlcyBkaXJlY3RseWApO1xuICAgICAgICAgICAgICByZXR1cm4gcmVzb2x2ZShyZXNwb25zZS5RdWVyeVJlc3BvbnNlLkludm9pY2UpO1xuICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgIC8vIElmIHRoZSByZXNwb25zZSBkb2Vzbid0IG1hdGNoIGV4cGVjdGVkIGZvcm1hdCwgdHJ5IHRvIGV4dHJhY3QgdXNlZnVsIGRhdGFcbiAgICAgICAgICAgICAgY29uc29sZS5lcnJvcign4q2QIFVuZXhwZWN0ZWQgcmVzcG9uc2UgZm9ybWF0OicsIHJlc3BvbnNlKTtcbiAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgIC8vIElmIHRoZXJlJ3MgYW55IGRhdGEgdGhhdCBjYW4gYmUgdXNlZCwgcmV0dXJuIGl0XG4gICAgICAgICAgICAgIGlmIChyZXNwb25zZSAmJiB0eXBlb2YgcmVzcG9uc2UgPT09ICdvYmplY3QnKSB7XG4gICAgICAgICAgICAgICAgaWYgKEFycmF5LmlzQXJyYXkocmVzcG9uc2UpKSB7XG4gICAgICAgICAgICAgICAgICByZXR1cm4gcmVzb2x2ZShyZXNwb25zZSk7XG4gICAgICAgICAgICAgICAgfSBlbHNlIGlmIChyZXNwb25zZS5RdWVyeVJlc3BvbnNlKSB7XG4gICAgICAgICAgICAgICAgICByZXR1cm4gcmVzb2x2ZShbcmVzcG9uc2UuUXVlcnlSZXNwb25zZV0pO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgcmV0dXJuIHJlamVjdChuZXcgRXJyb3IoJ0ludmFsaWQgcmVzcG9uc2UgZm9ybWF0IGZyb20gUXVpY2tCb29rcyBBUEknKSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfSBjYXRjaCAocGFyc2VFcnJvcikge1xuICAgICAgICAgICAgY29uc29sZS5lcnJvcign4q2QIEVycm9yIHBhcnNpbmcgZGlyZWN0IEFQSSByZXNwb25zZTonLCBwYXJzZUVycm9yKTtcbiAgICAgICAgICAgIHJldHVybiByZWplY3QocGFyc2VFcnJvcik7XG4gICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICAgIH0gY2F0Y2ggKGFwaUVycm9yKSB7XG4gICAgICAgIGNvbnNvbGUuZXJyb3IoJ+KtkCBFcnJvciBtYWtpbmcgZGlyZWN0IEFQSSBjYWxsOicsIGFwaUVycm9yKTtcbiAgICAgICAgcmV0dXJuIHJlamVjdChhcGlFcnJvcik7XG4gICAgICB9XG4gICAgfSk7XG4gIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgY29uc29sZS5lcnJvcign4q2QIFRvcC1sZXZlbCBlcnJvciBpbiBkaXJlY3QgaW52b2ljZSBmZXRjaDonLCBlcnJvcik7XG4gICAgdGhyb3cgZXJyb3I7XG4gIH1cbn1cblxuLy8gVWx0cmEgbWluaW1hbCBBUEkgY2FsbCBmb3IgUXVpY2tCb29rcyBpbnZvaWNlcyAodGhpcmQgYXBwcm9hY2gpXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gZmV0Y2hJbnZvaWNlc01pY3JvTWV0aG9kKCk6IFByb21pc2U8YW55W10+IHtcbiAgY29uc29sZS5lcnJvcign4q2QIFN0YXJ0aW5nIE1JQ1JPIGludm9pY2UgZmV0Y2ggd2l0aCBiYXJlIG1pbmltdW0gYXBwcm9hY2gnKTtcbiAgXG4gIHRyeSB7XG4gICAgLy8gR2V0IHRva2VucyBkaXJlY3RseSBmcm9tIG1lbW9yeSBzdG9yZSBmaXJzdCBmb3Igc3BlZWRcbiAgICBjb25zdCB0b2tlbnMgPSB0b2tlblN0b3JlLmFjY2Vzc1Rva2VuICYmIHRva2VuU3RvcmUucmVhbG1JZCA/IHtcbiAgICAgIGFjY2Vzc1Rva2VuOiB0b2tlblN0b3JlLmFjY2Vzc1Rva2VuLFxuICAgICAgcmVhbG1JZDogdG9rZW5TdG9yZS5yZWFsbUlkXG4gICAgfSA6IGdldFN0b3JlZFRva2VuKCk7XG4gICAgXG4gICAgaWYgKCF0b2tlbnMgfHwgIXRva2Vucy5hY2Nlc3NUb2tlbiB8fCAhdG9rZW5zLnJlYWxtSWQpIHtcbiAgICAgIGNvbnNvbGUuZXJyb3IoJ+KtkCBObyB2YWxpZCB0b2tlbnMgZm9yIG1pY3JvIGludm9pY2UgZmV0Y2gnKTtcbiAgICAgIHRocm93IG5ldyBFcnJvcignQXV0aGVudGljYXRpb24gcmVxdWlyZWQnKTtcbiAgICB9XG4gICAgXG4gICAgY29uc29sZS5lcnJvcign4q2QIE1pY3JvIG1ldGhvZDogVXNpbmcgbWluaW1hbCBheGlvcy1saWtlIGZldGNoIHdpdGggYmFyZSBBUEkgY2FsbCcpO1xuICAgIFxuICAgIC8vIENyZWF0ZSBhIHByb21pc2Ugd2l0aCBhIHNob3J0IHRpbWVvdXRcbiAgICByZXR1cm4gbmV3IFByb21pc2UoKHJlc29sdmUsIHJlamVjdCkgPT4ge1xuICAgICAgLy8gQ3JlYXRlIGEgdGltZW91dCB0aGF0J3MgbXVjaCBzaG9ydGVyICgxNSBzZWNvbmRzKVxuICAgICAgY29uc3QgdGltZW91dElkID0gc2V0VGltZW91dCgoKSA9PiB7XG4gICAgICAgIGNvbnNvbGUuZXJyb3IoJ+KtkCBNaWNybyBtZXRob2Q6IFJlcXVlc3QgdGltZWQgb3V0IGFmdGVyIDE1IHNlY29uZHMnKTtcbiAgICAgICAgcmVqZWN0KG5ldyBFcnJvcignTWljcm8gbWV0aG9kIHJlcXVlc3QgdGltZWQgb3V0IGFmdGVyIDE1IHNlY29uZHMnKSk7XG4gICAgICB9LCAxNTAwMCk7XG4gICAgICBcbiAgICAgIHRyeSB7XG4gICAgICAgIC8vIFVzaW5nIHRoZSBmZXRjaCBBUEkgZGlyZWN0bHkgaW5zdGVhZCBvZiB0aGUgT0F1dGhDbGllbnQgb3Igbm9kZS1xdWlja2Jvb2tzXG4gICAgICAgIGNvbnN0IHVybCA9IGBodHRwczovL3NhbmRib3gtcXVpY2tib29rcy5hcGkuaW50dWl0LmNvbS92My9jb21wYW55LyR7dG9rZW5zLnJlYWxtSWR9L3F1ZXJ5P3F1ZXJ5PXNlbGVjdCUyMCUyQSUyMGZyb20lMjBJbnZvaWNlJTIwTUFYUkVTVUxUUyUyMDVgO1xuICAgICAgICBcbiAgICAgICAgY29uc29sZS5lcnJvcign4q2QIE1pY3JvIG1ldGhvZDogQ2FsbGluZyBBUEkgZGlyZWN0bHkgYXQgVVJMOicsIHVybCk7XG4gICAgICAgIFxuICAgICAgICBmZXRjaCh1cmwsIHtcbiAgICAgICAgICBtZXRob2Q6ICdHRVQnLFxuICAgICAgICAgIGhlYWRlcnM6IHtcbiAgICAgICAgICAgICdBdXRob3JpemF0aW9uJzogYEJlYXJlciAke3Rva2Vucy5hY2Nlc3NUb2tlbn1gLFxuICAgICAgICAgICAgJ0FjY2VwdCc6ICdhcHBsaWNhdGlvbi9qc29uJyxcbiAgICAgICAgICAgICdDb250ZW50LVR5cGUnOiAnYXBwbGljYXRpb24vanNvbidcbiAgICAgICAgICB9XG4gICAgICAgIH0pXG4gICAgICAgIC50aGVuKHJlc3BvbnNlID0+IHtcbiAgICAgICAgICBjb25zb2xlLmVycm9yKCfirZAgTWljcm8gbWV0aG9kOiBSZWNlaXZlZCByZXNwb25zZSB3aXRoIHN0YXR1czonLCByZXNwb25zZS5zdGF0dXMpO1xuICAgICAgICAgIFxuICAgICAgICAgIGlmICghcmVzcG9uc2Uub2spIHtcbiAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihgQVBJIHJlc3BvbmRlZCB3aXRoIHN0YXR1czogJHtyZXNwb25zZS5zdGF0dXN9YCk7XG4gICAgICAgICAgfVxuICAgICAgICAgIFxuICAgICAgICAgIHJldHVybiByZXNwb25zZS5qc29uKCk7XG4gICAgICAgIH0pXG4gICAgICAgIC50aGVuKGRhdGEgPT4ge1xuICAgICAgICAgIGNvbnNvbGUuZXJyb3IoJ+KtkCBNaWNybyBtZXRob2Q6IFN1Y2Nlc3NmdWxseSBwYXJzZWQgcmVzcG9uc2UgSlNPTicpO1xuICAgICAgICAgIGNsZWFyVGltZW91dCh0aW1lb3V0SWQpO1xuICAgICAgICAgIFxuICAgICAgICAgIC8vIEV4dHJhY3QgaW52b2ljZSBkYXRhIGZyb20gcmVzcG9uc2VcbiAgICAgICAgICBpZiAoZGF0YSAmJiBkYXRhLlF1ZXJ5UmVzcG9uc2UgJiYgQXJyYXkuaXNBcnJheShkYXRhLlF1ZXJ5UmVzcG9uc2UuSW52b2ljZSkpIHtcbiAgICAgICAgICAgIGNvbnNvbGUuZXJyb3IoYOKtkCBNaWNybyBtZXRob2Q6IEZvdW5kICR7ZGF0YS5RdWVyeVJlc3BvbnNlLkludm9pY2UubGVuZ3RofSBpbnZvaWNlc2ApO1xuICAgICAgICAgICAgcmVzb2x2ZShkYXRhLlF1ZXJ5UmVzcG9uc2UuSW52b2ljZSk7XG4gICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIGNvbnNvbGUuZXJyb3IoJ+KtkCBNaWNybyBtZXRob2Q6IFJlc3BvbnNlIGRvZXMgbm90IGNvbnRhaW4gaW52b2ljZSBhcnJheTonLCBkYXRhKTtcbiAgICAgICAgICAgIC8vIElmIHdlIGF0IGxlYXN0IGdvdCBkYXRhIGJ1dCBub3QgaW4gdGhlIGV4cGVjdGVkIGZvcm1hdCwgcmV0dXJuIGFuIGVtcHR5IGFycmF5XG4gICAgICAgICAgICAvLyByYXRoZXIgdGhhbiBmYWlsaW5nIC0gdGhpcyBoZWxwcyB0aGUgVUkgaGFuZGxlIHRoZSBjYXNlIGJldHRlclxuICAgICAgICAgICAgcmVzb2x2ZShbXSk7XG4gICAgICAgICAgfVxuICAgICAgICB9KVxuICAgICAgICAuY2F0Y2goZXJyb3IgPT4ge1xuICAgICAgICAgIGNvbnNvbGUuZXJyb3IoJ+KtkCBNaWNybyBtZXRob2Q6IEZldGNoIGVycm9yOicsIGVycm9yKTtcbiAgICAgICAgICBjbGVhclRpbWVvdXQodGltZW91dElkKTtcbiAgICAgICAgICByZWplY3QoZXJyb3IpO1xuICAgICAgICB9KTtcbiAgICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICAgIGNvbnNvbGUuZXJyb3IoJ+KtkCBNaWNybyBtZXRob2Q6IEV4Y2VwdGlvbiBkdXJpbmcgZmV0Y2ggc2V0dXA6JywgZXJyb3IpO1xuICAgICAgICBjbGVhclRpbWVvdXQodGltZW91dElkKTtcbiAgICAgICAgcmVqZWN0KGVycm9yKTtcbiAgICAgIH1cbiAgICB9KTtcbiAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICBjb25zb2xlLmVycm9yKCfirZAgTWljcm8gbWV0aG9kOiBUb3AtbGV2ZWwgZXJyb3I6JywgZXJyb3IpO1xuICAgIHRocm93IGVycm9yO1xuICB9XG59ICJdLCJuYW1lcyI6WyJPQXV0aENsaWVudCIsIlF1aWNrQm9va3MiLCJjb25zb2xlIiwibG9nIiwiY29uc3RydWN0b3JUeXBlIiwiaXNGdW5jdGlvbiIsIlRPS0VOX0tFWSIsIlJFQUxNX0lEX0tFWSIsIlJFRlJFU0hfVE9LRU5fS0VZIiwiVE9LRU5fRVhQSVJZX0tFWSIsIkRFQlVHIiwiZGVidWdMb2ciLCJhcmdzIiwiZ2V0QmFzZVVybCIsImJhc2VVcmwiLCJwcm9jZXNzIiwiZW52IiwiTkVYVF9QVUJMSUNfQkFTRV9VUkwiLCJzdGFydHNXaXRoIiwicmVwbGFjZSIsImdldFJlZGlyZWN0VXJpIiwib2F1dGhDbGllbnQiLCJxYm8iLCJ0b2tlblN0b3JlIiwiaXNJbml0aWFsaXplZCIsInN0b3JlVG9rZW4iLCJhY2Nlc3NUb2tlbiIsInJlYWxtSWQiLCJyZWZyZXNoVG9rZW4iLCJleHBpcmVzSW4iLCJleHBpcnlUaW1lIiwiRGF0ZSIsIm5vdyIsInRva2VuRXhwaXJ5IiwibG9jYWxTdG9yYWdlIiwic2V0SXRlbSIsInRvU3RyaW5nIiwibG9jYWxTdG9yYWdlRXJyb3IiLCJlcnJvciIsImdldFN0b3JlZFRva2VuIiwiZ2V0SXRlbSIsInRva2VuRXhwaXJ5U3RyIiwicGFyc2VJbnQiLCJ1bmRlZmluZWQiLCJjbGVhclRva2VucyIsInJlbW92ZUl0ZW0iLCJpbml0aWFsaXplUUJPIiwiYWNjZXNzVG9rZW5QcmVzZW50IiwicmVhbG1JZFByZXNlbnQiLCJjbGllbnRJZFByZXNlbnQiLCJRVUlDS0JPT0tTX0NMSUVOVF9JRCIsImNsaWVudFNlY3JldFByZXNlbnQiLCJRVUlDS0JPT0tTX0NMSUVOVF9TRUNSRVQiLCJjbGllbnRJZCIsImNsaWVudFNlY3JldCIsImhhc1FibyIsImhhc1Rva2VuIiwiaGFzUmVhbG1JZCIsImNsaWVudEVycm9yIiwidXNlU2FuZGJveCIsImZhbGxiYWNrRXJyb3IiLCJjaGVja0NsaWVudEluaXRpYWxpemVkIiwic3RvcmVkVG9rZW4iLCJnZXRTZXJ2ZXJTaWRlVG9rZW4iLCJFcnJvciIsImhhc0FjY2Vzc1Rva2VuIiwiaGFzUmVmcmVzaFRva2VuIiwiaW5pdFJlc3VsdCIsIk1hdGgiLCJmbG9vciIsImlzUXVpY2tCb29rc1JlYWR5IiwiaXNSZWFkeSIsIm1hcFF1aWNrQm9va3NJbnZvaWNlIiwicWJJbnZvaWNlIiwiY3VzdG9tZXJOYW1lIiwiQ3VzdG9tZXJSZWYiLCJuYW1lIiwibGluZUl0ZW1zIiwiTGluZSIsIm1hcCIsImxpbmUiLCJpZCIsIklkIiwiZGVzY3JpcHRpb24iLCJEZXNjcmlwdGlvbiIsImFtb3VudCIsIkFtb3VudCIsInF1YW50aXR5IiwiUXVhbnRpdHkiLCJ1bml0UHJpY2UiLCJTYWxlc0l0ZW1MaW5lRGV0YWlsIiwiVW5pdFByaWNlIiwiaW52b2ljZU51bWJlciIsIkRvY051bWJlciIsImRhdGUiLCJUeG5EYXRlIiwiZHVlRGF0ZSIsIkR1ZURhdGUiLCJUb3RhbEFtdCIsImJhbGFuY2UiLCJCYWxhbmNlIiwic3RhdHVzIiwiY3VycmVuY3kiLCJDdXJyZW5jeVJlZiIsInJlZnJlc2hRdWlja0Jvb2tzVG9rZW4iLCJmcmVzaE9BdXRoQ2xpZW50IiwiY3JlYXRlT0F1dGhDbGllbnQiLCJyZWZyZXNoUmVzcG9uc2UiLCJyZWZyZXNoVXNpbmdUb2tlbiIsInJlZnJlc2hEYXRhIiwiZ2V0SnNvbiIsImFjY2Vzc190b2tlbiIsInJlZnJlc2hfdG9rZW4iLCJleHBpcmVzX2luIiwiaW5pdGlhbGl6ZWQiLCJzdWNjZXNzIiwiZmV0Y2hJbnZvaWNlcyIsInRva2VucyIsInRvSVNPU3RyaW5nIiwidG9rZW5FeHBpcmVkIiwiaXNFeHBpcmVkIiwicmVmcmVzaGVkIiwicmVmcmVzaEVycm9yIiwiY2xpZW50RXhpc3RzIiwiaGFzVG9rZW5TZWNyZXQiLCJ0b2tlblNlY3JldCIsIm9hdXRodmVyc2lvbiIsIlByb21pc2UiLCJyZXNvbHZlIiwicmVqZWN0IiwiZmluZEludm9pY2VzIiwiZXJyIiwiZGF0YSIsIkpTT04iLCJzdHJpbmdpZnkiLCJmaWVsZCIsInZhbHVlIiwib3BlcmF0b3IiLCJlcnIyIiwiZGF0YTIiLCJwcm9jZXNzSW52b2ljZVJlc3VsdCIsImJhY2t1cEVycm9yIiwiYXBpQ2FsbEVycm9yIiwibWVzc2FnZSIsIlF1ZXJ5UmVzcG9uc2UiLCJBcnJheSIsImlzQXJyYXkiLCJJbnZvaWNlIiwiaW52b2ljZXMiLCJsZW5ndGgiLCJPYmplY3QiLCJrZXlzIiwiZ2V0SW52b2ljZUJ5SWQiLCJjbGVhbklkIiwidHJpbSIsImdldEludm9pY2UiLCJpbnZvaWNlIiwiY29kZSIsImluY2x1ZGVzIiwic3RhdHVzQ29kZSIsImluaXRpYWxpemVPQXV0aENsaWVudCIsImdldEF1dGhVcmwiLCJoYXNDbGllbnRJZCIsImhhc0NsaWVudFNlY3JldCIsInJlZGlyZWN0VXJpIiwiYXV0aFVybCIsImF1dGhvcml6ZVVyaSIsInNjb3BlIiwic2NvcGVzIiwiQWNjb3VudGluZyIsIk9wZW5JZCIsIlByb2ZpbGUiLCJFbWFpbCIsInN0YXRlIiwiZ2V0UmVkaXJlY3RVcmlGb3JEaXNwbGF5IiwiZ2V0T0F1dGhDbGllbnQiLCJoYW5kbGVDYWxsYmFjayIsInVybCIsInVybFBhcmFtcyIsIlVSTCIsInNlYXJjaFBhcmFtcyIsInJlYWxtSWRGcm9tVXJsIiwiZ2V0IiwidG9rZW5Db25maWciLCJoYXNDb2RlIiwiaGFzUmVkaXJlY3RVcmkiLCJhdXRoUmVzcG9uc2UiLCJjcmVhdGVUb2tlbiIsInRva2VuRGF0YSIsInN0b3JlUmVzdWx0IiwibWlub3J2ZXJzaW9uIiwiZGVidWciLCJyZXF1ZXN0VGltZW91dCIsIm1hbnVhbGx5SW5pdGlhbGl6ZVF1aWNrQm9va3MiLCJyZXN1bHQiLCJlbnZpcm9ubWVudCIsInVwZGF0ZVRva2VuU3RvcmVGcm9tVmFsdWVzIiwiZmV0Y2hJbnZvaWNlc0RpcmVjdGx5Iiwib2F1dGhDbGllbnRGb3JSZXF1ZXN0IiwibG9nZ2luZyIsInNldFRva2VuIiwidG9rZW5fdHlwZSIsImhlYWRlcnMiLCJxdWVyeSIsIm1ha2VBcGlDYWxsIiwibWV0aG9kIiwiYm9keSIsInJlc3BvbnNlIiwicGFyc2UiLCJwYXJzZUVycm9yIiwiYXBpRXJyb3IiLCJmZXRjaEludm9pY2VzTWljcm9NZXRob2QiLCJ0aW1lb3V0SWQiLCJzZXRUaW1lb3V0IiwiZmV0Y2giLCJ0aGVuIiwib2siLCJqc29uIiwiY2xlYXJUaW1lb3V0IiwiY2F0Y2giXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(rsc)/./src/lib/quickbooks/api.ts\n");

/***/ })

};
;

// load runtime
var __webpack_require__ = require("../../../../webpack-runtime.js");
__webpack_require__.C(exports);
var __webpack_exec__ = (moduleId) => (__webpack_require__(__webpack_require__.s = moduleId))
var __webpack_exports__ = __webpack_require__.X(0, ["vendor-chunks/next","vendor-chunks/ajv","vendor-chunks/psl","vendor-chunks/sshpk","vendor-chunks/bluebird","vendor-chunks/mime-db","vendor-chunks/axios","vendor-chunks/readable-stream","vendor-chunks/node-quickbooks","vendor-chunks/request","vendor-chunks/winston","vendor-chunks/underscore","vendor-chunks/tweetnacl","vendor-chunks/fast-xml-parser","vendor-chunks/semver","vendor-chunks/uri-js","vendor-chunks/tough-cookie","vendor-chunks/jsbn","vendor-chunks/color","vendor-chunks/bcrypt-pbkdf","vendor-chunks/async","vendor-chunks/http-signature","vendor-chunks/intuit-oauth","vendor-chunks/logform","vendor-chunks/jsonwebtoken","vendor-chunks/safe-stable-stringify","vendor-chunks/@colors","vendor-chunks/ecc-jsbn","vendor-chunks/follow-redirects","vendor-chunks/debug","vendor-chunks/lodash.includes","vendor-chunks/qs","vendor-chunks/jsprim","vendor-chunks/get-intrinsic","vendor-chunks/form-data","vendor-chunks/aws4","vendor-chunks/asn1","vendor-chunks/fecha","vendor-chunks/json-schema","vendor-chunks/query-string","vendor-chunks/verror","vendor-chunks/winston-transport","vendor-chunks/uuid","vendor-chunks/string_decoder","vendor-chunks/color-name","vendor-chunks/asynckit","vendor-chunks/date-fns","vendor-chunks/jws","vendor-chunks/har-schema","vendor-chunks/@dabh","vendor-chunks/tunnel-agent","vendor-chunks/lodash.once","vendor-chunks/jwa","vendor-chunks/color-string","vendor-chunks/lodash.isinteger","vendor-chunks/ecdsa-sig-formatter","vendor-chunks/assert-plus","vendor-chunks/combined-stream","vendor-chunks/extsprintf","vendor-chunks/forever-agent","vendor-chunks/aws-sign2","vendor-chunks/oauth-sign","vendor-chunks/strnum","vendor-chunks/extend","vendor-chunks/mime-types","vendor-chunks/lodash.isplainobject","vendor-chunks/stack-trace","vendor-chunks/proxy-from-env","vendor-chunks/triple-beam","vendor-chunks/ms","vendor-chunks/request-debug","vendor-chunks/csrf","vendor-chunks/supports-color","vendor-chunks/core-util-is","vendor-chunks/has-symbols","vendor-chunks/kuler","vendor-chunks/decode-uri-component","vendor-chunks/json-schema-traverse","vendor-chunks/delayed-stream","vendor-chunks/har-validator","vendor-chunks/lodash.isstring","vendor-chunks/safer-buffer","vendor-chunks/random-bytes","vendor-chunks/function-bind","vendor-chunks/lodash.isnumber","vendor-chunks/uid-safe","vendor-chunks/caseless","vendor-chunks/fast-json-stable-stringify","vendor-chunks/lodash.isboolean","vendor-chunks/safe-buffer","vendor-chunks/rsa-pem-from-mod-exp","vendor-chunks/es-set-tostringtag","vendor-chunks/fast-deep-equal","vendor-chunks/performance-now","vendor-chunks/tsscmp","vendor-chunks/call-bind-apply-helpers","vendor-chunks/get-proto","vendor-chunks/buffer-equal-constant-time","vendor-chunks/one-time","vendor-chunks/fn.name","vendor-chunks/dunder-proto","vendor-chunks/json-stringify-safe","vendor-chunks/is-typedarray","vendor-chunks/rndm","vendor-chunks/enabled","vendor-chunks/math-intrinsics","vendor-chunks/@babel","vendor-chunks/colorspace","vendor-chunks/is-stream","vendor-chunks/simple-swizzle","vendor-chunks/isstream","vendor-chunks/split-on-first","vendor-chunks/es-errors","vendor-chunks/text-hex","vendor-chunks/filter-obj","vendor-chunks/has-flag","vendor-chunks/is-arrayish","vendor-chunks/es-define-property","vendor-chunks/gopd","vendor-chunks/hasown","vendor-chunks/has-tostringtag","vendor-chunks/strict-uri-encode","vendor-chunks/util-deprecate","vendor-chunks/atob","vendor-chunks/stringify-clone","vendor-chunks/es-object-atoms"], () => (__webpack_exec__("(rsc)/./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Fauth%2Fstatus%2Froute&page=%2Fapi%2Fauth%2Fstatus%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fauth%2Fstatus%2Froute.ts&appDir=C%3A%5CInvoiveManagment%5Csrc%5Capp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=C%3A%5CInvoiveManagment&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D!")));
module.exports = __webpack_exports__;

})();