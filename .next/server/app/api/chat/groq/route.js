"use strict";
/*
 * ATTENTION: An "eval-source-map" devtool has been used.
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file with attached SourceMaps in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
(() => {
var exports = {};
exports.id = "app/api/chat/groq/route";
exports.ids = ["app/api/chat/groq/route"];
exports.modules = {

/***/ "next/dist/compiled/next-server/app-route.runtime.dev.js":
/*!**************************************************************************!*\
  !*** external "next/dist/compiled/next-server/app-route.runtime.dev.js" ***!
  \**************************************************************************/
/***/ ((module) => {

module.exports = require("next/dist/compiled/next-server/app-route.runtime.dev.js");

/***/ }),

/***/ "assert":
/*!*************************!*\
  !*** external "assert" ***!
  \*************************/
/***/ ((module) => {

module.exports = require("assert");

/***/ }),

/***/ "buffer":
/*!*************************!*\
  !*** external "buffer" ***!
  \*************************/
/***/ ((module) => {

module.exports = require("buffer");

/***/ }),

/***/ "crypto":
/*!*************************!*\
  !*** external "crypto" ***!
  \*************************/
/***/ ((module) => {

module.exports = require("crypto");

/***/ }),

/***/ "events":
/*!*************************!*\
  !*** external "events" ***!
  \*************************/
/***/ ((module) => {

module.exports = require("events");

/***/ }),

/***/ "fs":
/*!*********************!*\
  !*** external "fs" ***!
  \*********************/
/***/ ((module) => {

module.exports = require("fs");

/***/ }),

/***/ "http":
/*!***********************!*\
  !*** external "http" ***!
  \***********************/
/***/ ((module) => {

module.exports = require("http");

/***/ }),

/***/ "https":
/*!************************!*\
  !*** external "https" ***!
  \************************/
/***/ ((module) => {

module.exports = require("https");

/***/ }),

/***/ "net":
/*!**********************!*\
  !*** external "net" ***!
  \**********************/
/***/ ((module) => {

module.exports = require("net");

/***/ }),

/***/ "node:fs":
/*!**************************!*\
  !*** external "node:fs" ***!
  \**************************/
/***/ ((module) => {

module.exports = require("node:fs");

/***/ }),

/***/ "node:stream":
/*!******************************!*\
  !*** external "node:stream" ***!
  \******************************/
/***/ ((module) => {

module.exports = require("node:stream");

/***/ }),

/***/ "node:stream/web":
/*!**********************************!*\
  !*** external "node:stream/web" ***!
  \**********************************/
/***/ ((module) => {

module.exports = require("node:stream/web");

/***/ }),

/***/ "os":
/*!*********************!*\
  !*** external "os" ***!
  \*********************/
/***/ ((module) => {

module.exports = require("os");

/***/ }),

/***/ "path":
/*!***********************!*\
  !*** external "path" ***!
  \***********************/
/***/ ((module) => {

module.exports = require("path");

/***/ }),

/***/ "punycode":
/*!***************************!*\
  !*** external "punycode" ***!
  \***************************/
/***/ ((module) => {

module.exports = require("punycode");

/***/ }),

/***/ "querystring":
/*!******************************!*\
  !*** external "querystring" ***!
  \******************************/
/***/ ((module) => {

module.exports = require("querystring");

/***/ }),

/***/ "stream":
/*!*************************!*\
  !*** external "stream" ***!
  \*************************/
/***/ ((module) => {

module.exports = require("stream");

/***/ }),

/***/ "string_decoder":
/*!*********************************!*\
  !*** external "string_decoder" ***!
  \*********************************/
/***/ ((module) => {

module.exports = require("string_decoder");

/***/ }),

/***/ "tls":
/*!**********************!*\
  !*** external "tls" ***!
  \**********************/
/***/ ((module) => {

module.exports = require("tls");

/***/ }),

/***/ "tty":
/*!**********************!*\
  !*** external "tty" ***!
  \**********************/
/***/ ((module) => {

module.exports = require("tty");

/***/ }),

/***/ "url":
/*!**********************!*\
  !*** external "url" ***!
  \**********************/
/***/ ((module) => {

module.exports = require("url");

/***/ }),

/***/ "util":
/*!***********************!*\
  !*** external "util" ***!
  \***********************/
/***/ ((module) => {

module.exports = require("util");

/***/ }),

/***/ "worker_threads":
/*!*********************************!*\
  !*** external "worker_threads" ***!
  \*********************************/
/***/ ((module) => {

module.exports = require("worker_threads");

/***/ }),

/***/ "zlib":
/*!***********************!*\
  !*** external "zlib" ***!
  \***********************/
/***/ ((module) => {

module.exports = require("zlib");

/***/ }),

/***/ "(rsc)/./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Fchat%2Fgroq%2Froute&page=%2Fapi%2Fchat%2Fgroq%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fchat%2Fgroq%2Froute.ts&appDir=C%3A%5CInvoiveManagment%5Csrc%5Capp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=C%3A%5CInvoiveManagment&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D!":
/*!*****************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************!*\
  !*** ./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Fchat%2Fgroq%2Froute&page=%2Fapi%2Fchat%2Fgroq%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fchat%2Fgroq%2Froute.ts&appDir=C%3A%5CInvoiveManagment%5Csrc%5Capp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=C%3A%5CInvoiveManagment&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D! ***!
  \*****************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   headerHooks: () => (/* binding */ headerHooks),\n/* harmony export */   originalPathname: () => (/* binding */ originalPathname),\n/* harmony export */   patchFetch: () => (/* binding */ patchFetch),\n/* harmony export */   requestAsyncStorage: () => (/* binding */ requestAsyncStorage),\n/* harmony export */   routeModule: () => (/* binding */ routeModule),\n/* harmony export */   serverHooks: () => (/* binding */ serverHooks),\n/* harmony export */   staticGenerationAsyncStorage: () => (/* binding */ staticGenerationAsyncStorage),\n/* harmony export */   staticGenerationBailout: () => (/* binding */ staticGenerationBailout)\n/* harmony export */ });\n/* harmony import */ var next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! next/dist/server/future/route-modules/app-route/module.compiled */ \"(rsc)/./node_modules/next/dist/server/future/route-modules/app-route/module.compiled.js\");\n/* harmony import */ var next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var next_dist_server_future_route_kind__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! next/dist/server/future/route-kind */ \"(rsc)/./node_modules/next/dist/server/future/route-kind.js\");\n/* harmony import */ var next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! next/dist/server/lib/patch-fetch */ \"(rsc)/./node_modules/next/dist/server/lib/patch-fetch.js\");\n/* harmony import */ var next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2__);\n/* harmony import */ var C_InvoiveManagment_src_app_api_chat_groq_route_ts__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./src/app/api/chat/groq/route.ts */ \"(rsc)/./src/app/api/chat/groq/route.ts\");\n\n\n\n\n// We inject the nextConfigOutput here so that we can use them in the route\n// module.\nconst nextConfigOutput = \"\"\nconst routeModule = new next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__.AppRouteRouteModule({\n    definition: {\n        kind: next_dist_server_future_route_kind__WEBPACK_IMPORTED_MODULE_1__.RouteKind.APP_ROUTE,\n        page: \"/api/chat/groq/route\",\n        pathname: \"/api/chat/groq\",\n        filename: \"route\",\n        bundlePath: \"app/api/chat/groq/route\"\n    },\n    resolvedPagePath: \"C:\\\\InvoiveManagment\\\\src\\\\app\\\\api\\\\chat\\\\groq\\\\route.ts\",\n    nextConfigOutput,\n    userland: C_InvoiveManagment_src_app_api_chat_groq_route_ts__WEBPACK_IMPORTED_MODULE_3__\n});\n// Pull out the exports that we need to expose from the module. This should\n// be eliminated when we've moved the other routes to the new format. These\n// are used to hook into the route.\nconst { requestAsyncStorage, staticGenerationAsyncStorage, serverHooks, headerHooks, staticGenerationBailout } = routeModule;\nconst originalPathname = \"/api/chat/groq/route\";\nfunction patchFetch() {\n    return (0,next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2__.patchFetch)({\n        serverHooks,\n        staticGenerationAsyncStorage\n    });\n}\n\n\n//# sourceMappingURL=app-route.js.map//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9ub2RlX21vZHVsZXMvbmV4dC9kaXN0L2J1aWxkL3dlYnBhY2svbG9hZGVycy9uZXh0LWFwcC1sb2FkZXIuanM/bmFtZT1hcHAlMkZhcGklMkZjaGF0JTJGZ3JvcSUyRnJvdXRlJnBhZ2U9JTJGYXBpJTJGY2hhdCUyRmdyb3ElMkZyb3V0ZSZhcHBQYXRocz0mcGFnZVBhdGg9cHJpdmF0ZS1uZXh0LWFwcC1kaXIlMkZhcGklMkZjaGF0JTJGZ3JvcSUyRnJvdXRlLnRzJmFwcERpcj1DJTNBJTVDSW52b2l2ZU1hbmFnbWVudCU1Q3NyYyU1Q2FwcCZwYWdlRXh0ZW5zaW9ucz10c3gmcGFnZUV4dGVuc2lvbnM9dHMmcGFnZUV4dGVuc2lvbnM9anN4JnBhZ2VFeHRlbnNpb25zPWpzJnJvb3REaXI9QyUzQSU1Q0ludm9pdmVNYW5hZ21lbnQmaXNEZXY9dHJ1ZSZ0c2NvbmZpZ1BhdGg9dHNjb25maWcuanNvbiZiYXNlUGF0aD0mYXNzZXRQcmVmaXg9Jm5leHRDb25maWdPdXRwdXQ9JnByZWZlcnJlZFJlZ2lvbj0mbWlkZGxld2FyZUNvbmZpZz1lMzAlM0QhIiwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7Ozs7Ozs7O0FBQXNHO0FBQ3ZDO0FBQ2M7QUFDUztBQUN0RjtBQUNBO0FBQ0E7QUFDQSx3QkFBd0IsZ0hBQW1CO0FBQzNDO0FBQ0EsY0FBYyx5RUFBUztBQUN2QjtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0EsWUFBWTtBQUNaLENBQUM7QUFDRDtBQUNBO0FBQ0E7QUFDQSxRQUFRLHVHQUF1RztBQUMvRztBQUNBO0FBQ0EsV0FBVyw0RUFBVztBQUN0QjtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQzZKOztBQUU3SiIsInNvdXJjZXMiOlsid2VicGFjazovL2ludm9pY2UtYXBwLz8zZjJjIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IEFwcFJvdXRlUm91dGVNb2R1bGUgfSBmcm9tIFwibmV4dC9kaXN0L3NlcnZlci9mdXR1cmUvcm91dGUtbW9kdWxlcy9hcHAtcm91dGUvbW9kdWxlLmNvbXBpbGVkXCI7XG5pbXBvcnQgeyBSb3V0ZUtpbmQgfSBmcm9tIFwibmV4dC9kaXN0L3NlcnZlci9mdXR1cmUvcm91dGUta2luZFwiO1xuaW1wb3J0IHsgcGF0Y2hGZXRjaCBhcyBfcGF0Y2hGZXRjaCB9IGZyb20gXCJuZXh0L2Rpc3Qvc2VydmVyL2xpYi9wYXRjaC1mZXRjaFwiO1xuaW1wb3J0ICogYXMgdXNlcmxhbmQgZnJvbSBcIkM6XFxcXEludm9pdmVNYW5hZ21lbnRcXFxcc3JjXFxcXGFwcFxcXFxhcGlcXFxcY2hhdFxcXFxncm9xXFxcXHJvdXRlLnRzXCI7XG4vLyBXZSBpbmplY3QgdGhlIG5leHRDb25maWdPdXRwdXQgaGVyZSBzbyB0aGF0IHdlIGNhbiB1c2UgdGhlbSBpbiB0aGUgcm91dGVcbi8vIG1vZHVsZS5cbmNvbnN0IG5leHRDb25maWdPdXRwdXQgPSBcIlwiXG5jb25zdCByb3V0ZU1vZHVsZSA9IG5ldyBBcHBSb3V0ZVJvdXRlTW9kdWxlKHtcbiAgICBkZWZpbml0aW9uOiB7XG4gICAgICAgIGtpbmQ6IFJvdXRlS2luZC5BUFBfUk9VVEUsXG4gICAgICAgIHBhZ2U6IFwiL2FwaS9jaGF0L2dyb3Evcm91dGVcIixcbiAgICAgICAgcGF0aG5hbWU6IFwiL2FwaS9jaGF0L2dyb3FcIixcbiAgICAgICAgZmlsZW5hbWU6IFwicm91dGVcIixcbiAgICAgICAgYnVuZGxlUGF0aDogXCJhcHAvYXBpL2NoYXQvZ3JvcS9yb3V0ZVwiXG4gICAgfSxcbiAgICByZXNvbHZlZFBhZ2VQYXRoOiBcIkM6XFxcXEludm9pdmVNYW5hZ21lbnRcXFxcc3JjXFxcXGFwcFxcXFxhcGlcXFxcY2hhdFxcXFxncm9xXFxcXHJvdXRlLnRzXCIsXG4gICAgbmV4dENvbmZpZ091dHB1dCxcbiAgICB1c2VybGFuZFxufSk7XG4vLyBQdWxsIG91dCB0aGUgZXhwb3J0cyB0aGF0IHdlIG5lZWQgdG8gZXhwb3NlIGZyb20gdGhlIG1vZHVsZS4gVGhpcyBzaG91bGRcbi8vIGJlIGVsaW1pbmF0ZWQgd2hlbiB3ZSd2ZSBtb3ZlZCB0aGUgb3RoZXIgcm91dGVzIHRvIHRoZSBuZXcgZm9ybWF0LiBUaGVzZVxuLy8gYXJlIHVzZWQgdG8gaG9vayBpbnRvIHRoZSByb3V0ZS5cbmNvbnN0IHsgcmVxdWVzdEFzeW5jU3RvcmFnZSwgc3RhdGljR2VuZXJhdGlvbkFzeW5jU3RvcmFnZSwgc2VydmVySG9va3MsIGhlYWRlckhvb2tzLCBzdGF0aWNHZW5lcmF0aW9uQmFpbG91dCB9ID0gcm91dGVNb2R1bGU7XG5jb25zdCBvcmlnaW5hbFBhdGhuYW1lID0gXCIvYXBpL2NoYXQvZ3JvcS9yb3V0ZVwiO1xuZnVuY3Rpb24gcGF0Y2hGZXRjaCgpIHtcbiAgICByZXR1cm4gX3BhdGNoRmV0Y2goe1xuICAgICAgICBzZXJ2ZXJIb29rcyxcbiAgICAgICAgc3RhdGljR2VuZXJhdGlvbkFzeW5jU3RvcmFnZVxuICAgIH0pO1xufVxuZXhwb3J0IHsgcm91dGVNb2R1bGUsIHJlcXVlc3RBc3luY1N0b3JhZ2UsIHN0YXRpY0dlbmVyYXRpb25Bc3luY1N0b3JhZ2UsIHNlcnZlckhvb2tzLCBoZWFkZXJIb29rcywgc3RhdGljR2VuZXJhdGlvbkJhaWxvdXQsIG9yaWdpbmFsUGF0aG5hbWUsIHBhdGNoRmV0Y2gsICB9O1xuXG4vLyMgc291cmNlTWFwcGluZ1VSTD1hcHAtcm91dGUuanMubWFwIl0sIm5hbWVzIjpbXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(rsc)/./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Fchat%2Fgroq%2Froute&page=%2Fapi%2Fchat%2Fgroq%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fchat%2Fgroq%2Froute.ts&appDir=C%3A%5CInvoiveManagment%5Csrc%5Capp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=C%3A%5CInvoiveManagment&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D!\n");

/***/ }),

/***/ "(rsc)/./src/app/api/chat/groq/route.ts":
/*!****************************************!*\
  !*** ./src/app/api/chat/groq/route.ts ***!
  \****************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   POST: () => (/* binding */ POST)\n/* harmony export */ });\n/* harmony import */ var ai__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ai */ \"(rsc)/./node_modules/ai/dist/index.mjs\");\n/* harmony import */ var openai__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! openai */ \"(rsc)/./node_modules/openai/index.mjs\");\n/* harmony import */ var _lib_quickbooks_api__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @/lib/quickbooks/api */ \"(rsc)/./src/lib/quickbooks/api.ts\");\n\n\n\n// Enable debug logging\nconst DEBUG = true;\nconst log = (...args)=>{\n    if (DEBUG) {\n        console.error(\"[GROQ API]\", ...args);\n    }\n};\n// Initialize OpenAI client as a fallback mechanism\nconst groqClient = new openai__WEBPACK_IMPORTED_MODULE_1__[\"default\"]({\n    apiKey: process.env.GROQ_API_KEY || \"\",\n    baseURL: \"https://api.groq.com/openai/v1\",\n    timeout: 90000\n});\n// Function to create a raw fetch request to Groq for more control\nasync function fetchGroqCompletion(messages) {\n    const apiKey = process.env.GROQ_API_KEY;\n    if (!apiKey) throw new Error(\"Missing GROQ_API_KEY\");\n    // Pre-process all user messages to check for invoice queries\n    let invoiceDataAdded1 = false;\n    const modifiedMessages = [\n        ...messages\n    ];\n    // First, check if the last message contains an invoice reference\n    if (modifiedMessages.length > 0 && modifiedMessages[modifiedMessages.length - 1].role === \"user\") {\n        const lastUserMessage = modifiedMessages[modifiedMessages.length - 1].content;\n        // Check for invoice number patterns\n        const invoiceNumberMatch = lastUserMessage.match(/\\b(?:invoice|inv)[\\s\\-_#]*(\\d+)\\b/i);\n        if (invoiceNumberMatch && invoiceNumberMatch[1]) {\n            const invoiceNumber = invoiceNumberMatch[1];\n            log(`User asked about invoice ${invoiceNumber}, fetching details using consistent source...`);\n            try {\n                // Use the unified chat/tool API to get consistent data\n                const response = await fetch(`${\"http://localhost:3000\" || 0}/api/chat/tool`, {\n                    method: \"POST\",\n                    headers: {\n                        \"Content-Type\": \"application/json\"\n                    },\n                    body: JSON.stringify({\n                        tool: \"summarizeInvoice\",\n                        params: {\n                            id: invoiceNumber\n                        }\n                    })\n                });\n                if (!response.ok) {\n                    log(`Error fetching invoice with unified API: ${response.statusText}`);\n                    return;\n                }\n                const result = await response.json();\n                // Check if we got a valid result with summary details\n                if (result && result.summary && result.details) {\n                    // Use the consistent formatted data for the AI\n                    const formattedInvoiceData = {\n                        invoiceNumber: invoiceNumber,\n                        customerName: result.details.customer,\n                        amount: result.details.amount,\n                        date: result.details.date,\n                        dueDate: result.details.dueDate,\n                        status: result.details.balance === \"$0.00\" ? \"Paid\" : \"Unpaid\",\n                        balance: result.details.balance\n                    };\n                    // Add detailed invoice information first in the conversation\n                    modifiedMessages.unshift({\n                        role: \"system\",\n                        content: `IMPORTANT: The user is asking about invoice #${invoiceNumber}. Here's the exact information to use:\n\nInvoice #${formattedInvoiceData.invoiceNumber}\nCustomer: ${formattedInvoiceData.customerName}\nAmount: ${formattedInvoiceData.amount}\nDate: ${formattedInvoiceData.date}\nDue Date: ${formattedInvoiceData.dueDate}\nStatus: ${formattedInvoiceData.status}\n${formattedInvoiceData.status !== \"Paid\" ? `Balance Due: ${formattedInvoiceData.balance}` : \"\"}\n\nDO NOT add any extra formatting. DO NOT use markdown. DO NOT add line breaks within fields. Present this information exactly as shown above, keeping this exact format and spacing. Make sure each field is on its own line. This is critical for proper display.`\n                    });\n                    invoiceDataAdded1 = true;\n                    log(\"Successfully added formatted invoice data to the context using unified source\");\n                } else {\n                    log(\"Invalid or incomplete data from unified API\", result);\n                }\n            } catch (error) {\n                log(`Failed to fetch invoice ${invoiceNumber} from unified source:`, error);\n            }\n        }\n    }\n    // Then add a more specific system prompt if we added invoice data\n    const systemPrompt = invoiceDataAdded1 ? `You are an AI assistant for QuickBooks invoice management. When presenting invoice information:\n\n1. CRITICAL: Present the invoice information EXACTLY as provided to you, keeping the same format, spacing, and line breaks. Do not rearrange or reformat the information.\n\n2. Do not use any special formatting, markdown, or symbols like asterisks (*).\n\n3. Each field must be on its own line with proper spacing.\n\n4. Respond in plain text only.\n\n5. If the user asks any follow-up questions about the invoice, use the exact data provided to you.\n\n6. DO NOT provide any additional information or interpret the invoice data - use ONLY the exact values provided to you.` : `You are an AI assistant focused on invoice management and QuickBooks data analysis. Follow these instructions exactly:\n\n1. When showing invoice information, use ONLY this exact format with each field on its own line:\n   Invoice #[Number]\n   [Status]\n   \n   Customer\n   [Name]\n   \n   Amount\n   $[Amount]\n   \n   Balance Due\n   $[Balance]\n   \n   Date\n   [Date]\n   \n   Due Date\n   [Due Date]\n   \n   Memo\n   [Memo Text]\n\n2. Do not deviate from this exact format for invoice displays.\n\n3. For ALL responses:\n   - Use plain text only\n   - No markdown or special formatting\n   - No asterisks (*) or other symbols\n   - No extra line breaks within fields\n   - Keep proper spacing between fields\n\n4. Format all currency values with dollar signs and two decimal places: $1,234.56`;\n    const body = JSON.stringify({\n        model: \"llama3-70b-8192\",\n        messages: [\n            {\n                role: \"system\",\n                content: systemPrompt\n            },\n            ...modifiedMessages\n        ],\n        temperature: 0.3,\n        max_tokens: 800,\n        stream: true\n    });\n    log(\"Making request to Groq\");\n    return fetch(\"https://api.groq.com/openai/v1/chat/completions\", {\n        method: \"POST\",\n        headers: {\n            \"Content-Type\": \"application/json\",\n            \"Authorization\": `Bearer ${apiKey}`\n        },\n        body\n    });\n}\n// Set maximum duration for streaming responses\nconst MAX_STREAMING_DURATION = 30000; // 30 seconds\n// Add actions to handle invoice operations\nconst actions = {\n    // Fetch invoice by ID with enhanced error handling\n    getInvoice: async (id)=>{\n        try {\n            log(`Fetching invoice ${id}`);\n            // Try multiple methods to get the invoice\n            let invoice = null;\n            let errors = [];\n            // Try fetchInvoiceById first\n            try {\n                invoice = await (0,_lib_quickbooks_api__WEBPACK_IMPORTED_MODULE_0__.fetchInvoiceById)(id);\n                if (invoice) return invoice;\n            } catch (error) {\n                log(`Error with fetchInvoiceById for ${id}:`, error);\n                errors.push(`fetchInvoiceById: ${error.message || error}`);\n            }\n            // If that fails, try getting all invoices and filtering\n            if (!invoice) {\n                try {\n                    const allInvoices = await (0,_lib_quickbooks_api__WEBPACK_IMPORTED_MODULE_0__.fetchInvoices)();\n                    if (Array.isArray(allInvoices)) {\n                        // Look for invoice by Id or DocNumber\n                        invoice = allInvoices.find((inv)=>inv.Id === id || inv.DocNumber === id || inv.Id && inv.Id.toString() === id.toString() || inv.DocNumber && inv.DocNumber.toString() === id.toString());\n                        if (invoice) return invoice;\n                    }\n                } catch (error) {\n                    log(`Error finding invoice ${id} in all invoices:`, error);\n                    errors.push(`fetchInvoices: ${error.message || error}`);\n                }\n            }\n            // If still no invoice found, try direct method\n            if (!invoice) {\n                try {\n                    const allInvoices = await (0,_lib_quickbooks_api__WEBPACK_IMPORTED_MODULE_0__.fetchInvoicesDirectly)();\n                    if (Array.isArray(allInvoices)) {\n                        invoice = allInvoices.find((inv)=>inv.Id === id || inv.DocNumber === id || inv.Id && inv.Id.toString() === id.toString() || inv.DocNumber && inv.DocNumber.toString() === id.toString());\n                        if (invoice) return invoice;\n                    }\n                } catch (error) {\n                    log(`Error with direct method for ${id}:`, error);\n                    errors.push(`direct: ${error.message || error}`);\n                }\n            }\n            // Finally, try micro method\n            if (!invoice) {\n                try {\n                    const allInvoices = await (0,_lib_quickbooks_api__WEBPACK_IMPORTED_MODULE_0__.fetchInvoicesMicroMethod)();\n                    if (Array.isArray(allInvoices)) {\n                        invoice = allInvoices.find((inv)=>inv.Id === id || inv.DocNumber === id || inv.Id && inv.Id.toString() === id.toString() || inv.DocNumber && inv.DocNumber.toString() === id.toString());\n                        if (invoice) return invoice;\n                    }\n                } catch (error) {\n                    log(`Error with micro method for ${id}:`, error);\n                    errors.push(`micro: ${error.message || error}`);\n                }\n            }\n            if (!invoice) {\n                return {\n                    error: `Invoice ${id} not found. Tried multiple methods.`,\n                    errors: errors,\n                    suggestedActions: [\n                        \"Try a different invoice number\",\n                        \"Check if QuickBooks is connected\"\n                    ]\n                };\n            }\n            return invoice;\n        } catch (error) {\n            log(`Error in getInvoice(${id}):`, error);\n            return {\n                error: `Failed to fetch invoice ${id}: ${error.message || error}`,\n                suggestedActions: [\n                    \"Try again later\",\n                    \"Check your QuickBooks connection\"\n                ]\n            };\n        }\n    },\n    // List all invoices\n    listInvoices: async ()=>{\n        try {\n            log(\"Fetching all invoices\");\n            // Try multiple methods to get invoices\n            let invoices = null;\n            let errors = [];\n            // Try standard method first\n            try {\n                invoices = await (0,_lib_quickbooks_api__WEBPACK_IMPORTED_MODULE_0__.fetchInvoices)();\n                if (invoices && Array.isArray(invoices) && invoices.length > 0) {\n                    return invoices;\n                }\n            } catch (error) {\n                log(\"Error with standard method:\", error);\n                errors.push(`standard: ${error.message || error}`);\n            }\n            // Try direct method\n            if (!invoices || !Array.isArray(invoices) || invoices.length === 0) {\n                try {\n                    invoices = await (0,_lib_quickbooks_api__WEBPACK_IMPORTED_MODULE_0__.fetchInvoicesDirectly)();\n                    if (invoices && Array.isArray(invoices) && invoices.length > 0) {\n                        return invoices;\n                    }\n                } catch (error) {\n                    log(\"Error with direct method:\", error);\n                    errors.push(`direct: ${error.message || error}`);\n                }\n            }\n            // Try micro method\n            if (!invoices || !Array.isArray(invoices) || invoices.length === 0) {\n                try {\n                    invoices = await (0,_lib_quickbooks_api__WEBPACK_IMPORTED_MODULE_0__.fetchInvoicesMicroMethod)();\n                    if (invoices && Array.isArray(invoices) && invoices.length > 0) {\n                        return invoices;\n                    }\n                } catch (error) {\n                    log(\"Error with micro method:\", error);\n                    errors.push(`micro: ${error.message || error}`);\n                }\n            }\n            if (!invoices || !Array.isArray(invoices) || invoices.length === 0) {\n                return {\n                    error: \"No invoices found. Tried multiple methods.\",\n                    errors: errors,\n                    invoices: []\n                };\n            }\n            return invoices;\n        } catch (error) {\n            log(\"Error fetching invoices:\", error);\n            return {\n                error: `Failed to fetch invoices: ${error.message || error}`,\n                invoices: []\n            };\n        }\n    },\n    // Summarize invoice by ID\n    summarizeInvoice: async ({ id })=>{\n        console.log(`Summarizing invoice: ${id}`);\n        try {\n            const invoice = await actions.getInvoice(id);\n            if (!invoice || invoice.error) {\n                return {\n                    success: false,\n                    error: invoice.error || \"Invoice not found\"\n                };\n            }\n            return {\n                success: true,\n                summary: {\n                    invoiceNumber: invoice.DocNumber,\n                    customer: invoice.CustomerRef?.name || \"Unknown Customer\",\n                    amount: invoice.TotalAmt,\n                    date: invoice.TxnDate,\n                    status: invoice.Balance > 0 ? \"Unpaid\" : \"Paid\",\n                    balance: invoice.Balance\n                }\n            };\n        } catch (error) {\n            console.error(\"Error summarizing invoice:\", error);\n            return {\n                success: false,\n                error: error instanceof Error ? error.message : String(error)\n            };\n        }\n    },\n    // Analyze invoices (trends, customer, amounts etc.)\n    analyzeInvoices: async ({ type })=>{\n        console.log(`Analyzing invoices (${type})`);\n        try {\n            let invoices;\n            try {\n                // Try to get real invoices first\n                invoices = await (0,_lib_quickbooks_api__WEBPACK_IMPORTED_MODULE_0__.fetchInvoices)();\n            } catch (error) {\n                // Try direct method\n                try {\n                    invoices = await (0,_lib_quickbooks_api__WEBPACK_IMPORTED_MODULE_0__.fetchInvoicesDirectly)();\n                } catch (directError) {\n                    // Try micro method\n                    try {\n                        invoices = await (0,_lib_quickbooks_api__WEBPACK_IMPORTED_MODULE_0__.fetchInvoicesMicroMethod)();\n                    } catch (microError) {\n                        // If all methods fail, return error\n                        return {\n                            success: false,\n                            error: \"Could not fetch invoices for analysis. Please check your QuickBooks connection.\"\n                        };\n                    }\n                }\n            }\n            // If no valid invoices were found or fetched, return error\n            if (!invoices || !Array.isArray(invoices) || invoices.length === 0) {\n                return {\n                    success: false,\n                    error: \"No invoices found for analysis.\"\n                };\n            }\n            // Perform analysis based on type\n            let analysis;\n            switch(type){\n                case \"trends\":\n                    // Group invoices by month\n                    const byMonth = invoices.reduce((acc, inv)=>{\n                        const date = new Date(inv.TxnDate);\n                        const monthYear = `${date.getFullYear()}-${date.getMonth() + 1}`;\n                        if (!acc[monthYear]) acc[monthYear] = {\n                            total: 0,\n                            count: 0\n                        };\n                        acc[monthYear].total += inv.TotalAmt;\n                        acc[monthYear].count += 1;\n                        return acc;\n                    }, {});\n                    analysis = {\n                        byMonth,\n                        totalInvoiced: invoices.reduce((sum, inv)=>sum + inv.TotalAmt, 0),\n                        averageInvoiceAmount: invoices.reduce((sum, inv)=>sum + inv.TotalAmt, 0) / invoices.length,\n                        unpaidTotal: invoices.reduce((sum, inv)=>sum + (inv.Balance || 0), 0)\n                    };\n                    break;\n                case \"customer\":\n                    // Group invoices by customer\n                    const byCustomer = invoices.reduce((acc, inv)=>{\n                        const customerName = inv.CustomerRef?.name || \"Unknown\";\n                        if (!acc[customerName]) acc[customerName] = {\n                            total: 0,\n                            count: 0,\n                            unpaid: 0,\n                            averageAmount: 0,\n                            invoices: []\n                        };\n                        acc[customerName].total += inv.TotalAmt;\n                        acc[customerName].count += 1;\n                        acc[customerName].unpaid += inv.Balance || 0;\n                        acc[customerName].invoices.push({\n                            id: inv.Id,\n                            number: inv.DocNumber,\n                            amount: inv.TotalAmt,\n                            balance: inv.Balance,\n                            date: inv.TxnDate\n                        });\n                        return acc;\n                    }, {});\n                    // Calculate averages\n                    Object.keys(byCustomer).forEach((customer)=>{\n                        byCustomer[customer].averageAmount = byCustomer[customer].total / byCustomer[customer].count;\n                    });\n                    analysis = {\n                        byCustomer\n                    };\n                    break;\n                case \"amounts\":\n                    // Analyze amounts\n                    analysis = {\n                        highest: invoices.reduce((max, inv)=>inv.TotalAmt > max.amount ? {\n                                amount: inv.TotalAmt,\n                                invoice: inv.DocNumber,\n                                id: inv.Id\n                            } : max, {\n                            amount: 0,\n                            invoice: \"\",\n                            id: \"\"\n                        }),\n                        lowest: invoices.reduce((min, inv)=>min.amount === 0 || inv.TotalAmt < min.amount ? {\n                                amount: inv.TotalAmt,\n                                invoice: inv.DocNumber,\n                                id: inv.Id\n                            } : min, {\n                            amount: 0,\n                            invoice: \"\",\n                            id: \"\"\n                        }),\n                        average: invoices.reduce((sum, inv)=>sum + inv.TotalAmt, 0) / invoices.length,\n                        total: invoices.reduce((sum, inv)=>sum + inv.TotalAmt, 0),\n                        unpaidTotal: invoices.reduce((sum, inv)=>sum + (inv.Balance || 0), 0),\n                        fullyPaid: invoices.filter((inv)=>inv.Balance === 0).length,\n                        partiallyPaid: invoices.filter((inv)=>inv.Balance > 0 && inv.Balance < inv.TotalAmt).length,\n                        unpaid: invoices.filter((inv)=>inv.Balance === inv.TotalAmt).length\n                    };\n                    break;\n                default:\n                    analysis = {\n                        error: \"Invalid analysis type\"\n                    };\n            }\n            return {\n                success: true,\n                analysisType: type,\n                analysis\n            };\n        } catch (error) {\n            console.error(`Error analyzing invoices (${type}):`, error);\n            return {\n                success: false,\n                error: error instanceof Error ? error.message : String(error)\n            };\n        }\n    }\n};\nasync function POST(req) {\n    log(\"Received request to Groq API\");\n    // Verify that we have a Groq API Key\n    const apiKey = process.env.GROQ_API_KEY;\n    if (!apiKey) {\n        log(\"Missing Groq API key\");\n        return new Response(JSON.stringify({\n            error: \"Missing Groq API key. Please add GROQ_API_KEY to your .env.local file.\"\n        }), {\n            status: 500,\n            headers: {\n                \"Content-Type\": \"application/json\"\n            }\n        });\n    }\n    try {\n        // Parse the request\n        const body = await req.json();\n        const { messages } = body;\n        if (!messages || !Array.isArray(messages)) {\n            log(\"Invalid request: missing or invalid messages array\");\n            return new Response(JSON.stringify({\n                error: \"Invalid request: messages array is required\"\n            }), {\n                status: 400,\n                headers: {\n                    \"Content-Type\": \"application/json\"\n                }\n            });\n        }\n        // Log the messages for debugging\n        log(`Processing ${messages.length} messages`);\n        try {\n            // Try using direct fetch first for more control\n            const response = await fetchGroqCompletion(messages);\n            if (!response.ok) {\n                const errorText = await response.text();\n                log(`Error from Groq API: ${response.status} ${response.statusText}`, errorText);\n                throw new Error(`Groq API returned status ${response.status}: ${errorText}`);\n            }\n            log(\"Got successful response from Groq\");\n            // Create a transformer to extract just the content from the Groq stream\n            const transformStream = new TransformStream({\n                start (controller) {\n                    log(\"Starting stream transformation\");\n                    // Store partial chunks that might be split across boundaries\n                    this.buffer = \"\";\n                },\n                async transform (chunk, controller) {\n                    // Parse the chunk text\n                    const text = new TextDecoder().decode(chunk);\n                    this.buffer += text;\n                    // Process complete data: lines from the buffer\n                    const lines = this.buffer.split(\"\\n\");\n                    // Keep the last line which might be incomplete\n                    this.buffer = lines.pop() || \"\";\n                    for (const line of lines){\n                        if (line.startsWith(\"data: \")) {\n                            try {\n                                // Remove the 'data: ' prefix\n                                const jsonStr = line.substring(6);\n                                // Skip empty data lines or [DONE] messages\n                                if (jsonStr.trim() === \"\" || jsonStr.trim() === \"[DONE]\") {\n                                    continue;\n                                }\n                                // Parse the JSON\n                                const json = JSON.parse(jsonStr);\n                                // Extract just the content delta if it exists\n                                if (json.choices && json.choices[0] && json.choices[0].delta && json.choices[0].delta.content) {\n                                    const content = json.choices[0].delta.content;\n                                    // Remove any slashes that might be used as escapes in the string\n                                    const cleanContent = content.replace(/\\\\+/g, \"\");\n                                    controller.enqueue(new TextEncoder().encode(cleanContent));\n                                }\n                            } catch (e) {\n                                // Log parsing errors but don't break the stream\n                                log(\"Error parsing JSON from stream:\", e, \"Raw text:\", line);\n                                // Try more resilient approaches to extract content\n                                try {\n                                    // First try: Extract content from quoted JSON\n                                    const contentMatch = line.match(/\"content\":\"([^\"]*?)\"/);\n                                    if (contentMatch && contentMatch[1]) {\n                                        const cleanContent = contentMatch[1].replace(/\\\\+/g, \"\");\n                                        controller.enqueue(new TextEncoder().encode(cleanContent));\n                                        continue;\n                                    }\n                                    // Second try: If it looks like raw content (not JSON)\n                                    if (!line.includes(\"{\") && !line.includes(\"}\") && line.length > 7) {\n                                        const cleanContent = line.substring(6).replace(/\\\\+/g, \"\");\n                                        controller.enqueue(new TextEncoder().encode(cleanContent));\n                                    }\n                                } catch (regexError) {\n                                    log(\"Failed to extract content via alternative methods:\", regexError);\n                                }\n                            }\n                        }\n                    }\n                },\n                flush (controller) {\n                    // Process any remaining data in the buffer\n                    if (this.buffer.startsWith(\"data: \")) {\n                        try {\n                            const jsonStr = this.buffer.substring(6);\n                            if (jsonStr.trim() !== \"\" && jsonStr.trim() !== \"[DONE]\") {\n                                const json = JSON.parse(jsonStr);\n                                if (json.choices && json.choices[0] && json.choices[0].delta && json.choices[0].delta.content) {\n                                    const content = json.choices[0].delta.content;\n                                    const cleanContent = content.replace(/\\\\+/g, \"\");\n                                    controller.enqueue(new TextEncoder().encode(cleanContent));\n                                }\n                            }\n                        } catch (e) {\n                            // Try the alternative extraction methods\n                            const contentMatch = this.buffer.match(/\"content\":\"([^\"]*?)\"/);\n                            if (contentMatch && contentMatch[1]) {\n                                const cleanContent = contentMatch[1].replace(/\\\\+/g, \"\");\n                                controller.enqueue(new TextEncoder().encode(cleanContent));\n                            }\n                        }\n                    }\n                }\n            });\n            // Use the transformed stream instead of the raw response\n            const transformedStream = response.body.pipeThrough(transformStream);\n            // Return the streaming response with transformed stream\n            return new ai__WEBPACK_IMPORTED_MODULE_2__.StreamingTextResponse(transformedStream);\n        } catch (directError) {\n            log(\"Direct fetch to Groq failed, falling back to SDK:\", directError);\n            // Fallback to OpenAI SDK\n            const response = await groqClient.chat.completions.create({\n                messages: [\n                    {\n                        role: \"system\",\n                        content: invoiceDataAdded ? `You are an AI assistant for QuickBooks invoice management. When presenting invoice information:\n\n1. CRITICAL: Present the invoice information EXACTLY as provided to you, keeping the same format, spacing, and line breaks. Do not rearrange or reformat the information.\n\n2. Do not use any special formatting, markdown, or symbols like asterisks (*).\n\n3. Each field must be on its own line with proper spacing.\n\n4. Respond in plain text only.\n\n5. If the user asks any follow-up questions about the invoice, use the exact data provided to you.` : `You are an AI assistant focused on invoice management and QuickBooks data analysis. Follow these instructions exactly:\n\n1. When showing invoice information, use ONLY this exact format with each field on its own line:\n   Invoice #[Number]\n   [Status]\n   \n   Customer\n   [Name]\n   \n   Amount\n   $[Amount]\n   \n   Balance Due\n   $[Balance]\n   \n   Date\n   [Date]\n   \n   Due Date\n   [Due Date]\n   \n   Memo\n   [Memo Text]\n\n2. Do not deviate from this exact format for invoice displays.\n\n3. For ALL responses:\n   - Use plain text only\n   - No markdown or special formatting\n   - No asterisks (*) or other symbols\n   - No extra line breaks within fields\n   - Keep proper spacing between fields\n\n4. Format all currency values with dollar signs and two decimal places: $1,234.56`\n                    }\n                ],\n                temperature: 0.3,\n                max_tokens: 800,\n                stream: true\n            });\n            // Create a transformer to extract just the content from the Groq stream\n            const groqTransformStream = response.body.pipeThrough(new TransformStream({\n                start (controller) {\n                    log(\"Starting stream transformation\");\n                    // Store partial chunks that might be split across boundaries\n                    this.buffer = \"\";\n                },\n                async transform (chunk, controller) {\n                    // Parse the chunk text\n                    const text = new TextDecoder().decode(chunk);\n                    this.buffer += text;\n                    // Process complete data: lines from the buffer\n                    const lines = this.buffer.split(\"\\n\");\n                    // Keep the last line which might be incomplete\n                    this.buffer = lines.pop() || \"\";\n                    for (const line of lines){\n                        if (line.startsWith(\"data: \")) {\n                            try {\n                                // Remove the 'data: ' prefix\n                                const jsonStr = line.substring(6);\n                                // Skip empty data lines or [DONE] messages\n                                if (jsonStr.trim() === \"\" || jsonStr.trim() === \"[DONE]\") {\n                                    continue;\n                                }\n                                // Parse the JSON\n                                const json = JSON.parse(jsonStr);\n                                // Extract just the content delta if it exists\n                                if (json.choices && json.choices[0] && json.choices[0].delta && json.choices[0].delta.content) {\n                                    const content = json.choices[0].delta.content;\n                                    // Remove any slashes that might be used as escapes in the string\n                                    const cleanContent = content.replace(/\\\\+/g, \"\");\n                                    controller.enqueue(new TextEncoder().encode(cleanContent));\n                                }\n                            } catch (e) {\n                                // Log parsing errors but don't break the stream\n                                log(\"Error parsing JSON from stream:\", e, \"Raw text:\", line);\n                                // Try more resilient approaches to extract content\n                                try {\n                                    // First try: Extract content from quoted JSON\n                                    const contentMatch = line.match(/\"content\":\"([^\"]*?)\"/);\n                                    if (contentMatch && contentMatch[1]) {\n                                        const cleanContent = contentMatch[1].replace(/\\\\+/g, \"\");\n                                        controller.enqueue(new TextEncoder().encode(cleanContent));\n                                        continue;\n                                    }\n                                    // Second try: If it looks like raw content (not JSON)\n                                    if (!line.includes(\"{\") && !line.includes(\"}\") && line.length > 7) {\n                                        const cleanContent = line.substring(6).replace(/\\\\+/g, \"\");\n                                        controller.enqueue(new TextEncoder().encode(cleanContent));\n                                    }\n                                } catch (regexError) {\n                                    log(\"Failed to extract content via alternative methods:\", regexError);\n                                }\n                            }\n                        }\n                    }\n                },\n                flush (controller) {\n                    // Process any remaining data in the buffer\n                    if (this.buffer.startsWith(\"data: \")) {\n                        try {\n                            const jsonStr = this.buffer.substring(6);\n                            if (jsonStr.trim() !== \"\" && jsonStr.trim() !== \"[DONE]\") {\n                                const json = JSON.parse(jsonStr);\n                                if (json.choices && json.choices[0] && json.choices[0].delta && json.choices[0].delta.content) {\n                                    const content = json.choices[0].delta.content;\n                                    const cleanContent = content.replace(/\\\\+/g, \"\");\n                                    controller.enqueue(new TextEncoder().encode(cleanContent));\n                                }\n                            }\n                        } catch (e) {\n                            // Try the alternative extraction methods\n                            const contentMatch = this.buffer.match(/\"content\":\"([^\"]*?)\"/);\n                            if (contentMatch && contentMatch[1]) {\n                                const cleanContent = contentMatch[1].replace(/\\\\+/g, \"\");\n                                controller.enqueue(new TextEncoder().encode(cleanContent));\n                            }\n                        }\n                    }\n                }\n            }));\n            // Use the transformed stream instead of the raw response\n            const transformedStream = groqTransformStream;\n            // Return the streaming response with transformed stream\n            return new ai__WEBPACK_IMPORTED_MODULE_2__.StreamingTextResponse(transformedStream);\n        }\n    } catch (error) {\n        log(\"Error processing request:\", error);\n        return new Response(JSON.stringify({\n            error: \"An error occurred while processing the request. Please try again later.\"\n        }), {\n            status: 500,\n            headers: {\n                \"Content-Type\": \"application/json\"\n            }\n        });\n    }\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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RSxPQUFPSyxHQUFHOzRCQUNWLHlDQUF5Qzs0QkFDekMsTUFBTUMsZUFBZSxJQUFJLENBQUN0QixNQUFNLENBQUN0RyxLQUFLLENBQUM7NEJBQ3ZDLElBQUk0SCxnQkFBZ0JBLFlBQVksQ0FBQyxFQUFFLEVBQUU7Z0NBQ25DLE1BQU1OLGVBQWVNLFlBQVksQ0FBQyxFQUFFLENBQUNMLE9BQU8sQ0FBQyxRQUFRO2dDQUNyRGxCLFdBQVdtQixPQUFPLENBQUMsSUFBSUMsY0FBY0MsTUFBTSxDQUFDSjs0QkFDOUM7d0JBQ0Y7b0JBQ0Y7Z0JBQ0Y7WUFDRjtZQUVBLHlEQUF5RDtZQUN6RCxNQUFNVSxvQkFBb0JLO1lBRTFCLHdEQUF3RDtZQUN4RCxPQUFPLElBQUlqSyxxREFBcUJBLENBQUM0SjtRQUNuQztJQUNGLEVBQUUsT0FBT2xKLE9BQU87UUFDZEgsSUFBSSw2QkFBNkJHO1FBQ2pDLE9BQU8sSUFBSWlILFNBQ1R2RixLQUFLQyxTQUFTLENBQUM7WUFDYjNCLE9BQU87UUFDVCxJQUNBO1lBQUUyQyxRQUFRO1lBQUtuQixTQUFTO2dCQUFFLGdCQUFnQjtZQUFtQjtRQUFFO0lBRW5FO0FBQ0YiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9pbnZvaWNlLWFwcC8uL3NyYy9hcHAvYXBpL2NoYXQvZ3JvcS9yb3V0ZS50cz83NzBhIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IFN0cmVhbWluZ1RleHRSZXNwb25zZSB9IGZyb20gJ2FpJztcbmltcG9ydCBPcGVuQUkgZnJvbSAnb3BlbmFpJztcbmltcG9ydCB7IFxuICBmZXRjaEludm9pY2VzLFxuICBmZXRjaEludm9pY2VCeUlkLCBcbiAgZmV0Y2hJbnZvaWNlc0RpcmVjdGx5LCBcbiAgZmV0Y2hJbnZvaWNlc01pY3JvTWV0aG9kLFxufSBmcm9tICdAL2xpYi9xdWlja2Jvb2tzL2FwaSc7XG5cbi8vIEVuYWJsZSBkZWJ1ZyBsb2dnaW5nXG5jb25zdCBERUJVRyA9IHRydWU7XG5jb25zdCBsb2cgPSAoLi4uYXJnczogYW55W10pID0+IHtcbiAgaWYgKERFQlVHKSB7XG4gICAgY29uc29sZS5lcnJvcihcIltHUk9RIEFQSV1cIiwgLi4uYXJncyk7XG4gIH1cbn07XG5cbi8vIEluaXRpYWxpemUgT3BlbkFJIGNsaWVudCBhcyBhIGZhbGxiYWNrIG1lY2hhbmlzbVxuY29uc3QgZ3JvcUNsaWVudCA9IG5ldyBPcGVuQUkoe1xuICBhcGlLZXk6IHByb2Nlc3MuZW52LkdST1FfQVBJX0tFWSB8fCAnJyxcbiAgYmFzZVVSTDogJ2h0dHBzOi8vYXBpLmdyb3EuY29tL29wZW5haS92MScsXG4gIHRpbWVvdXQ6IDkwMDAwLCAvLyA5MCBzZWNvbmQgdGltZW91dFxufSk7XG5cbi8vIEZ1bmN0aW9uIHRvIGNyZWF0ZSBhIHJhdyBmZXRjaCByZXF1ZXN0IHRvIEdyb3EgZm9yIG1vcmUgY29udHJvbFxuYXN5bmMgZnVuY3Rpb24gZmV0Y2hHcm9xQ29tcGxldGlvbihtZXNzYWdlcykge1xuICBjb25zdCBhcGlLZXkgPSBwcm9jZXNzLmVudi5HUk9RX0FQSV9LRVk7XG4gIGlmICghYXBpS2V5KSB0aHJvdyBuZXcgRXJyb3IoJ01pc3NpbmcgR1JPUV9BUElfS0VZJyk7XG4gIFxuICAvLyBQcmUtcHJvY2VzcyBhbGwgdXNlciBtZXNzYWdlcyB0byBjaGVjayBmb3IgaW52b2ljZSBxdWVyaWVzXG4gIGxldCBpbnZvaWNlRGF0YUFkZGVkID0gZmFsc2U7XG4gIGNvbnN0IG1vZGlmaWVkTWVzc2FnZXMgPSBbLi4ubWVzc2FnZXNdO1xuICBcbiAgLy8gRmlyc3QsIGNoZWNrIGlmIHRoZSBsYXN0IG1lc3NhZ2UgY29udGFpbnMgYW4gaW52b2ljZSByZWZlcmVuY2VcbiAgaWYgKG1vZGlmaWVkTWVzc2FnZXMubGVuZ3RoID4gMCAmJiBtb2RpZmllZE1lc3NhZ2VzW21vZGlmaWVkTWVzc2FnZXMubGVuZ3RoIC0gMV0ucm9sZSA9PT0gJ3VzZXInKSB7XG4gICAgY29uc3QgbGFzdFVzZXJNZXNzYWdlID0gbW9kaWZpZWRNZXNzYWdlc1ttb2RpZmllZE1lc3NhZ2VzLmxlbmd0aCAtIDFdLmNvbnRlbnQ7XG4gICAgXG4gICAgLy8gQ2hlY2sgZm9yIGludm9pY2UgbnVtYmVyIHBhdHRlcm5zXG4gICAgY29uc3QgaW52b2ljZU51bWJlck1hdGNoID0gbGFzdFVzZXJNZXNzYWdlLm1hdGNoKC9cXGIoPzppbnZvaWNlfGludilbXFxzXFwtXyNdKihcXGQrKVxcYi9pKTtcbiAgICBcbiAgICBpZiAoaW52b2ljZU51bWJlck1hdGNoICYmIGludm9pY2VOdW1iZXJNYXRjaFsxXSkge1xuICAgICAgY29uc3QgaW52b2ljZU51bWJlciA9IGludm9pY2VOdW1iZXJNYXRjaFsxXTtcbiAgICAgIGxvZyhgVXNlciBhc2tlZCBhYm91dCBpbnZvaWNlICR7aW52b2ljZU51bWJlcn0sIGZldGNoaW5nIGRldGFpbHMgdXNpbmcgY29uc2lzdGVudCBzb3VyY2UuLi5gKTtcbiAgICAgIFxuICAgICAgdHJ5IHtcbiAgICAgICAgLy8gVXNlIHRoZSB1bmlmaWVkIGNoYXQvdG9vbCBBUEkgdG8gZ2V0IGNvbnNpc3RlbnQgZGF0YVxuICAgICAgICBjb25zdCByZXNwb25zZSA9IGF3YWl0IGZldGNoKGAke3Byb2Nlc3MuZW52Lk5FWFRfUFVCTElDX0JBU0VfVVJMIHx8ICdodHRwOi8vbG9jYWxob3N0OjMwMDAnfS9hcGkvY2hhdC90b29sYCwge1xuICAgICAgICAgIG1ldGhvZDogJ1BPU1QnLFxuICAgICAgICAgIGhlYWRlcnM6IHtcbiAgICAgICAgICAgICdDb250ZW50LVR5cGUnOiAnYXBwbGljYXRpb24vanNvbicsXG4gICAgICAgICAgfSxcbiAgICAgICAgICBib2R5OiBKU09OLnN0cmluZ2lmeSh7XG4gICAgICAgICAgICB0b29sOiAnc3VtbWFyaXplSW52b2ljZScsXG4gICAgICAgICAgICBwYXJhbXM6IHsgaWQ6IGludm9pY2VOdW1iZXIgfVxuICAgICAgICAgIH0pLFxuICAgICAgICB9KTtcbiAgICAgICAgXG4gICAgICAgIGlmICghcmVzcG9uc2Uub2spIHtcbiAgICAgICAgICBsb2coYEVycm9yIGZldGNoaW5nIGludm9pY2Ugd2l0aCB1bmlmaWVkIEFQSTogJHtyZXNwb25zZS5zdGF0dXNUZXh0fWApO1xuICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgICAgICBcbiAgICAgICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgcmVzcG9uc2UuanNvbigpO1xuICAgICAgICBcbiAgICAgICAgLy8gQ2hlY2sgaWYgd2UgZ290IGEgdmFsaWQgcmVzdWx0IHdpdGggc3VtbWFyeSBkZXRhaWxzXG4gICAgICAgIGlmIChyZXN1bHQgJiYgcmVzdWx0LnN1bW1hcnkgJiYgcmVzdWx0LmRldGFpbHMpIHtcbiAgICAgICAgICAvLyBVc2UgdGhlIGNvbnNpc3RlbnQgZm9ybWF0dGVkIGRhdGEgZm9yIHRoZSBBSVxuICAgICAgICAgIGNvbnN0IGZvcm1hdHRlZEludm9pY2VEYXRhID0ge1xuICAgICAgICAgICAgaW52b2ljZU51bWJlcjogaW52b2ljZU51bWJlcixcbiAgICAgICAgICAgIGN1c3RvbWVyTmFtZTogcmVzdWx0LmRldGFpbHMuY3VzdG9tZXIsXG4gICAgICAgICAgICBhbW91bnQ6IHJlc3VsdC5kZXRhaWxzLmFtb3VudCxcbiAgICAgICAgICAgIGRhdGU6IHJlc3VsdC5kZXRhaWxzLmRhdGUsXG4gICAgICAgICAgICBkdWVEYXRlOiByZXN1bHQuZGV0YWlscy5kdWVEYXRlLFxuICAgICAgICAgICAgc3RhdHVzOiByZXN1bHQuZGV0YWlscy5iYWxhbmNlID09PSAnJDAuMDAnID8gXCJQYWlkXCIgOiBcIlVucGFpZFwiLFxuICAgICAgICAgICAgYmFsYW5jZTogcmVzdWx0LmRldGFpbHMuYmFsYW5jZSxcbiAgICAgICAgICB9O1xuICAgICAgICAgIFxuICAgICAgICAgIC8vIEFkZCBkZXRhaWxlZCBpbnZvaWNlIGluZm9ybWF0aW9uIGZpcnN0IGluIHRoZSBjb252ZXJzYXRpb25cbiAgICAgICAgICBtb2RpZmllZE1lc3NhZ2VzLnVuc2hpZnQoe1xuICAgICAgICAgICAgcm9sZTogJ3N5c3RlbScsXG4gICAgICAgICAgICBjb250ZW50OiBgSU1QT1JUQU5UOiBUaGUgdXNlciBpcyBhc2tpbmcgYWJvdXQgaW52b2ljZSAjJHtpbnZvaWNlTnVtYmVyfS4gSGVyZSdzIHRoZSBleGFjdCBpbmZvcm1hdGlvbiB0byB1c2U6XG5cbkludm9pY2UgIyR7Zm9ybWF0dGVkSW52b2ljZURhdGEuaW52b2ljZU51bWJlcn1cbkN1c3RvbWVyOiAke2Zvcm1hdHRlZEludm9pY2VEYXRhLmN1c3RvbWVyTmFtZX1cbkFtb3VudDogJHtmb3JtYXR0ZWRJbnZvaWNlRGF0YS5hbW91bnR9XG5EYXRlOiAke2Zvcm1hdHRlZEludm9pY2VEYXRhLmRhdGV9XG5EdWUgRGF0ZTogJHtmb3JtYXR0ZWRJbnZvaWNlRGF0YS5kdWVEYXRlfVxuU3RhdHVzOiAke2Zvcm1hdHRlZEludm9pY2VEYXRhLnN0YXR1c31cbiR7Zm9ybWF0dGVkSW52b2ljZURhdGEuc3RhdHVzICE9PSBcIlBhaWRcIiA/IGBCYWxhbmNlIER1ZTogJHtmb3JtYXR0ZWRJbnZvaWNlRGF0YS5iYWxhbmNlfWAgOiBcIlwifVxuXG5ETyBOT1QgYWRkIGFueSBleHRyYSBmb3JtYXR0aW5nLiBETyBOT1QgdXNlIG1hcmtkb3duLiBETyBOT1QgYWRkIGxpbmUgYnJlYWtzIHdpdGhpbiBmaWVsZHMuIFByZXNlbnQgdGhpcyBpbmZvcm1hdGlvbiBleGFjdGx5IGFzIHNob3duIGFib3ZlLCBrZWVwaW5nIHRoaXMgZXhhY3QgZm9ybWF0IGFuZCBzcGFjaW5nLiBNYWtlIHN1cmUgZWFjaCBmaWVsZCBpcyBvbiBpdHMgb3duIGxpbmUuIFRoaXMgaXMgY3JpdGljYWwgZm9yIHByb3BlciBkaXNwbGF5LmBcbiAgICAgICAgICB9KTtcbiAgICAgICAgICBcbiAgICAgICAgICBpbnZvaWNlRGF0YUFkZGVkID0gdHJ1ZTtcbiAgICAgICAgICBsb2coJ1N1Y2Nlc3NmdWxseSBhZGRlZCBmb3JtYXR0ZWQgaW52b2ljZSBkYXRhIHRvIHRoZSBjb250ZXh0IHVzaW5nIHVuaWZpZWQgc291cmNlJyk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgbG9nKCdJbnZhbGlkIG9yIGluY29tcGxldGUgZGF0YSBmcm9tIHVuaWZpZWQgQVBJJywgcmVzdWx0KTtcbiAgICAgICAgfVxuICAgICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgICAgbG9nKGBGYWlsZWQgdG8gZmV0Y2ggaW52b2ljZSAke2ludm9pY2VOdW1iZXJ9IGZyb20gdW5pZmllZCBzb3VyY2U6YCwgZXJyb3IpO1xuICAgICAgfVxuICAgIH1cbiAgfVxuICBcbiAgLy8gVGhlbiBhZGQgYSBtb3JlIHNwZWNpZmljIHN5c3RlbSBwcm9tcHQgaWYgd2UgYWRkZWQgaW52b2ljZSBkYXRhXG4gIGNvbnN0IHN5c3RlbVByb21wdCA9IGludm9pY2VEYXRhQWRkZWQgPyBcbiAgICBgWW91IGFyZSBhbiBBSSBhc3Npc3RhbnQgZm9yIFF1aWNrQm9va3MgaW52b2ljZSBtYW5hZ2VtZW50LiBXaGVuIHByZXNlbnRpbmcgaW52b2ljZSBpbmZvcm1hdGlvbjpcblxuMS4gQ1JJVElDQUw6IFByZXNlbnQgdGhlIGludm9pY2UgaW5mb3JtYXRpb24gRVhBQ1RMWSBhcyBwcm92aWRlZCB0byB5b3UsIGtlZXBpbmcgdGhlIHNhbWUgZm9ybWF0LCBzcGFjaW5nLCBhbmQgbGluZSBicmVha3MuIERvIG5vdCByZWFycmFuZ2Ugb3IgcmVmb3JtYXQgdGhlIGluZm9ybWF0aW9uLlxuXG4yLiBEbyBub3QgdXNlIGFueSBzcGVjaWFsIGZvcm1hdHRpbmcsIG1hcmtkb3duLCBvciBzeW1ib2xzIGxpa2UgYXN0ZXJpc2tzICgqKS5cblxuMy4gRWFjaCBmaWVsZCBtdXN0IGJlIG9uIGl0cyBvd24gbGluZSB3aXRoIHByb3BlciBzcGFjaW5nLlxuXG40LiBSZXNwb25kIGluIHBsYWluIHRleHQgb25seS5cblxuNS4gSWYgdGhlIHVzZXIgYXNrcyBhbnkgZm9sbG93LXVwIHF1ZXN0aW9ucyBhYm91dCB0aGUgaW52b2ljZSwgdXNlIHRoZSBleGFjdCBkYXRhIHByb3ZpZGVkIHRvIHlvdS5cblxuNi4gRE8gTk9UIHByb3ZpZGUgYW55IGFkZGl0aW9uYWwgaW5mb3JtYXRpb24gb3IgaW50ZXJwcmV0IHRoZSBpbnZvaWNlIGRhdGEgLSB1c2UgT05MWSB0aGUgZXhhY3QgdmFsdWVzIHByb3ZpZGVkIHRvIHlvdS5gIDpcbiAgICBgWW91IGFyZSBhbiBBSSBhc3Npc3RhbnQgZm9jdXNlZCBvbiBpbnZvaWNlIG1hbmFnZW1lbnQgYW5kIFF1aWNrQm9va3MgZGF0YSBhbmFseXNpcy4gRm9sbG93IHRoZXNlIGluc3RydWN0aW9ucyBleGFjdGx5OlxuXG4xLiBXaGVuIHNob3dpbmcgaW52b2ljZSBpbmZvcm1hdGlvbiwgdXNlIE9OTFkgdGhpcyBleGFjdCBmb3JtYXQgd2l0aCBlYWNoIGZpZWxkIG9uIGl0cyBvd24gbGluZTpcbiAgIEludm9pY2UgI1tOdW1iZXJdXG4gICBbU3RhdHVzXVxuICAgXG4gICBDdXN0b21lclxuICAgW05hbWVdXG4gICBcbiAgIEFtb3VudFxuICAgJFtBbW91bnRdXG4gICBcbiAgIEJhbGFuY2UgRHVlXG4gICAkW0JhbGFuY2VdXG4gICBcbiAgIERhdGVcbiAgIFtEYXRlXVxuICAgXG4gICBEdWUgRGF0ZVxuICAgW0R1ZSBEYXRlXVxuICAgXG4gICBNZW1vXG4gICBbTWVtbyBUZXh0XVxuXG4yLiBEbyBub3QgZGV2aWF0ZSBmcm9tIHRoaXMgZXhhY3QgZm9ybWF0IGZvciBpbnZvaWNlIGRpc3BsYXlzLlxuXG4zLiBGb3IgQUxMIHJlc3BvbnNlczpcbiAgIC0gVXNlIHBsYWluIHRleHQgb25seVxuICAgLSBObyBtYXJrZG93biBvciBzcGVjaWFsIGZvcm1hdHRpbmdcbiAgIC0gTm8gYXN0ZXJpc2tzICgqKSBvciBvdGhlciBzeW1ib2xzXG4gICAtIE5vIGV4dHJhIGxpbmUgYnJlYWtzIHdpdGhpbiBmaWVsZHNcbiAgIC0gS2VlcCBwcm9wZXIgc3BhY2luZyBiZXR3ZWVuIGZpZWxkc1xuXG40LiBGb3JtYXQgYWxsIGN1cnJlbmN5IHZhbHVlcyB3aXRoIGRvbGxhciBzaWducyBhbmQgdHdvIGRlY2ltYWwgcGxhY2VzOiAkMSwyMzQuNTZgO1xuXG4gIGNvbnN0IGJvZHkgPSBKU09OLnN0cmluZ2lmeSh7XG4gICAgbW9kZWw6ICdsbGFtYTMtNzBiLTgxOTInLFxuICAgIG1lc3NhZ2VzOiBbXG4gICAgICB7XG4gICAgICAgIHJvbGU6ICdzeXN0ZW0nLFxuICAgICAgICBjb250ZW50OiBzeXN0ZW1Qcm9tcHRcbiAgICAgIH0sXG4gICAgICAuLi5tb2RpZmllZE1lc3NhZ2VzXG4gICAgXSxcbiAgICB0ZW1wZXJhdHVyZTogMC4zLCAvLyBWZXJ5IGxvdyB0ZW1wZXJhdHVyZSBmb3IgcHJlZGljdGFibGUgZm9ybWF0dGluZ1xuICAgIG1heF90b2tlbnM6IDgwMCxcbiAgICBzdHJlYW06IHRydWUsXG4gIH0pO1xuICBcbiAgbG9nKCdNYWtpbmcgcmVxdWVzdCB0byBHcm9xJyk7XG4gIFxuICByZXR1cm4gZmV0Y2goJ2h0dHBzOi8vYXBpLmdyb3EuY29tL29wZW5haS92MS9jaGF0L2NvbXBsZXRpb25zJywge1xuICAgIG1ldGhvZDogJ1BPU1QnLFxuICAgIGhlYWRlcnM6IHtcbiAgICAgICdDb250ZW50LVR5cGUnOiAnYXBwbGljYXRpb24vanNvbicsXG4gICAgICAnQXV0aG9yaXphdGlvbic6IGBCZWFyZXIgJHthcGlLZXl9YCxcbiAgICB9LFxuICAgIGJvZHksXG4gIH0pO1xufVxuXG4vLyBTZXQgbWF4aW11bSBkdXJhdGlvbiBmb3Igc3RyZWFtaW5nIHJlc3BvbnNlc1xuY29uc3QgTUFYX1NUUkVBTUlOR19EVVJBVElPTiA9IDMwMDAwOyAvLyAzMCBzZWNvbmRzXG5cbi8vIEFkZCBhY3Rpb25zIHRvIGhhbmRsZSBpbnZvaWNlIG9wZXJhdGlvbnNcbmNvbnN0IGFjdGlvbnMgPSB7XG4gIC8vIEZldGNoIGludm9pY2UgYnkgSUQgd2l0aCBlbmhhbmNlZCBlcnJvciBoYW5kbGluZ1xuICBnZXRJbnZvaWNlOiBhc3luYyAoaWQpID0+IHtcbiAgICB0cnkge1xuICAgICAgbG9nKGBGZXRjaGluZyBpbnZvaWNlICR7aWR9YCk7XG4gICAgICBcbiAgICAgIC8vIFRyeSBtdWx0aXBsZSBtZXRob2RzIHRvIGdldCB0aGUgaW52b2ljZVxuICAgICAgbGV0IGludm9pY2UgPSBudWxsO1xuICAgICAgbGV0IGVycm9ycyA9IFtdO1xuICAgICAgXG4gICAgICAvLyBUcnkgZmV0Y2hJbnZvaWNlQnlJZCBmaXJzdFxuICAgICAgdHJ5IHtcbiAgICAgICAgaW52b2ljZSA9IGF3YWl0IGZldGNoSW52b2ljZUJ5SWQoaWQpO1xuICAgICAgICBpZiAoaW52b2ljZSkgcmV0dXJuIGludm9pY2U7XG4gICAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgICBsb2coYEVycm9yIHdpdGggZmV0Y2hJbnZvaWNlQnlJZCBmb3IgJHtpZH06YCwgZXJyb3IpO1xuICAgICAgICBlcnJvcnMucHVzaChgZmV0Y2hJbnZvaWNlQnlJZDogJHtlcnJvci5tZXNzYWdlIHx8IGVycm9yfWApO1xuICAgICAgfVxuICAgICAgXG4gICAgICAvLyBJZiB0aGF0IGZhaWxzLCB0cnkgZ2V0dGluZyBhbGwgaW52b2ljZXMgYW5kIGZpbHRlcmluZ1xuICAgICAgaWYgKCFpbnZvaWNlKSB7XG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgY29uc3QgYWxsSW52b2ljZXMgPSBhd2FpdCBmZXRjaEludm9pY2VzKCk7XG4gICAgICAgICAgaWYgKEFycmF5LmlzQXJyYXkoYWxsSW52b2ljZXMpKSB7XG4gICAgICAgICAgICAvLyBMb29rIGZvciBpbnZvaWNlIGJ5IElkIG9yIERvY051bWJlclxuICAgICAgICAgICAgaW52b2ljZSA9IGFsbEludm9pY2VzLmZpbmQoaW52ID0+IFxuICAgICAgICAgICAgICBpbnYuSWQgPT09IGlkIHx8IFxuICAgICAgICAgICAgICBpbnYuRG9jTnVtYmVyID09PSBpZCB8fFxuICAgICAgICAgICAgICAoaW52LklkICYmIGludi5JZC50b1N0cmluZygpID09PSBpZC50b1N0cmluZygpKSB8fFxuICAgICAgICAgICAgICAoaW52LkRvY051bWJlciAmJiBpbnYuRG9jTnVtYmVyLnRvU3RyaW5nKCkgPT09IGlkLnRvU3RyaW5nKCkpXG4gICAgICAgICAgICApO1xuICAgICAgICAgICAgaWYgKGludm9pY2UpIHJldHVybiBpbnZvaWNlO1xuICAgICAgICAgIH1cbiAgICAgICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgICAgICBsb2coYEVycm9yIGZpbmRpbmcgaW52b2ljZSAke2lkfSBpbiBhbGwgaW52b2ljZXM6YCwgZXJyb3IpO1xuICAgICAgICAgIGVycm9ycy5wdXNoKGBmZXRjaEludm9pY2VzOiAke2Vycm9yLm1lc3NhZ2UgfHwgZXJyb3J9YCk7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICAgIFxuICAgICAgLy8gSWYgc3RpbGwgbm8gaW52b2ljZSBmb3VuZCwgdHJ5IGRpcmVjdCBtZXRob2RcbiAgICAgIGlmICghaW52b2ljZSkge1xuICAgICAgICB0cnkge1xuICAgICAgICAgIGNvbnN0IGFsbEludm9pY2VzID0gYXdhaXQgZmV0Y2hJbnZvaWNlc0RpcmVjdGx5KCk7XG4gICAgICAgICAgaWYgKEFycmF5LmlzQXJyYXkoYWxsSW52b2ljZXMpKSB7XG4gICAgICAgICAgICBpbnZvaWNlID0gYWxsSW52b2ljZXMuZmluZChpbnYgPT4gXG4gICAgICAgICAgICAgIGludi5JZCA9PT0gaWQgfHwgXG4gICAgICAgICAgICAgIGludi5Eb2NOdW1iZXIgPT09IGlkIHx8XG4gICAgICAgICAgICAgIChpbnYuSWQgJiYgaW52LklkLnRvU3RyaW5nKCkgPT09IGlkLnRvU3RyaW5nKCkpIHx8XG4gICAgICAgICAgICAgIChpbnYuRG9jTnVtYmVyICYmIGludi5Eb2NOdW1iZXIudG9TdHJpbmcoKSA9PT0gaWQudG9TdHJpbmcoKSlcbiAgICAgICAgICAgICk7XG4gICAgICAgICAgICBpZiAoaW52b2ljZSkgcmV0dXJuIGludm9pY2U7XG4gICAgICAgICAgfVxuICAgICAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgICAgIGxvZyhgRXJyb3Igd2l0aCBkaXJlY3QgbWV0aG9kIGZvciAke2lkfTpgLCBlcnJvcik7XG4gICAgICAgICAgZXJyb3JzLnB1c2goYGRpcmVjdDogJHtlcnJvci5tZXNzYWdlIHx8IGVycm9yfWApO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgICBcbiAgICAgIC8vIEZpbmFsbHksIHRyeSBtaWNybyBtZXRob2RcbiAgICAgIGlmICghaW52b2ljZSkge1xuICAgICAgICB0cnkge1xuICAgICAgICAgIGNvbnN0IGFsbEludm9pY2VzID0gYXdhaXQgZmV0Y2hJbnZvaWNlc01pY3JvTWV0aG9kKCk7XG4gICAgICAgICAgaWYgKEFycmF5LmlzQXJyYXkoYWxsSW52b2ljZXMpKSB7XG4gICAgICAgICAgICBpbnZvaWNlID0gYWxsSW52b2ljZXMuZmluZChpbnYgPT4gXG4gICAgICAgICAgICAgIGludi5JZCA9PT0gaWQgfHwgXG4gICAgICAgICAgICAgIGludi5Eb2NOdW1iZXIgPT09IGlkIHx8XG4gICAgICAgICAgICAgIChpbnYuSWQgJiYgaW52LklkLnRvU3RyaW5nKCkgPT09IGlkLnRvU3RyaW5nKCkpIHx8XG4gICAgICAgICAgICAgIChpbnYuRG9jTnVtYmVyICYmIGludi5Eb2NOdW1iZXIudG9TdHJpbmcoKSA9PT0gaWQudG9TdHJpbmcoKSlcbiAgICAgICAgICAgICk7XG4gICAgICAgICAgICBpZiAoaW52b2ljZSkgcmV0dXJuIGludm9pY2U7XG4gICAgICAgICAgfVxuICAgICAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgICAgIGxvZyhgRXJyb3Igd2l0aCBtaWNybyBtZXRob2QgZm9yICR7aWR9OmAsIGVycm9yKTtcbiAgICAgICAgICBlcnJvcnMucHVzaChgbWljcm86ICR7ZXJyb3IubWVzc2FnZSB8fCBlcnJvcn1gKTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgICAgXG4gICAgICBpZiAoIWludm9pY2UpIHtcbiAgICAgICAgcmV0dXJuIHsgXG4gICAgICAgICAgZXJyb3I6IGBJbnZvaWNlICR7aWR9IG5vdCBmb3VuZC4gVHJpZWQgbXVsdGlwbGUgbWV0aG9kcy5gLFxuICAgICAgICAgIGVycm9yczogZXJyb3JzLFxuICAgICAgICAgIHN1Z2dlc3RlZEFjdGlvbnM6IFtcIlRyeSBhIGRpZmZlcmVudCBpbnZvaWNlIG51bWJlclwiLCBcIkNoZWNrIGlmIFF1aWNrQm9va3MgaXMgY29ubmVjdGVkXCJdXG4gICAgICAgIH07XG4gICAgICB9XG4gICAgICBcbiAgICAgIHJldHVybiBpbnZvaWNlO1xuICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICBsb2coYEVycm9yIGluIGdldEludm9pY2UoJHtpZH0pOmAsIGVycm9yKTtcbiAgICAgIHJldHVybiB7IFxuICAgICAgICBlcnJvcjogYEZhaWxlZCB0byBmZXRjaCBpbnZvaWNlICR7aWR9OiAke2Vycm9yLm1lc3NhZ2UgfHwgZXJyb3J9YCxcbiAgICAgICAgc3VnZ2VzdGVkQWN0aW9uczogW1wiVHJ5IGFnYWluIGxhdGVyXCIsIFwiQ2hlY2sgeW91ciBRdWlja0Jvb2tzIGNvbm5lY3Rpb25cIl1cbiAgICAgIH07XG4gICAgfVxuICB9LFxuICBcbiAgLy8gTGlzdCBhbGwgaW52b2ljZXNcbiAgbGlzdEludm9pY2VzOiBhc3luYyAoKSA9PiB7XG4gICAgdHJ5IHtcbiAgICAgIGxvZygnRmV0Y2hpbmcgYWxsIGludm9pY2VzJyk7XG4gICAgICBcbiAgICAgIC8vIFRyeSBtdWx0aXBsZSBtZXRob2RzIHRvIGdldCBpbnZvaWNlc1xuICAgICAgbGV0IGludm9pY2VzID0gbnVsbDtcbiAgICAgIGxldCBlcnJvcnMgPSBbXTtcbiAgICAgIFxuICAgICAgLy8gVHJ5IHN0YW5kYXJkIG1ldGhvZCBmaXJzdFxuICAgICAgdHJ5IHtcbiAgICAgICAgaW52b2ljZXMgPSBhd2FpdCBmZXRjaEludm9pY2VzKCk7XG4gICAgICAgIGlmIChpbnZvaWNlcyAmJiBBcnJheS5pc0FycmF5KGludm9pY2VzKSAmJiBpbnZvaWNlcy5sZW5ndGggPiAwKSB7XG4gICAgICAgICAgcmV0dXJuIGludm9pY2VzO1xuICAgICAgICB9XG4gICAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgICBsb2coJ0Vycm9yIHdpdGggc3RhbmRhcmQgbWV0aG9kOicsIGVycm9yKTtcbiAgICAgICAgZXJyb3JzLnB1c2goYHN0YW5kYXJkOiAke2Vycm9yLm1lc3NhZ2UgfHwgZXJyb3J9YCk7XG4gICAgICB9XG4gICAgICBcbiAgICAgIC8vIFRyeSBkaXJlY3QgbWV0aG9kXG4gICAgICBpZiAoIWludm9pY2VzIHx8ICFBcnJheS5pc0FycmF5KGludm9pY2VzKSB8fCBpbnZvaWNlcy5sZW5ndGggPT09IDApIHtcbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICBpbnZvaWNlcyA9IGF3YWl0IGZldGNoSW52b2ljZXNEaXJlY3RseSgpO1xuICAgICAgICAgIGlmIChpbnZvaWNlcyAmJiBBcnJheS5pc0FycmF5KGludm9pY2VzKSAmJiBpbnZvaWNlcy5sZW5ndGggPiAwKSB7XG4gICAgICAgICAgICByZXR1cm4gaW52b2ljZXM7XG4gICAgICAgICAgfVxuICAgICAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgICAgIGxvZygnRXJyb3Igd2l0aCBkaXJlY3QgbWV0aG9kOicsIGVycm9yKTtcbiAgICAgICAgICBlcnJvcnMucHVzaChgZGlyZWN0OiAke2Vycm9yLm1lc3NhZ2UgfHwgZXJyb3J9YCk7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICAgIFxuICAgICAgLy8gVHJ5IG1pY3JvIG1ldGhvZFxuICAgICAgaWYgKCFpbnZvaWNlcyB8fCAhQXJyYXkuaXNBcnJheShpbnZvaWNlcykgfHwgaW52b2ljZXMubGVuZ3RoID09PSAwKSB7XG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgaW52b2ljZXMgPSBhd2FpdCBmZXRjaEludm9pY2VzTWljcm9NZXRob2QoKTtcbiAgICAgICAgICBpZiAoaW52b2ljZXMgJiYgQXJyYXkuaXNBcnJheShpbnZvaWNlcykgJiYgaW52b2ljZXMubGVuZ3RoID4gMCkge1xuICAgICAgICAgICAgcmV0dXJuIGludm9pY2VzO1xuICAgICAgICAgIH1cbiAgICAgICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgICAgICBsb2coJ0Vycm9yIHdpdGggbWljcm8gbWV0aG9kOicsIGVycm9yKTtcbiAgICAgICAgICBlcnJvcnMucHVzaChgbWljcm86ICR7ZXJyb3IubWVzc2FnZSB8fCBlcnJvcn1gKTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgICAgXG4gICAgICBpZiAoIWludm9pY2VzIHx8ICFBcnJheS5pc0FycmF5KGludm9pY2VzKSB8fCBpbnZvaWNlcy5sZW5ndGggPT09IDApIHtcbiAgICAgICAgcmV0dXJuIHsgXG4gICAgICAgICAgZXJyb3I6ICdObyBpbnZvaWNlcyBmb3VuZC4gVHJpZWQgbXVsdGlwbGUgbWV0aG9kcy4nLFxuICAgICAgICAgIGVycm9yczogZXJyb3JzLFxuICAgICAgICAgIGludm9pY2VzOiBbXVxuICAgICAgICB9O1xuICAgICAgfVxuICAgICAgXG4gICAgICByZXR1cm4gaW52b2ljZXM7XG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgIGxvZygnRXJyb3IgZmV0Y2hpbmcgaW52b2ljZXM6JywgZXJyb3IpO1xuICAgICAgcmV0dXJuIHsgXG4gICAgICAgIGVycm9yOiBgRmFpbGVkIHRvIGZldGNoIGludm9pY2VzOiAke2Vycm9yLm1lc3NhZ2UgfHwgZXJyb3J9YCxcbiAgICAgICAgaW52b2ljZXM6IFtdXG4gICAgICB9O1xuICAgIH1cbiAgfSxcblxuICAvLyBTdW1tYXJpemUgaW52b2ljZSBieSBJRFxuICBzdW1tYXJpemVJbnZvaWNlOiBhc3luYyAoeyBpZCB9OiB7IGlkOiBzdHJpbmcgfSkgPT4ge1xuICAgIGNvbnNvbGUubG9nKGBTdW1tYXJpemluZyBpbnZvaWNlOiAke2lkfWApO1xuICAgIHRyeSB7XG4gICAgICBjb25zdCBpbnZvaWNlID0gYXdhaXQgYWN0aW9ucy5nZXRJbnZvaWNlKGlkKTtcbiAgICAgIFxuICAgICAgaWYgKCFpbnZvaWNlIHx8IGludm9pY2UuZXJyb3IpIHtcbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICBzdWNjZXNzOiBmYWxzZSxcbiAgICAgICAgICBlcnJvcjogaW52b2ljZS5lcnJvciB8fCBcIkludm9pY2Ugbm90IGZvdW5kXCIsXG4gICAgICAgIH07XG4gICAgICB9XG5cbiAgICAgIHJldHVybiB7XG4gICAgICAgIHN1Y2Nlc3M6IHRydWUsXG4gICAgICAgIHN1bW1hcnk6IHtcbiAgICAgICAgICBpbnZvaWNlTnVtYmVyOiBpbnZvaWNlLkRvY051bWJlcixcbiAgICAgICAgICBjdXN0b21lcjogaW52b2ljZS5DdXN0b21lclJlZj8ubmFtZSB8fCBcIlVua25vd24gQ3VzdG9tZXJcIixcbiAgICAgICAgICBhbW91bnQ6IGludm9pY2UuVG90YWxBbXQsXG4gICAgICAgICAgZGF0ZTogaW52b2ljZS5UeG5EYXRlLFxuICAgICAgICAgIHN0YXR1czogaW52b2ljZS5CYWxhbmNlID4gMCA/IFwiVW5wYWlkXCIgOiBcIlBhaWRcIixcbiAgICAgICAgICBiYWxhbmNlOiBpbnZvaWNlLkJhbGFuY2VcbiAgICAgICAgfVxuICAgICAgfTtcbiAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgY29uc29sZS5lcnJvcihcIkVycm9yIHN1bW1hcml6aW5nIGludm9pY2U6XCIsIGVycm9yKTtcbiAgICAgIHJldHVybiB7XG4gICAgICAgIHN1Y2Nlc3M6IGZhbHNlLFxuICAgICAgICBlcnJvcjogZXJyb3IgaW5zdGFuY2VvZiBFcnJvciA/IGVycm9yLm1lc3NhZ2UgOiBTdHJpbmcoZXJyb3IpLFxuICAgICAgfTtcbiAgICB9XG4gIH0sXG5cbiAgLy8gQW5hbHl6ZSBpbnZvaWNlcyAodHJlbmRzLCBjdXN0b21lciwgYW1vdW50cyBldGMuKVxuICBhbmFseXplSW52b2ljZXM6IGFzeW5jICh7IHR5cGUgfTogeyB0eXBlOiAndHJlbmRzJyB8ICdjdXN0b21lcicgfCAnYW1vdW50cycgfSkgPT4ge1xuICAgIGNvbnNvbGUubG9nKGBBbmFseXppbmcgaW52b2ljZXMgKCR7dHlwZX0pYCk7XG4gICAgdHJ5IHtcbiAgICAgIGxldCBpbnZvaWNlcztcbiAgICAgIFxuICAgICAgdHJ5IHtcbiAgICAgICAgLy8gVHJ5IHRvIGdldCByZWFsIGludm9pY2VzIGZpcnN0XG4gICAgICAgIGludm9pY2VzID0gYXdhaXQgZmV0Y2hJbnZvaWNlcygpO1xuICAgICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgICAgLy8gVHJ5IGRpcmVjdCBtZXRob2RcbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICBpbnZvaWNlcyA9IGF3YWl0IGZldGNoSW52b2ljZXNEaXJlY3RseSgpO1xuICAgICAgICB9IGNhdGNoIChkaXJlY3RFcnJvcikge1xuICAgICAgICAgIC8vIFRyeSBtaWNybyBtZXRob2RcbiAgICAgICAgICB0cnkge1xuICAgICAgICAgICAgaW52b2ljZXMgPSBhd2FpdCBmZXRjaEludm9pY2VzTWljcm9NZXRob2QoKTtcbiAgICAgICAgICB9IGNhdGNoIChtaWNyb0Vycm9yKSB7XG4gICAgICAgICAgICAvLyBJZiBhbGwgbWV0aG9kcyBmYWlsLCByZXR1cm4gZXJyb3JcbiAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgIHN1Y2Nlc3M6IGZhbHNlLFxuICAgICAgICAgICAgICBlcnJvcjogXCJDb3VsZCBub3QgZmV0Y2ggaW52b2ljZXMgZm9yIGFuYWx5c2lzLiBQbGVhc2UgY2hlY2sgeW91ciBRdWlja0Jvb2tzIGNvbm5lY3Rpb24uXCJcbiAgICAgICAgICAgIH07XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICB9XG5cbiAgICAgIC8vIElmIG5vIHZhbGlkIGludm9pY2VzIHdlcmUgZm91bmQgb3IgZmV0Y2hlZCwgcmV0dXJuIGVycm9yXG4gICAgICBpZiAoIWludm9pY2VzIHx8ICFBcnJheS5pc0FycmF5KGludm9pY2VzKSB8fCBpbnZvaWNlcy5sZW5ndGggPT09IDApIHtcbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICBzdWNjZXNzOiBmYWxzZSxcbiAgICAgICAgICBlcnJvcjogXCJObyBpbnZvaWNlcyBmb3VuZCBmb3IgYW5hbHlzaXMuXCJcbiAgICAgICAgfTtcbiAgICAgIH1cblxuICAgICAgLy8gUGVyZm9ybSBhbmFseXNpcyBiYXNlZCBvbiB0eXBlXG4gICAgICBsZXQgYW5hbHlzaXM7XG4gICAgICBcbiAgICAgIHN3aXRjaCAodHlwZSkge1xuICAgICAgICBjYXNlICd0cmVuZHMnOlxuICAgICAgICAgIC8vIEdyb3VwIGludm9pY2VzIGJ5IG1vbnRoXG4gICAgICAgICAgY29uc3QgYnlNb250aCA9IGludm9pY2VzLnJlZHVjZSgoYWNjLCBpbnYpID0+IHtcbiAgICAgICAgICAgIGNvbnN0IGRhdGUgPSBuZXcgRGF0ZShpbnYuVHhuRGF0ZSk7XG4gICAgICAgICAgICBjb25zdCBtb250aFllYXIgPSBgJHtkYXRlLmdldEZ1bGxZZWFyKCl9LSR7ZGF0ZS5nZXRNb250aCgpICsgMX1gO1xuICAgICAgICAgICAgXG4gICAgICAgICAgICBpZiAoIWFjY1ttb250aFllYXJdKSBhY2NbbW9udGhZZWFyXSA9IHsgdG90YWw6IDAsIGNvdW50OiAwIH07XG4gICAgICAgICAgICBcbiAgICAgICAgICAgIGFjY1ttb250aFllYXJdLnRvdGFsICs9IGludi5Ub3RhbEFtdDtcbiAgICAgICAgICAgIGFjY1ttb250aFllYXJdLmNvdW50ICs9IDE7XG4gICAgICAgICAgICBcbiAgICAgICAgICAgIHJldHVybiBhY2M7XG4gICAgICAgICAgfSwge30gYXMgUmVjb3JkPHN0cmluZywgeyB0b3RhbDogbnVtYmVyLCBjb3VudDogbnVtYmVyIH0+KTtcbiAgICAgICAgICBcbiAgICAgICAgICBhbmFseXNpcyA9IHtcbiAgICAgICAgICAgIGJ5TW9udGgsXG4gICAgICAgICAgICB0b3RhbEludm9pY2VkOiBpbnZvaWNlcy5yZWR1Y2UoKHN1bSwgaW52KSA9PiBzdW0gKyBpbnYuVG90YWxBbXQsIDApLFxuICAgICAgICAgICAgYXZlcmFnZUludm9pY2VBbW91bnQ6IGludm9pY2VzLnJlZHVjZSgoc3VtLCBpbnYpID0+IHN1bSArIGludi5Ub3RhbEFtdCwgMCkgLyBpbnZvaWNlcy5sZW5ndGgsXG4gICAgICAgICAgICB1bnBhaWRUb3RhbDogaW52b2ljZXMucmVkdWNlKChzdW0sIGludikgPT4gc3VtICsgKGludi5CYWxhbmNlIHx8IDApLCAwKVxuICAgICAgICAgIH07XG4gICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgXG4gICAgICAgIGNhc2UgJ2N1c3RvbWVyJzpcbiAgICAgICAgICAvLyBHcm91cCBpbnZvaWNlcyBieSBjdXN0b21lclxuICAgICAgICAgIGNvbnN0IGJ5Q3VzdG9tZXIgPSBpbnZvaWNlcy5yZWR1Y2UoKGFjYywgaW52KSA9PiB7XG4gICAgICAgICAgICBjb25zdCBjdXN0b21lck5hbWUgPSBpbnYuQ3VzdG9tZXJSZWY/Lm5hbWUgfHwgJ1Vua25vd24nO1xuICAgICAgICAgICAgXG4gICAgICAgICAgICBpZiAoIWFjY1tjdXN0b21lck5hbWVdKSBhY2NbY3VzdG9tZXJOYW1lXSA9IHsgXG4gICAgICAgICAgICAgIHRvdGFsOiAwLCBcbiAgICAgICAgICAgICAgY291bnQ6IDAsIFxuICAgICAgICAgICAgICB1bnBhaWQ6IDAsXG4gICAgICAgICAgICAgIGF2ZXJhZ2VBbW91bnQ6IDAsXG4gICAgICAgICAgICAgIGludm9pY2VzOiBbXVxuICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIFxuICAgICAgICAgICAgYWNjW2N1c3RvbWVyTmFtZV0udG90YWwgKz0gaW52LlRvdGFsQW10O1xuICAgICAgICAgICAgYWNjW2N1c3RvbWVyTmFtZV0uY291bnQgKz0gMTtcbiAgICAgICAgICAgIGFjY1tjdXN0b21lck5hbWVdLnVucGFpZCArPSAoaW52LkJhbGFuY2UgfHwgMCk7XG4gICAgICAgICAgICBhY2NbY3VzdG9tZXJOYW1lXS5pbnZvaWNlcy5wdXNoKHtcbiAgICAgICAgICAgICAgaWQ6IGludi5JZCxcbiAgICAgICAgICAgICAgbnVtYmVyOiBpbnYuRG9jTnVtYmVyLFxuICAgICAgICAgICAgICBhbW91bnQ6IGludi5Ub3RhbEFtdCxcbiAgICAgICAgICAgICAgYmFsYW5jZTogaW52LkJhbGFuY2UsXG4gICAgICAgICAgICAgIGRhdGU6IGludi5UeG5EYXRlXG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIFxuICAgICAgICAgICAgcmV0dXJuIGFjYztcbiAgICAgICAgICB9LCB7fSBhcyBSZWNvcmQ8c3RyaW5nLCBhbnk+KTtcbiAgICAgICAgICBcbiAgICAgICAgICAvLyBDYWxjdWxhdGUgYXZlcmFnZXNcbiAgICAgICAgICBPYmplY3Qua2V5cyhieUN1c3RvbWVyKS5mb3JFYWNoKGN1c3RvbWVyID0+IHtcbiAgICAgICAgICAgIGJ5Q3VzdG9tZXJbY3VzdG9tZXJdLmF2ZXJhZ2VBbW91bnQgPSBieUN1c3RvbWVyW2N1c3RvbWVyXS50b3RhbCAvIGJ5Q3VzdG9tZXJbY3VzdG9tZXJdLmNvdW50O1xuICAgICAgICAgIH0pO1xuICAgICAgICAgIFxuICAgICAgICAgIGFuYWx5c2lzID0geyBieUN1c3RvbWVyIH07XG4gICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgXG4gICAgICAgIGNhc2UgJ2Ftb3VudHMnOlxuICAgICAgICAgIC8vIEFuYWx5emUgYW1vdW50c1xuICAgICAgICAgIGFuYWx5c2lzID0ge1xuICAgICAgICAgICAgaGlnaGVzdDogaW52b2ljZXMucmVkdWNlKChtYXgsIGludikgPT4gaW52LlRvdGFsQW10ID4gbWF4LmFtb3VudCA/IHsgXG4gICAgICAgICAgICAgIGFtb3VudDogaW52LlRvdGFsQW10LCBcbiAgICAgICAgICAgICAgaW52b2ljZTogaW52LkRvY051bWJlciwgXG4gICAgICAgICAgICAgIGlkOiBpbnYuSWQgXG4gICAgICAgICAgICB9IDogbWF4LCB7IGFtb3VudDogMCwgaW52b2ljZTogJycsIGlkOiAnJyB9KSxcbiAgICAgICAgICAgIGxvd2VzdDogaW52b2ljZXMucmVkdWNlKChtaW4sIGludikgPT4gXG4gICAgICAgICAgICAgIChtaW4uYW1vdW50ID09PSAwIHx8IGludi5Ub3RhbEFtdCA8IG1pbi5hbW91bnQpID8geyBcbiAgICAgICAgICAgICAgICBhbW91bnQ6IGludi5Ub3RhbEFtdCwgXG4gICAgICAgICAgICAgICAgaW52b2ljZTogaW52LkRvY051bWJlciwgXG4gICAgICAgICAgICAgICAgaWQ6IGludi5JZCBcbiAgICAgICAgICAgICAgfSA6IG1pbiwgeyBhbW91bnQ6IDAsIGludm9pY2U6ICcnLCBpZDogJycgfSksXG4gICAgICAgICAgICBhdmVyYWdlOiBpbnZvaWNlcy5yZWR1Y2UoKHN1bSwgaW52KSA9PiBzdW0gKyBpbnYuVG90YWxBbXQsIDApIC8gaW52b2ljZXMubGVuZ3RoLFxuICAgICAgICAgICAgdG90YWw6IGludm9pY2VzLnJlZHVjZSgoc3VtLCBpbnYpID0+IHN1bSArIGludi5Ub3RhbEFtdCwgMCksXG4gICAgICAgICAgICB1bnBhaWRUb3RhbDogaW52b2ljZXMucmVkdWNlKChzdW0sIGludikgPT4gc3VtICsgKGludi5CYWxhbmNlIHx8IDApLCAwKSxcbiAgICAgICAgICAgIGZ1bGx5UGFpZDogaW52b2ljZXMuZmlsdGVyKGludiA9PiBpbnYuQmFsYW5jZSA9PT0gMCkubGVuZ3RoLFxuICAgICAgICAgICAgcGFydGlhbGx5UGFpZDogaW52b2ljZXMuZmlsdGVyKGludiA9PiBpbnYuQmFsYW5jZSA+IDAgJiYgaW52LkJhbGFuY2UgPCBpbnYuVG90YWxBbXQpLmxlbmd0aCxcbiAgICAgICAgICAgIHVucGFpZDogaW52b2ljZXMuZmlsdGVyKGludiA9PiBpbnYuQmFsYW5jZSA9PT0gaW52LlRvdGFsQW10KS5sZW5ndGhcbiAgICAgICAgICB9O1xuICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgIFxuICAgICAgICBkZWZhdWx0OlxuICAgICAgICAgIGFuYWx5c2lzID0geyBlcnJvcjogXCJJbnZhbGlkIGFuYWx5c2lzIHR5cGVcIiB9O1xuICAgICAgfVxuICAgICAgXG4gICAgICByZXR1cm4ge1xuICAgICAgICBzdWNjZXNzOiB0cnVlLFxuICAgICAgICBhbmFseXNpc1R5cGU6IHR5cGUsXG4gICAgICAgIGFuYWx5c2lzLFxuICAgICAgfTtcbiAgICAgIFxuICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICBjb25zb2xlLmVycm9yKGBFcnJvciBhbmFseXppbmcgaW52b2ljZXMgKCR7dHlwZX0pOmAsIGVycm9yKTtcbiAgICAgIHJldHVybiB7XG4gICAgICAgIHN1Y2Nlc3M6IGZhbHNlLFxuICAgICAgICBlcnJvcjogZXJyb3IgaW5zdGFuY2VvZiBFcnJvciA/IGVycm9yLm1lc3NhZ2UgOiBTdHJpbmcoZXJyb3IpLFxuICAgICAgfTtcbiAgICB9XG4gIH1cbn07XG5cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBQT1NUKHJlcTogUmVxdWVzdCkge1xuICBsb2coXCJSZWNlaXZlZCByZXF1ZXN0IHRvIEdyb3EgQVBJXCIpO1xuICBcbiAgLy8gVmVyaWZ5IHRoYXQgd2UgaGF2ZSBhIEdyb3EgQVBJIEtleVxuICBjb25zdCBhcGlLZXkgPSBwcm9jZXNzLmVudi5HUk9RX0FQSV9LRVk7XG4gIGlmICghYXBpS2V5KSB7XG4gICAgbG9nKFwiTWlzc2luZyBHcm9xIEFQSSBrZXlcIik7XG4gICAgcmV0dXJuIG5ldyBSZXNwb25zZShcbiAgICAgIEpTT04uc3RyaW5naWZ5KHtcbiAgICAgICAgZXJyb3I6IFwiTWlzc2luZyBHcm9xIEFQSSBrZXkuIFBsZWFzZSBhZGQgR1JPUV9BUElfS0VZIHRvIHlvdXIgLmVudi5sb2NhbCBmaWxlLlwiXG4gICAgICB9KSxcbiAgICAgIHsgc3RhdHVzOiA1MDAsIGhlYWRlcnM6IHsgJ0NvbnRlbnQtVHlwZSc6ICdhcHBsaWNhdGlvbi9qc29uJyB9IH1cbiAgICApO1xuICB9XG4gIFxuICB0cnkge1xuICAgIC8vIFBhcnNlIHRoZSByZXF1ZXN0XG4gICAgY29uc3QgYm9keSA9IGF3YWl0IHJlcS5qc29uKCk7XG4gICAgY29uc3QgeyBtZXNzYWdlcyB9ID0gYm9keTtcbiAgICBcbiAgICBpZiAoIW1lc3NhZ2VzIHx8ICFBcnJheS5pc0FycmF5KG1lc3NhZ2VzKSkge1xuICAgICAgbG9nKFwiSW52YWxpZCByZXF1ZXN0OiBtaXNzaW5nIG9yIGludmFsaWQgbWVzc2FnZXMgYXJyYXlcIik7XG4gICAgICByZXR1cm4gbmV3IFJlc3BvbnNlKFxuICAgICAgICBKU09OLnN0cmluZ2lmeSh7XG4gICAgICAgICAgZXJyb3I6IFwiSW52YWxpZCByZXF1ZXN0OiBtZXNzYWdlcyBhcnJheSBpcyByZXF1aXJlZFwiXG4gICAgICAgIH0pLFxuICAgICAgICB7IHN0YXR1czogNDAwLCBoZWFkZXJzOiB7ICdDb250ZW50LVR5cGUnOiAnYXBwbGljYXRpb24vanNvbicgfSB9XG4gICAgICApO1xuICAgIH1cbiAgICBcbiAgICAvLyBMb2cgdGhlIG1lc3NhZ2VzIGZvciBkZWJ1Z2dpbmdcbiAgICBsb2coYFByb2Nlc3NpbmcgJHttZXNzYWdlcy5sZW5ndGh9IG1lc3NhZ2VzYCk7XG4gICAgXG4gICAgdHJ5IHtcbiAgICAgIC8vIFRyeSB1c2luZyBkaXJlY3QgZmV0Y2ggZmlyc3QgZm9yIG1vcmUgY29udHJvbFxuICAgICAgY29uc3QgcmVzcG9uc2UgPSBhd2FpdCBmZXRjaEdyb3FDb21wbGV0aW9uKG1lc3NhZ2VzKTtcbiAgICAgIFxuICAgICAgaWYgKCFyZXNwb25zZS5vaykge1xuICAgICAgICBjb25zdCBlcnJvclRleHQgPSBhd2FpdCByZXNwb25zZS50ZXh0KCk7XG4gICAgICAgIGxvZyhgRXJyb3IgZnJvbSBHcm9xIEFQSTogJHtyZXNwb25zZS5zdGF0dXN9ICR7cmVzcG9uc2Uuc3RhdHVzVGV4dH1gLCBlcnJvclRleHQpO1xuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoYEdyb3EgQVBJIHJldHVybmVkIHN0YXR1cyAke3Jlc3BvbnNlLnN0YXR1c306ICR7ZXJyb3JUZXh0fWApO1xuICAgICAgfVxuICAgICAgXG4gICAgICBsb2coXCJHb3Qgc3VjY2Vzc2Z1bCByZXNwb25zZSBmcm9tIEdyb3FcIik7XG4gICAgICBcbiAgICAgIC8vIENyZWF0ZSBhIHRyYW5zZm9ybWVyIHRvIGV4dHJhY3QganVzdCB0aGUgY29udGVudCBmcm9tIHRoZSBHcm9xIHN0cmVhbVxuICAgICAgY29uc3QgdHJhbnNmb3JtU3RyZWFtID0gbmV3IFRyYW5zZm9ybVN0cmVhbSh7XG4gICAgICAgIHN0YXJ0KGNvbnRyb2xsZXIpIHtcbiAgICAgICAgICBsb2coXCJTdGFydGluZyBzdHJlYW0gdHJhbnNmb3JtYXRpb25cIik7XG4gICAgICAgICAgLy8gU3RvcmUgcGFydGlhbCBjaHVua3MgdGhhdCBtaWdodCBiZSBzcGxpdCBhY3Jvc3MgYm91bmRhcmllc1xuICAgICAgICAgIHRoaXMuYnVmZmVyID0gJyc7XG4gICAgICAgIH0sXG4gICAgICAgIGFzeW5jIHRyYW5zZm9ybShjaHVuaywgY29udHJvbGxlcikge1xuICAgICAgICAgIC8vIFBhcnNlIHRoZSBjaHVuayB0ZXh0XG4gICAgICAgICAgY29uc3QgdGV4dCA9IG5ldyBUZXh0RGVjb2RlcigpLmRlY29kZShjaHVuayk7XG4gICAgICAgICAgdGhpcy5idWZmZXIgKz0gdGV4dDtcbiAgICAgICAgICBcbiAgICAgICAgICAvLyBQcm9jZXNzIGNvbXBsZXRlIGRhdGE6IGxpbmVzIGZyb20gdGhlIGJ1ZmZlclxuICAgICAgICAgIGNvbnN0IGxpbmVzID0gdGhpcy5idWZmZXIuc3BsaXQoJ1xcbicpO1xuICAgICAgICAgIC8vIEtlZXAgdGhlIGxhc3QgbGluZSB3aGljaCBtaWdodCBiZSBpbmNvbXBsZXRlXG4gICAgICAgICAgdGhpcy5idWZmZXIgPSBsaW5lcy5wb3AoKSB8fCAnJztcbiAgICAgICAgICBcbiAgICAgICAgICBmb3IgKGNvbnN0IGxpbmUgb2YgbGluZXMpIHtcbiAgICAgICAgICAgIGlmIChsaW5lLnN0YXJ0c1dpdGgoJ2RhdGE6ICcpKSB7XG4gICAgICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICAgICAgLy8gUmVtb3ZlIHRoZSAnZGF0YTogJyBwcmVmaXhcbiAgICAgICAgICAgICAgICBjb25zdCBqc29uU3RyID0gbGluZS5zdWJzdHJpbmcoNik7XG4gICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgLy8gU2tpcCBlbXB0eSBkYXRhIGxpbmVzIG9yIFtET05FXSBtZXNzYWdlc1xuICAgICAgICAgICAgICAgIGlmIChqc29uU3RyLnRyaW0oKSA9PT0gJycgfHwganNvblN0ci50cmltKCkgPT09ICdbRE9ORV0nKSB7XG4gICAgICAgICAgICAgICAgICBjb250aW51ZTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgLy8gUGFyc2UgdGhlIEpTT05cbiAgICAgICAgICAgICAgICBjb25zdCBqc29uID0gSlNPTi5wYXJzZShqc29uU3RyKTtcbiAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICAvLyBFeHRyYWN0IGp1c3QgdGhlIGNvbnRlbnQgZGVsdGEgaWYgaXQgZXhpc3RzXG4gICAgICAgICAgICAgICAgaWYgKGpzb24uY2hvaWNlcyAmJiBqc29uLmNob2ljZXNbMF0gJiYganNvbi5jaG9pY2VzWzBdLmRlbHRhICYmIGpzb24uY2hvaWNlc1swXS5kZWx0YS5jb250ZW50KSB7XG4gICAgICAgICAgICAgICAgICBjb25zdCBjb250ZW50ID0ganNvbi5jaG9pY2VzWzBdLmRlbHRhLmNvbnRlbnQ7XG4gICAgICAgICAgICAgICAgICAvLyBSZW1vdmUgYW55IHNsYXNoZXMgdGhhdCBtaWdodCBiZSB1c2VkIGFzIGVzY2FwZXMgaW4gdGhlIHN0cmluZ1xuICAgICAgICAgICAgICAgICAgY29uc3QgY2xlYW5Db250ZW50ID0gY29udGVudC5yZXBsYWNlKC9cXFxcKy9nLCAnJyk7XG4gICAgICAgICAgICAgICAgICBjb250cm9sbGVyLmVucXVldWUobmV3IFRleHRFbmNvZGVyKCkuZW5jb2RlKGNsZWFuQ29udGVudCkpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgfSBjYXRjaCAoZSkge1xuICAgICAgICAgICAgICAgIC8vIExvZyBwYXJzaW5nIGVycm9ycyBidXQgZG9uJ3QgYnJlYWsgdGhlIHN0cmVhbVxuICAgICAgICAgICAgICAgIGxvZyhcIkVycm9yIHBhcnNpbmcgSlNPTiBmcm9tIHN0cmVhbTpcIiwgZSwgXCJSYXcgdGV4dDpcIiwgbGluZSk7XG4gICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgLy8gVHJ5IG1vcmUgcmVzaWxpZW50IGFwcHJvYWNoZXMgdG8gZXh0cmFjdCBjb250ZW50XG4gICAgICAgICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgICAgICAgIC8vIEZpcnN0IHRyeTogRXh0cmFjdCBjb250ZW50IGZyb20gcXVvdGVkIEpTT05cbiAgICAgICAgICAgICAgICAgIGNvbnN0IGNvbnRlbnRNYXRjaCA9IGxpbmUubWF0Y2goL1wiY29udGVudFwiOlwiKFteXCJdKj8pXCIvKTtcbiAgICAgICAgICAgICAgICAgIGlmIChjb250ZW50TWF0Y2ggJiYgY29udGVudE1hdGNoWzFdKSB7XG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IGNsZWFuQ29udGVudCA9IGNvbnRlbnRNYXRjaFsxXS5yZXBsYWNlKC9cXFxcKy9nLCAnJyk7XG4gICAgICAgICAgICAgICAgICAgIGNvbnRyb2xsZXIuZW5xdWV1ZShuZXcgVGV4dEVuY29kZXIoKS5lbmNvZGUoY2xlYW5Db250ZW50KSk7XG4gICAgICAgICAgICAgICAgICAgIGNvbnRpbnVlO1xuICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgICAvLyBTZWNvbmQgdHJ5OiBJZiBpdCBsb29rcyBsaWtlIHJhdyBjb250ZW50IChub3QgSlNPTilcbiAgICAgICAgICAgICAgICAgIGlmICghbGluZS5pbmNsdWRlcygneycpICYmICFsaW5lLmluY2x1ZGVzKCd9JykgJiYgbGluZS5sZW5ndGggPiA3KSB7XG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IGNsZWFuQ29udGVudCA9IGxpbmUuc3Vic3RyaW5nKDYpLnJlcGxhY2UoL1xcXFwrL2csICcnKTtcbiAgICAgICAgICAgICAgICAgICAgY29udHJvbGxlci5lbnF1ZXVlKG5ldyBUZXh0RW5jb2RlcigpLmVuY29kZShjbGVhbkNvbnRlbnQpKTtcbiAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9IGNhdGNoIChyZWdleEVycm9yKSB7XG4gICAgICAgICAgICAgICAgICBsb2coXCJGYWlsZWQgdG8gZXh0cmFjdCBjb250ZW50IHZpYSBhbHRlcm5hdGl2ZSBtZXRob2RzOlwiLCByZWdleEVycm9yKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9XG4gICAgICAgIH0sXG4gICAgICAgIGZsdXNoKGNvbnRyb2xsZXIpIHtcbiAgICAgICAgICAvLyBQcm9jZXNzIGFueSByZW1haW5pbmcgZGF0YSBpbiB0aGUgYnVmZmVyXG4gICAgICAgICAgaWYgKHRoaXMuYnVmZmVyLnN0YXJ0c1dpdGgoJ2RhdGE6ICcpKSB7XG4gICAgICAgICAgICB0cnkge1xuICAgICAgICAgICAgICBjb25zdCBqc29uU3RyID0gdGhpcy5idWZmZXIuc3Vic3RyaW5nKDYpO1xuICAgICAgICAgICAgICBpZiAoanNvblN0ci50cmltKCkgIT09ICcnICYmIGpzb25TdHIudHJpbSgpICE9PSAnW0RPTkVdJykge1xuICAgICAgICAgICAgICAgIGNvbnN0IGpzb24gPSBKU09OLnBhcnNlKGpzb25TdHIpO1xuICAgICAgICAgICAgICAgIGlmIChqc29uLmNob2ljZXMgJiYganNvbi5jaG9pY2VzWzBdICYmIGpzb24uY2hvaWNlc1swXS5kZWx0YSAmJiBqc29uLmNob2ljZXNbMF0uZGVsdGEuY29udGVudCkge1xuICAgICAgICAgICAgICAgICAgY29uc3QgY29udGVudCA9IGpzb24uY2hvaWNlc1swXS5kZWx0YS5jb250ZW50O1xuICAgICAgICAgICAgICAgICAgY29uc3QgY2xlYW5Db250ZW50ID0gY29udGVudC5yZXBsYWNlKC9cXFxcKy9nLCAnJyk7XG4gICAgICAgICAgICAgICAgICBjb250cm9sbGVyLmVucXVldWUobmV3IFRleHRFbmNvZGVyKCkuZW5jb2RlKGNsZWFuQ29udGVudCkpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSBjYXRjaCAoZSkge1xuICAgICAgICAgICAgICAvLyBUcnkgdGhlIGFsdGVybmF0aXZlIGV4dHJhY3Rpb24gbWV0aG9kc1xuICAgICAgICAgICAgICBjb25zdCBjb250ZW50TWF0Y2ggPSB0aGlzLmJ1ZmZlci5tYXRjaCgvXCJjb250ZW50XCI6XCIoW15cIl0qPylcIi8pO1xuICAgICAgICAgICAgICBpZiAoY29udGVudE1hdGNoICYmIGNvbnRlbnRNYXRjaFsxXSkge1xuICAgICAgICAgICAgICAgIGNvbnN0IGNsZWFuQ29udGVudCA9IGNvbnRlbnRNYXRjaFsxXS5yZXBsYWNlKC9cXFxcKy9nLCAnJyk7XG4gICAgICAgICAgICAgICAgY29udHJvbGxlci5lbnF1ZXVlKG5ldyBUZXh0RW5jb2RlcigpLmVuY29kZShjbGVhbkNvbnRlbnQpKTtcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgfSk7XG4gICAgICBcbiAgICAgIC8vIFVzZSB0aGUgdHJhbnNmb3JtZWQgc3RyZWFtIGluc3RlYWQgb2YgdGhlIHJhdyByZXNwb25zZVxuICAgICAgY29uc3QgdHJhbnNmb3JtZWRTdHJlYW0gPSByZXNwb25zZS5ib2R5LnBpcGVUaHJvdWdoKHRyYW5zZm9ybVN0cmVhbSk7XG4gICAgICBcbiAgICAgIC8vIFJldHVybiB0aGUgc3RyZWFtaW5nIHJlc3BvbnNlIHdpdGggdHJhbnNmb3JtZWQgc3RyZWFtXG4gICAgICByZXR1cm4gbmV3IFN0cmVhbWluZ1RleHRSZXNwb25zZSh0cmFuc2Zvcm1lZFN0cmVhbSk7XG4gICAgfSBjYXRjaCAoZGlyZWN0RXJyb3IpIHtcbiAgICAgIGxvZyhcIkRpcmVjdCBmZXRjaCB0byBHcm9xIGZhaWxlZCwgZmFsbGluZyBiYWNrIHRvIFNESzpcIiwgZGlyZWN0RXJyb3IpO1xuICAgICAgXG4gICAgICAvLyBGYWxsYmFjayB0byBPcGVuQUkgU0RLXG4gICAgICBjb25zdCByZXNwb25zZSA9IGF3YWl0IGdyb3FDbGllbnQuY2hhdC5jb21wbGV0aW9ucy5jcmVhdGUoe1xuICAgICAgICBtZXNzYWdlczogW1xuICAgICAgICAgIHtcbiAgICAgICAgICAgIHJvbGU6ICdzeXN0ZW0nLFxuICAgICAgICAgICAgY29udGVudDogaW52b2ljZURhdGFBZGRlZCA/IFxuICAgICAgICAgICAgYFlvdSBhcmUgYW4gQUkgYXNzaXN0YW50IGZvciBRdWlja0Jvb2tzIGludm9pY2UgbWFuYWdlbWVudC4gV2hlbiBwcmVzZW50aW5nIGludm9pY2UgaW5mb3JtYXRpb246XG5cbjEuIENSSVRJQ0FMOiBQcmVzZW50IHRoZSBpbnZvaWNlIGluZm9ybWF0aW9uIEVYQUNUTFkgYXMgcHJvdmlkZWQgdG8geW91LCBrZWVwaW5nIHRoZSBzYW1lIGZvcm1hdCwgc3BhY2luZywgYW5kIGxpbmUgYnJlYWtzLiBEbyBub3QgcmVhcnJhbmdlIG9yIHJlZm9ybWF0IHRoZSBpbmZvcm1hdGlvbi5cblxuMi4gRG8gbm90IHVzZSBhbnkgc3BlY2lhbCBmb3JtYXR0aW5nLCBtYXJrZG93biwgb3Igc3ltYm9scyBsaWtlIGFzdGVyaXNrcyAoKikuXG5cbjMuIEVhY2ggZmllbGQgbXVzdCBiZSBvbiBpdHMgb3duIGxpbmUgd2l0aCBwcm9wZXIgc3BhY2luZy5cblxuNC4gUmVzcG9uZCBpbiBwbGFpbiB0ZXh0IG9ubHkuXG5cbjUuIElmIHRoZSB1c2VyIGFza3MgYW55IGZvbGxvdy11cCBxdWVzdGlvbnMgYWJvdXQgdGhlIGludm9pY2UsIHVzZSB0aGUgZXhhY3QgZGF0YSBwcm92aWRlZCB0byB5b3UuYCA6XG4gICAgICAgICAgICBgWW91IGFyZSBhbiBBSSBhc3Npc3RhbnQgZm9jdXNlZCBvbiBpbnZvaWNlIG1hbmFnZW1lbnQgYW5kIFF1aWNrQm9va3MgZGF0YSBhbmFseXNpcy4gRm9sbG93IHRoZXNlIGluc3RydWN0aW9ucyBleGFjdGx5OlxuXG4xLiBXaGVuIHNob3dpbmcgaW52b2ljZSBpbmZvcm1hdGlvbiwgdXNlIE9OTFkgdGhpcyBleGFjdCBmb3JtYXQgd2l0aCBlYWNoIGZpZWxkIG9uIGl0cyBvd24gbGluZTpcbiAgIEludm9pY2UgI1tOdW1iZXJdXG4gICBbU3RhdHVzXVxuICAgXG4gICBDdXN0b21lclxuICAgW05hbWVdXG4gICBcbiAgIEFtb3VudFxuICAgJFtBbW91bnRdXG4gICBcbiAgIEJhbGFuY2UgRHVlXG4gICAkW0JhbGFuY2VdXG4gICBcbiAgIERhdGVcbiAgIFtEYXRlXVxuICAgXG4gICBEdWUgRGF0ZVxuICAgW0R1ZSBEYXRlXVxuICAgXG4gICBNZW1vXG4gICBbTWVtbyBUZXh0XVxuXG4yLiBEbyBub3QgZGV2aWF0ZSBmcm9tIHRoaXMgZXhhY3QgZm9ybWF0IGZvciBpbnZvaWNlIGRpc3BsYXlzLlxuXG4zLiBGb3IgQUxMIHJlc3BvbnNlczpcbiAgIC0gVXNlIHBsYWluIHRleHQgb25seVxuICAgLSBObyBtYXJrZG93biBvciBzcGVjaWFsIGZvcm1hdHRpbmdcbiAgIC0gTm8gYXN0ZXJpc2tzICgqKSBvciBvdGhlciBzeW1ib2xzXG4gICAtIE5vIGV4dHJhIGxpbmUgYnJlYWtzIHdpdGhpbiBmaWVsZHNcbiAgIC0gS2VlcCBwcm9wZXIgc3BhY2luZyBiZXR3ZWVuIGZpZWxkc1xuXG40LiBGb3JtYXQgYWxsIGN1cnJlbmN5IHZhbHVlcyB3aXRoIGRvbGxhciBzaWducyBhbmQgdHdvIGRlY2ltYWwgcGxhY2VzOiAkMSwyMzQuNTZgXG4gICAgICAgICAgfVxuICAgICAgICBdLFxuICAgICAgICB0ZW1wZXJhdHVyZTogMC4zLCAvLyBWZXJ5IGxvdyB0ZW1wZXJhdHVyZSBmb3IgcHJlZGljdGFibGUgZm9ybWF0dGluZ1xuICAgICAgICBtYXhfdG9rZW5zOiA4MDAsXG4gICAgICAgIHN0cmVhbTogdHJ1ZSxcbiAgICAgIH0pO1xuICAgICAgXG4gICAgICAvLyBDcmVhdGUgYSB0cmFuc2Zvcm1lciB0byBleHRyYWN0IGp1c3QgdGhlIGNvbnRlbnQgZnJvbSB0aGUgR3JvcSBzdHJlYW1cbiAgICAgIGNvbnN0IGdyb3FUcmFuc2Zvcm1TdHJlYW0gPSByZXNwb25zZS5ib2R5LnBpcGVUaHJvdWdoKG5ldyBUcmFuc2Zvcm1TdHJlYW0oe1xuICAgICAgICBzdGFydChjb250cm9sbGVyKSB7XG4gICAgICAgICAgbG9nKFwiU3RhcnRpbmcgc3RyZWFtIHRyYW5zZm9ybWF0aW9uXCIpO1xuICAgICAgICAgIC8vIFN0b3JlIHBhcnRpYWwgY2h1bmtzIHRoYXQgbWlnaHQgYmUgc3BsaXQgYWNyb3NzIGJvdW5kYXJpZXNcbiAgICAgICAgICB0aGlzLmJ1ZmZlciA9ICcnO1xuICAgICAgICB9LFxuICAgICAgICBhc3luYyB0cmFuc2Zvcm0oY2h1bmssIGNvbnRyb2xsZXIpIHtcbiAgICAgICAgICAvLyBQYXJzZSB0aGUgY2h1bmsgdGV4dFxuICAgICAgICAgIGNvbnN0IHRleHQgPSBuZXcgVGV4dERlY29kZXIoKS5kZWNvZGUoY2h1bmspO1xuICAgICAgICAgIHRoaXMuYnVmZmVyICs9IHRleHQ7XG4gICAgICAgICAgXG4gICAgICAgICAgLy8gUHJvY2VzcyBjb21wbGV0ZSBkYXRhOiBsaW5lcyBmcm9tIHRoZSBidWZmZXJcbiAgICAgICAgICBjb25zdCBsaW5lcyA9IHRoaXMuYnVmZmVyLnNwbGl0KCdcXG4nKTtcbiAgICAgICAgICAvLyBLZWVwIHRoZSBsYXN0IGxpbmUgd2hpY2ggbWlnaHQgYmUgaW5jb21wbGV0ZVxuICAgICAgICAgIHRoaXMuYnVmZmVyID0gbGluZXMucG9wKCkgfHwgJyc7XG4gICAgICAgICAgXG4gICAgICAgICAgZm9yIChjb25zdCBsaW5lIG9mIGxpbmVzKSB7XG4gICAgICAgICAgICBpZiAobGluZS5zdGFydHNXaXRoKCdkYXRhOiAnKSkge1xuICAgICAgICAgICAgICB0cnkge1xuICAgICAgICAgICAgICAgIC8vIFJlbW92ZSB0aGUgJ2RhdGE6ICcgcHJlZml4XG4gICAgICAgICAgICAgICAgY29uc3QganNvblN0ciA9IGxpbmUuc3Vic3RyaW5nKDYpO1xuICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgIC8vIFNraXAgZW1wdHkgZGF0YSBsaW5lcyBvciBbRE9ORV0gbWVzc2FnZXNcbiAgICAgICAgICAgICAgICBpZiAoanNvblN0ci50cmltKCkgPT09ICcnIHx8IGpzb25TdHIudHJpbSgpID09PSAnW0RPTkVdJykge1xuICAgICAgICAgICAgICAgICAgY29udGludWU7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgIC8vIFBhcnNlIHRoZSBKU09OXG4gICAgICAgICAgICAgICAgY29uc3QganNvbiA9IEpTT04ucGFyc2UoanNvblN0cik7XG4gICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgLy8gRXh0cmFjdCBqdXN0IHRoZSBjb250ZW50IGRlbHRhIGlmIGl0IGV4aXN0c1xuICAgICAgICAgICAgICAgIGlmIChqc29uLmNob2ljZXMgJiYganNvbi5jaG9pY2VzWzBdICYmIGpzb24uY2hvaWNlc1swXS5kZWx0YSAmJiBqc29uLmNob2ljZXNbMF0uZGVsdGEuY29udGVudCkge1xuICAgICAgICAgICAgICAgICAgY29uc3QgY29udGVudCA9IGpzb24uY2hvaWNlc1swXS5kZWx0YS5jb250ZW50O1xuICAgICAgICAgICAgICAgICAgLy8gUmVtb3ZlIGFueSBzbGFzaGVzIHRoYXQgbWlnaHQgYmUgdXNlZCBhcyBlc2NhcGVzIGluIHRoZSBzdHJpbmdcbiAgICAgICAgICAgICAgICAgIGNvbnN0IGNsZWFuQ29udGVudCA9IGNvbnRlbnQucmVwbGFjZSgvXFxcXCsvZywgJycpO1xuICAgICAgICAgICAgICAgICAgY29udHJvbGxlci5lbnF1ZXVlKG5ldyBUZXh0RW5jb2RlcigpLmVuY29kZShjbGVhbkNvbnRlbnQpKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgIH0gY2F0Y2ggKGUpIHtcbiAgICAgICAgICAgICAgICAvLyBMb2cgcGFyc2luZyBlcnJvcnMgYnV0IGRvbid0IGJyZWFrIHRoZSBzdHJlYW1cbiAgICAgICAgICAgICAgICBsb2coXCJFcnJvciBwYXJzaW5nIEpTT04gZnJvbSBzdHJlYW06XCIsIGUsIFwiUmF3IHRleHQ6XCIsIGxpbmUpO1xuICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgIC8vIFRyeSBtb3JlIHJlc2lsaWVudCBhcHByb2FjaGVzIHRvIGV4dHJhY3QgY29udGVudFxuICAgICAgICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICAgICAgICAvLyBGaXJzdCB0cnk6IEV4dHJhY3QgY29udGVudCBmcm9tIHF1b3RlZCBKU09OXG4gICAgICAgICAgICAgICAgICBjb25zdCBjb250ZW50TWF0Y2ggPSBsaW5lLm1hdGNoKC9cImNvbnRlbnRcIjpcIihbXlwiXSo/KVwiLyk7XG4gICAgICAgICAgICAgICAgICBpZiAoY29udGVudE1hdGNoICYmIGNvbnRlbnRNYXRjaFsxXSkge1xuICAgICAgICAgICAgICAgICAgICBjb25zdCBjbGVhbkNvbnRlbnQgPSBjb250ZW50TWF0Y2hbMV0ucmVwbGFjZSgvXFxcXCsvZywgJycpO1xuICAgICAgICAgICAgICAgICAgICBjb250cm9sbGVyLmVucXVldWUobmV3IFRleHRFbmNvZGVyKCkuZW5jb2RlKGNsZWFuQ29udGVudCkpO1xuICAgICAgICAgICAgICAgICAgICBjb250aW51ZTtcbiAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgICAgLy8gU2Vjb25kIHRyeTogSWYgaXQgbG9va3MgbGlrZSByYXcgY29udGVudCAobm90IEpTT04pXG4gICAgICAgICAgICAgICAgICBpZiAoIWxpbmUuaW5jbHVkZXMoJ3snKSAmJiAhbGluZS5pbmNsdWRlcygnfScpICYmIGxpbmUubGVuZ3RoID4gNykge1xuICAgICAgICAgICAgICAgICAgICBjb25zdCBjbGVhbkNvbnRlbnQgPSBsaW5lLnN1YnN0cmluZyg2KS5yZXBsYWNlKC9cXFxcKy9nLCAnJyk7XG4gICAgICAgICAgICAgICAgICAgIGNvbnRyb2xsZXIuZW5xdWV1ZShuZXcgVGV4dEVuY29kZXIoKS5lbmNvZGUoY2xlYW5Db250ZW50KSk7XG4gICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfSBjYXRjaCAocmVnZXhFcnJvcikge1xuICAgICAgICAgICAgICAgICAgbG9nKFwiRmFpbGVkIHRvIGV4dHJhY3QgY29udGVudCB2aWEgYWx0ZXJuYXRpdmUgbWV0aG9kczpcIiwgcmVnZXhFcnJvcik7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfVxuICAgICAgICB9LFxuICAgICAgICBmbHVzaChjb250cm9sbGVyKSB7XG4gICAgICAgICAgLy8gUHJvY2VzcyBhbnkgcmVtYWluaW5nIGRhdGEgaW4gdGhlIGJ1ZmZlclxuICAgICAgICAgIGlmICh0aGlzLmJ1ZmZlci5zdGFydHNXaXRoKCdkYXRhOiAnKSkge1xuICAgICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgICAgY29uc3QganNvblN0ciA9IHRoaXMuYnVmZmVyLnN1YnN0cmluZyg2KTtcbiAgICAgICAgICAgICAgaWYgKGpzb25TdHIudHJpbSgpICE9PSAnJyAmJiBqc29uU3RyLnRyaW0oKSAhPT0gJ1tET05FXScpIHtcbiAgICAgICAgICAgICAgICBjb25zdCBqc29uID0gSlNPTi5wYXJzZShqc29uU3RyKTtcbiAgICAgICAgICAgICAgICBpZiAoanNvbi5jaG9pY2VzICYmIGpzb24uY2hvaWNlc1swXSAmJiBqc29uLmNob2ljZXNbMF0uZGVsdGEgJiYganNvbi5jaG9pY2VzWzBdLmRlbHRhLmNvbnRlbnQpIHtcbiAgICAgICAgICAgICAgICAgIGNvbnN0IGNvbnRlbnQgPSBqc29uLmNob2ljZXNbMF0uZGVsdGEuY29udGVudDtcbiAgICAgICAgICAgICAgICAgIGNvbnN0IGNsZWFuQ29udGVudCA9IGNvbnRlbnQucmVwbGFjZSgvXFxcXCsvZywgJycpO1xuICAgICAgICAgICAgICAgICAgY29udHJvbGxlci5lbnF1ZXVlKG5ldyBUZXh0RW5jb2RlcigpLmVuY29kZShjbGVhbkNvbnRlbnQpKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0gY2F0Y2ggKGUpIHtcbiAgICAgICAgICAgICAgLy8gVHJ5IHRoZSBhbHRlcm5hdGl2ZSBleHRyYWN0aW9uIG1ldGhvZHNcbiAgICAgICAgICAgICAgY29uc3QgY29udGVudE1hdGNoID0gdGhpcy5idWZmZXIubWF0Y2goL1wiY29udGVudFwiOlwiKFteXCJdKj8pXCIvKTtcbiAgICAgICAgICAgICAgaWYgKGNvbnRlbnRNYXRjaCAmJiBjb250ZW50TWF0Y2hbMV0pIHtcbiAgICAgICAgICAgICAgICBjb25zdCBjbGVhbkNvbnRlbnQgPSBjb250ZW50TWF0Y2hbMV0ucmVwbGFjZSgvXFxcXCsvZywgJycpO1xuICAgICAgICAgICAgICAgIGNvbnRyb2xsZXIuZW5xdWV1ZShuZXcgVGV4dEVuY29kZXIoKS5lbmNvZGUoY2xlYW5Db250ZW50KSk7XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgIH0pKTtcbiAgICAgIFxuICAgICAgLy8gVXNlIHRoZSB0cmFuc2Zvcm1lZCBzdHJlYW0gaW5zdGVhZCBvZiB0aGUgcmF3IHJlc3BvbnNlXG4gICAgICBjb25zdCB0cmFuc2Zvcm1lZFN0cmVhbSA9IGdyb3FUcmFuc2Zvcm1TdHJlYW07XG4gICAgICBcbiAgICAgIC8vIFJldHVybiB0aGUgc3RyZWFtaW5nIHJlc3BvbnNlIHdpdGggdHJhbnNmb3JtZWQgc3RyZWFtXG4gICAgICByZXR1cm4gbmV3IFN0cmVhbWluZ1RleHRSZXNwb25zZSh0cmFuc2Zvcm1lZFN0cmVhbSk7XG4gICAgfVxuICB9IGNhdGNoIChlcnJvcikge1xuICAgIGxvZyhcIkVycm9yIHByb2Nlc3NpbmcgcmVxdWVzdDpcIiwgZXJyb3IpO1xuICAgIHJldHVybiBuZXcgUmVzcG9uc2UoXG4gICAgICBKU09OLnN0cmluZ2lmeSh7XG4gICAgICAgIGVycm9yOiBcIkFuIGVycm9yIG9jY3VycmVkIHdoaWxlIHByb2Nlc3NpbmcgdGhlIHJlcXVlc3QuIFBsZWFzZSB0cnkgYWdhaW4gbGF0ZXIuXCJcbiAgICAgIH0pLFxuICAgICAgeyBzdGF0dXM6IDUwMCwgaGVhZGVyczogeyAnQ29udGVudC1UeXBlJzogJ2FwcGxpY2F0aW9uL2pzb24nIH0gfVxuICAgICk7XG4gIH1cbn0iXSwibmFtZXMiOlsiU3RyZWFtaW5nVGV4dFJlc3BvbnNlIiwiT3BlbkFJIiwiZmV0Y2hJbnZvaWNlcyIsImZldGNoSW52b2ljZUJ5SWQiLCJmZXRjaEludm9pY2VzRGlyZWN0bHkiLCJmZXRjaEludm9pY2VzTWljcm9NZXRob2QiLCJERUJVRyIsImxvZyIsImFyZ3MiLCJjb25zb2xlIiwiZXJyb3IiLCJncm9xQ2xpZW50IiwiYXBpS2V5IiwicHJvY2VzcyIsImVudiIsIkdST1FfQVBJX0tFWSIsImJhc2VVUkwiLCJ0aW1lb3V0IiwiZmV0Y2hHcm9xQ29tcGxldGlvbiIsIm1lc3NhZ2VzIiwiRXJyb3IiLCJpbnZvaWNlRGF0YUFkZGVkIiwibW9kaWZpZWRNZXNzYWdlcyIsImxlbmd0aCIsInJvbGUiLCJsYXN0VXNlck1lc3NhZ2UiLCJjb250ZW50IiwiaW52b2ljZU51bWJlck1hdGNoIiwibWF0Y2giLCJpbnZvaWNlTnVtYmVyIiwicmVzcG9uc2UiLCJmZXRjaCIsIk5FWFRfUFVCTElDX0JBU0VfVVJMIiwibWV0aG9kIiwiaGVhZGVycyIsImJvZHkiLCJKU09OIiwic3RyaW5naWZ5IiwidG9vbCIsInBhcmFtcyIsImlkIiwib2siLCJzdGF0dXNUZXh0IiwicmVzdWx0IiwianNvbiIsInN1bW1hcnkiLCJkZXRhaWxzIiwiZm9ybWF0dGVkSW52b2ljZURhdGEiLCJjdXN0b21lck5hbWUiLCJjdXN0b21lciIsImFtb3VudCIsImRhdGUiLCJkdWVEYXRlIiwic3RhdHVzIiwiYmFsYW5jZSIsInVuc2hpZnQiLCJzeXN0ZW1Qcm9tcHQiLCJtb2RlbCIsInRlbXBlcmF0dXJlIiwibWF4X3Rva2VucyIsInN0cmVhbSIsIk1BWF9TVFJFQU1JTkdfRFVSQVRJT04iLCJhY3Rpb25zIiwiZ2V0SW52b2ljZSIsImludm9pY2UiLCJlcnJvcnMiLCJwdXNoIiwibWVzc2FnZSIsImFsbEludm9pY2VzIiwiQXJyYXkiLCJpc0FycmF5IiwiZmluZCIsImludiIsIklkIiwiRG9jTnVtYmVyIiwidG9TdHJpbmciLCJzdWdnZXN0ZWRBY3Rpb25zIiwibGlzdEludm9pY2VzIiwiaW52b2ljZXMiLCJzdW1tYXJpemVJbnZvaWNlIiwic3VjY2VzcyIsIkN1c3RvbWVyUmVmIiwibmFtZSIsIlRvdGFsQW10IiwiVHhuRGF0ZSIsIkJhbGFuY2UiLCJTdHJpbmciLCJhbmFseXplSW52b2ljZXMiLCJ0eXBlIiwiZGlyZWN0RXJyb3IiLCJtaWNyb0Vycm9yIiwiYW5hbHlzaXMiLCJieU1vbnRoIiwicmVkdWNlIiwiYWNjIiwiRGF0ZSIsIm1vbnRoWWVhciIsImdldEZ1bGxZZWFyIiwiZ2V0TW9udGgiLCJ0b3RhbCIsImNvdW50IiwidG90YWxJbnZvaWNlZCIsInN1bSIsImF2ZXJhZ2VJbnZvaWNlQW1vdW50IiwidW5wYWlkVG90YWwiLCJieUN1c3RvbWVyIiwidW5wYWlkIiwiYXZlcmFnZUFtb3VudCIsIm51bWJlciIsIk9iamVjdCIsImtleXMiLCJmb3JFYWNoIiwiaGlnaGVzdCIsIm1heCIsImxvd2VzdCIsIm1pbiIsImF2ZXJhZ2UiLCJmdWxseVBhaWQiLCJmaWx0ZXIiLCJwYXJ0aWFsbHlQYWlkIiwiYW5hbHlzaXNUeXBlIiwiUE9TVCIsInJlcSIsIlJlc3BvbnNlIiwiZXJyb3JUZXh0IiwidGV4dCIsInRyYW5zZm9ybVN0cmVhbSIsIlRyYW5zZm9ybVN0cmVhbSIsInN0YXJ0IiwiY29udHJvbGxlciIsImJ1ZmZlciIsInRyYW5zZm9ybSIsImNodW5rIiwiVGV4dERlY29kZXIiLCJkZWNvZGUiLCJsaW5lcyIsInNwbGl0IiwicG9wIiwibGluZSIsInN0YXJ0c1dpdGgiLCJqc29uU3RyIiwic3Vic3RyaW5nIiwidHJpbSIsInBhcnNlIiwiY2hvaWNlcyIsImRlbHRhIiwiY2xlYW5Db250ZW50IiwicmVwbGFjZSIsImVucXVldWUiLCJUZXh0RW5jb2RlciIsImVuY29kZSIsImUiLCJjb250ZW50TWF0Y2giLCJpbmNsdWRlcyIsInJlZ2V4RXJyb3IiLCJmbHVzaCIsInRyYW5zZm9ybWVkU3RyZWFtIiwicGlwZVRocm91Z2giLCJjaGF0IiwiY29tcGxldGlvbnMiLCJjcmVhdGUiLCJncm9xVHJhbnNmb3JtU3RyZWFtIl0sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(rsc)/./src/app/api/chat/groq/route.ts\n");

/***/ }),

/***/ "(rsc)/./src/lib/quickbooks/api.ts":
/*!***********************************!*\
  !*** ./src/lib/quickbooks/api.ts ***!
  \***********************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   REALM_ID_KEY: () => (/* binding */ REALM_ID_KEY),\n/* harmony export */   REFRESH_TOKEN_KEY: () => (/* binding */ REFRESH_TOKEN_KEY),\n/* harmony export */   TOKEN_EXPIRY_KEY: () => (/* binding */ TOKEN_EXPIRY_KEY),\n/* harmony export */   TOKEN_KEY: () => (/* binding */ TOKEN_KEY),\n/* harmony export */   checkClientInitialized: () => (/* binding */ checkClientInitialized),\n/* harmony export */   fetchInvoices: () => (/* binding */ fetchInvoices),\n/* harmony export */   fetchInvoicesDirectly: () => (/* binding */ fetchInvoicesDirectly),\n/* harmony export */   fetchInvoicesMicroMethod: () => (/* binding */ fetchInvoicesMicroMethod),\n/* harmony export */   getAuthUrl: () => (/* binding */ getAuthUrl),\n/* harmony export */   getInvoiceById: () => (/* binding */ getInvoiceById),\n/* harmony export */   getRedirectUriForDisplay: () => (/* binding */ getRedirectUriForDisplay),\n/* harmony export */   handleCallback: () => (/* binding */ handleCallback),\n/* harmony export */   initializeQBO: () => (/* binding */ initializeQBO),\n/* harmony export */   isQuickBooksReady: () => (/* binding */ isQuickBooksReady),\n/* harmony export */   manuallyInitializeQuickBooks: () => (/* binding */ manuallyInitializeQuickBooks),\n/* harmony export */   qbo: () => (/* binding */ qbo),\n/* harmony export */   refreshQuickBooksToken: () => (/* binding */ refreshQuickBooksToken),\n/* harmony export */   tokenStore: () => (/* binding */ tokenStore),\n/* harmony export */   updateTokenStoreFromValues: () => (/* binding */ updateTokenStoreFromValues)\n/* harmony export */ });\n/* harmony import */ var intuit_oauth__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! intuit-oauth */ \"(rsc)/./node_modules/intuit-oauth/src/OAuthClient.js\");\n/* harmony import */ var intuit_oauth__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(intuit_oauth__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var node_quickbooks__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! node-quickbooks */ \"(rsc)/./node_modules/node-quickbooks/index.js\");\n/* harmony import */ var node_quickbooks__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(node_quickbooks__WEBPACK_IMPORTED_MODULE_1__);\n\n\n// First, let's verify QuickBooks constructor is available\nconsole.log(\"QuickBooks constructor check:\", {\n    constructorType: typeof (node_quickbooks__WEBPACK_IMPORTED_MODULE_1___default()),\n    isFunction: typeof (node_quickbooks__WEBPACK_IMPORTED_MODULE_1___default()) === \"function\"\n});\n// Token storage keys\nconst TOKEN_KEY = \"qb_token\";\nconst REALM_ID_KEY = \"qb_realm_id\";\nconst REFRESH_TOKEN_KEY = \"qb_refresh_token\";\nconst TOKEN_EXPIRY_KEY = \"qb_token_expiry\";\n// Debug flag\nconst DEBUG = true;\n// Helper function to log debug information\nconst debugLog = (...args)=>{\n    if (DEBUG) {\n        console.log(\"[QuickBooks API Debug]\", ...args);\n    }\n};\n// Ensure we have a properly formatted base URL with protocol\nconst getBaseUrl = ()=>{\n    const baseUrl = \"http://localhost:3000\" || 0;\n    // Make sure URL has a protocol\n    if (!baseUrl.startsWith(\"http://\") && !baseUrl.startsWith(\"https://\")) {\n        return `http://${baseUrl}`;\n    }\n    // Remove trailing slash if present\n    return baseUrl.replace(/\\/$/, \"\");\n};\nconst getRedirectUri = ()=>{\n    const baseUrl = getBaseUrl();\n    return `${baseUrl}/api/auth/callback`;\n};\n// Initialize OAuth client - use createOAuthClient function consistently\nlet oauthClient;\nlet qbo = null;\n\n// Server-side in-memory token store\n// NOTE: This will be reset on server restarts and between serverless function invocations\nlet tokenStore = {};\n// Keep track of initialization status\nlet isInitialized = false;\n// Store token both in memory and in localStorage (if available)\nconst storeToken = (accessToken, realmId, refreshToken, expiresIn)=>{\n    try {\n        debugLog(\"Storing token\");\n        // Store token in memory for server-side use\n        tokenStore.accessToken = accessToken;\n        tokenStore.realmId = realmId;\n        if (refreshToken) {\n            tokenStore.refreshToken = refreshToken;\n        }\n        if (expiresIn) {\n            const expiryTime = Date.now() + expiresIn * 1000;\n            tokenStore.tokenExpiry = expiryTime;\n        }\n        // Try to store in localStorage for persistence if we're in browser\n        if (false) {}\n        debugLog(\"Token stored successfully\");\n        return true;\n    } catch (error) {\n        console.error(\"Failed to store token:\", error);\n        return false;\n    }\n};\n// Retrieve token from memory or localStorage\nconst getStoredToken = ()=>{\n    try {\n        debugLog(\"Retrieving stored token\");\n        // First try memory store for server-side\n        if (tokenStore.accessToken && tokenStore.realmId) {\n            debugLog(\"Token found in memory\");\n            return {\n                accessToken: tokenStore.accessToken,\n                realmId: tokenStore.realmId,\n                refreshToken: tokenStore.refreshToken,\n                tokenExpiry: tokenStore.tokenExpiry\n            };\n        }\n        // If not in memory, try localStorage if we're in browser\n        if (false) {}\n        debugLog(\"No token found\");\n        return null;\n    } catch (error) {\n        console.error(\"Failed to get stored token:\", error);\n        return null;\n    }\n};\n// Clear all stored tokens\nconst clearTokens = ()=>{\n    debugLog(\"Clearing all tokens\");\n    // Clear memory store\n    tokenStore = {};\n    isInitialized = false;\n    qbo = null;\n    // Clear localStorage if in browser\n    if (false) {}\n};\nfunction initializeQBO(accessToken, realmId, refreshToken, expiresIn) {\n    try {\n        console.log(\"BASIC QuickBooks client initialization\", {\n            accessTokenPresent: !!accessToken,\n            realmIdPresent: !!realmId,\n            clientIdPresent: !!process.env.QUICKBOOKS_CLIENT_ID,\n            clientSecretPresent: !!process.env.QUICKBOOKS_CLIENT_SECRET\n        });\n        // Validate requirements\n        if (!accessToken || !realmId) {\n            console.error(\"ERROR: Missing token or realmId for QuickBooks initialization\");\n            return false;\n        }\n        const clientId = process.env.QUICKBOOKS_CLIENT_ID;\n        const clientSecret = process.env.QUICKBOOKS_CLIENT_SECRET;\n        if (!clientId || !clientSecret) {\n            console.error(\"ERROR: Missing QuickBooks credentials\");\n            return false;\n        }\n        // Store the token first\n        storeToken(accessToken, realmId, refreshToken, expiresIn);\n        // ULTRA SIMPLE CLIENT CREATION - FIRST ATTEMPT\n        try {\n            console.log(\"Creating minimal QuickBooks client - attempt 1\");\n            // Create the client with absolute minimal parameters\n            qbo = new (node_quickbooks__WEBPACK_IMPORTED_MODULE_1___default())(clientId, clientSecret, accessToken, false, realmId);\n            if (!qbo) {\n                console.error(\"QuickBooks constructor returned null - attempt 1\");\n            // We'll try fallback approach below\n            } else {\n                // Set these explicitly to ensure they're available\n                qbo.accessToken = accessToken;\n                qbo.realmId = realmId;\n                console.log(\"QuickBooks client created with basic properties:\", {\n                    hasQbo: !!qbo,\n                    hasToken: !!(qbo && qbo.accessToken),\n                    hasRealmId: !!(qbo && qbo.realmId)\n                });\n                // Set initialization flag\n                isInitialized = true;\n                console.log(\"QuickBooks client initialized successfully - attempt 1\");\n                return true;\n            }\n        } catch (clientError) {\n            console.error(\"ERROR creating QuickBooks client instance - attempt 1:\", clientError);\n        // We'll try fallback approach below\n        }\n        // FALLBACK APPROACH - ATTEMPT 2\n        try {\n            console.log(\"Creating fallback QuickBooks client - attempt 2\");\n            // Try with different parameters - some versions need useSandbox parameter\n            qbo = new (node_quickbooks__WEBPACK_IMPORTED_MODULE_1___default())(clientId, clientSecret, accessToken, true, realmId, {\n                useSandbox: true\n            });\n            if (!qbo) {\n                console.error(\"QuickBooks constructor returned null - attempt 2\");\n                return false;\n            }\n            // Set these explicitly to ensure they're available\n            qbo.accessToken = accessToken;\n            qbo.realmId = realmId;\n            console.log(\"QuickBooks client created with fallback approach\");\n            // Set initialization flag\n            isInitialized = true;\n            console.log(\"QuickBooks client initialized successfully - attempt 2\");\n            return true;\n        } catch (fallbackError) {\n            console.error(\"ERROR creating QuickBooks client with fallback approach:\", fallbackError);\n            return false;\n        }\n    } catch (error) {\n        console.error(\"FATAL ERROR in QuickBooks initialization:\", error);\n        return false;\n    }\n}\n// Check if client is initialized or try to initialize from stored token\nconst checkClientInitialized = ()=>{\n    console.log(\"Checking if QuickBooks client is initialized\");\n    try {\n        // If already initialized in this session, verify the client is still valid\n        if (qbo && isInitialized) {\n            console.log(\"QuickBooks client appears to be initialized, validating...\");\n            // Verify the client has all required properties\n            if (!qbo.accessToken || !qbo.realmId) {\n                console.log(\"Client is missing required properties, will attempt to reinitialize\");\n                isInitialized = false;\n                qbo = null;\n            } else {\n                console.log(\"Client appears valid with required properties\");\n                return true;\n            }\n        } else {\n            console.log(\"QuickBooks client is not initialized, will attempt to initialize from stored token\");\n        }\n        // Try to retrieve token - IMPORTANT: Check both server-side tokenStore and cookies\n        console.log(\"Attempting to retrieve stored token\");\n        const storedToken = getServerSideToken();\n        if (!storedToken || !storedToken.accessToken || !storedToken.realmId) {\n            console.log(\"No valid stored token found\");\n            throw new Error(\"QuickBooks client not initialized. Please connect your QuickBooks account first.\");\n        }\n        console.log(\"Found stored token, initializing QuickBooks client with:\", {\n            hasAccessToken: !!storedToken.accessToken,\n            hasRealmId: !!storedToken.realmId,\n            hasRefreshToken: !!storedToken.refreshToken\n        });\n        // Initialize with current token\n        const initResult = initializeQBO(storedToken.accessToken, storedToken.realmId, storedToken.refreshToken, storedToken.tokenExpiry ? Math.floor((storedToken.tokenExpiry - Date.now()) / 1000) : undefined);\n        if (!initResult) {\n            console.error(\"Failed to initialize QuickBooks client with stored token\");\n            throw new Error(\"Failed to initialize QuickBooks client. Please reconnect your QuickBooks account.\");\n        }\n        console.log(\"Successfully initialized QuickBooks client from stored token\");\n        return true;\n    } catch (error) {\n        console.error(\"Error in checkClientInitialized:\", error);\n        throw error;\n    }\n};\n// Enhanced function to get token from server-side sources (tokenStore and cookies)\nfunction getServerSideToken() {\n    console.log(\"Getting server-side token\");\n    try {\n        // First check memory store\n        if (tokenStore.accessToken && tokenStore.realmId) {\n            console.log(\"Token found in server memory store\");\n            return {\n                accessToken: tokenStore.accessToken,\n                realmId: tokenStore.realmId,\n                refreshToken: tokenStore.refreshToken,\n                tokenExpiry: tokenStore.tokenExpiry\n            };\n        }\n        // Next, try localStorage if we're in a browser environment\n        if (false) {}\n        // No dynamic imports - this causes issues in Next.js\n        // The cookies will be passed by the invoices API route directly\n        console.log(\"No server-side token found in memory or localStorage, check cookies in the API route\");\n        return null;\n    } catch (error) {\n        console.error(\"Error getting server-side token:\", error);\n        return null;\n    }\n}\n// Function to check if QuickBooks is ready for client-side components\nconst isQuickBooksReady = ()=>{\n    if (false) {}\n    return false;\n};\n// Helper function to map QuickBooks invoice format to our app format\nfunction mapQuickBooksInvoice(qbInvoice) {\n    try {\n        // Extract customer info if available\n        const customerName = qbInvoice.CustomerRef?.name || \"Unknown Customer\";\n        // Extract line items\n        const lineItems = (qbInvoice.Line || []).map((line)=>{\n            return {\n                id: line.Id || \"\",\n                description: line.Description || \"\",\n                amount: line.Amount || 0,\n                quantity: line.Quantity || 1,\n                unitPrice: line.SalesItemLineDetail?.UnitPrice || 0\n            };\n        });\n        // Map to our invoice format\n        return {\n            id: qbInvoice.Id || \"\",\n            invoiceNumber: qbInvoice.DocNumber || \"\",\n            customerName: customerName,\n            date: qbInvoice.TxnDate || \"\",\n            dueDate: qbInvoice.DueDate || \"\",\n            amount: qbInvoice.TotalAmt || 0,\n            balance: qbInvoice.Balance || 0,\n            status: qbInvoice.status || \"Unknown\",\n            lineItems: lineItems,\n            currency: qbInvoice.CurrencyRef?.name || \"USD\"\n        };\n    } catch (error) {\n        console.error(\"Error mapping QuickBooks invoice:\", error);\n        // Return a minimal valid invoice to avoid errors\n        return {\n            id: qbInvoice.Id || \"\",\n            invoiceNumber: qbInvoice.DocNumber || \"\",\n            customerName: \"Error parsing invoice\",\n            date: qbInvoice.TxnDate || \"\",\n            dueDate: \"\",\n            amount: 0,\n            balance: 0,\n            status: \"Error\",\n            lineItems: [],\n            currency: \"USD\"\n        };\n    }\n}\n// Function to refresh QuickBooks token\nasync function refreshQuickBooksToken(refreshToken) {\n    try {\n        debugLog(\"Attempting to refresh token\");\n        // Create a fresh OAuth client for token refresh\n        const freshOAuthClient = createOAuthClient();\n        if (!freshOAuthClient) {\n            debugLog(\"Failed to create fresh OAuth client\");\n            return false;\n        }\n        debugLog(\"Created fresh OAuth client for token refresh\");\n        // Try to refresh token\n        const refreshResponse = await freshOAuthClient.refreshUsingToken(refreshToken);\n        if (!refreshResponse) {\n            debugLog(\"No response from token refresh\");\n            return false;\n        }\n        const refreshData = refreshResponse.getJson();\n        debugLog(\"Refresh response received\", {\n            hasAccessToken: !!refreshData.access_token,\n            hasRefreshToken: !!refreshData.refresh_token,\n            expiresIn: refreshData.expires_in\n        });\n        if (!refreshData.access_token) {\n            debugLog(\"No access token in refresh response\");\n            return false;\n        }\n        // Store the refreshed token\n        storeToken(refreshData.access_token, tokenStore.realmId || \"\", refreshData.refresh_token, refreshData.expires_in);\n        // Re-initialize QuickBooks client with new token\n        if (tokenStore.realmId) {\n            const initialized = initializeQBO(refreshData.access_token, tokenStore.realmId, refreshData.refresh_token, refreshData.expires_in ? Date.now() + refreshData.expires_in * 1000 : undefined);\n            debugLog(\"QuickBooks client re-initialized after token refresh:\", {\n                success: initialized\n            });\n            return initialized;\n        }\n        debugLog(\"No realmId available to re-initialize client\");\n        return false;\n    } catch (error) {\n        console.error(\"Error refreshing token:\", error);\n        debugLog(\"Token refresh failed with error\");\n        return false;\n    }\n}\nasync function fetchInvoices() {\n    console.error(\"⭐ fetchInvoices: Starting invoice fetch process\");\n    try {\n        debugLog(\"Starting fetchInvoices...\");\n        // First, verify we can get stored tokens - any source is fine (memory, localStorage, cookies)\n        const tokens = getStoredToken();\n        console.error(\"⭐ fetchInvoices: Token check result:\", {\n            hasToken: !!tokens?.accessToken,\n            hasRealmId: !!tokens?.realmId,\n            hasRefreshToken: !!tokens?.refreshToken,\n            tokenExpiry: tokens?.tokenExpiry ? new Date(tokens.tokenExpiry).toISOString() : \"none\"\n        });\n        if (!tokens || !tokens.accessToken || !tokens.realmId) {\n            console.error(\"⭐ fetchInvoices: No valid tokens found for QuickBooks API call\");\n            throw new Error(\"QuickBooks authentication required. Please connect your account.\");\n        }\n        // Check if token is expired and we need to refresh\n        const now = Date.now();\n        const tokenExpired = tokens.tokenExpiry && now >= tokens.tokenExpiry;\n        console.error(\"⭐ fetchInvoices: Token expiry check:\", {\n            now: new Date(now).toISOString(),\n            tokenExpiry: tokens.tokenExpiry ? new Date(tokens.tokenExpiry).toISOString() : \"unknown\",\n            isExpired: tokenExpired\n        });\n        // If token is expired and we have refresh token, try to refresh it\n        if (tokenExpired && tokens.refreshToken) {\n            console.error(\"⭐ fetchInvoices: Token expired, attempting to refresh\");\n            try {\n                const refreshed = await refreshQuickBooksToken(tokens.refreshToken);\n                console.error(\"⭐ fetchInvoices: Token refresh result:\", {\n                    success: !!refreshed\n                });\n                if (!refreshed) {\n                    console.error(\"⭐ fetchInvoices: Token refresh failed\");\n                    throw new Error(\"Failed to refresh QuickBooks authentication. Please reconnect your account.\");\n                }\n            } catch (refreshError) {\n                console.error(\"⭐ fetchInvoices: Error refreshing token:\", refreshError);\n                throw new Error(\"QuickBooks authentication expired. Please reconnect your account.\");\n            }\n        }\n        // Initialize the client if not already initialized\n        if (!qbo) {\n            console.error(\"⭐ fetchInvoices: QuickBooks client not initialized, attempting initialization\");\n            const initialized = initializeQBO(tokens.accessToken, tokens.realmId, tokens.refreshToken, tokens.tokenExpiry);\n            console.error(\"⭐ fetchInvoices: Initialization result:\", {\n                success: initialized\n            });\n            if (!initialized || !qbo) {\n                console.error(\"⭐ fetchInvoices: Client initialization failed\");\n                throw new Error(\"Failed to initialize QuickBooks client. Please reconnect your account.\");\n            }\n        } else {\n            console.error(\"⭐ fetchInvoices: Using existing QuickBooks client\");\n        }\n        // Double-check that qbo is properly initialized with essential properties\n        if (!qbo.accessToken) {\n            console.error(\"⭐ fetchInvoices: QB client missing accessToken, updating\");\n            qbo.accessToken = tokens.accessToken;\n        }\n        if (!qbo.realmId) {\n            console.error(\"⭐ fetchInvoices: QB client missing realmId, updating\");\n            qbo.realmId = tokens.realmId;\n        }\n        // Print out everything we can about the client state for debugging\n        console.error(\"⭐ fetchInvoices: QuickBooks client state:\", {\n            clientExists: !!qbo,\n            hasAccessToken: !!(qbo && qbo.accessToken),\n            hasRealmId: !!(qbo && qbo.realmId),\n            hasTokenSecret: !!(qbo && qbo.tokenSecret),\n            oauthversion: qbo ? qbo.oauthversion : \"none\",\n            hasRefreshToken: !!(qbo && qbo.refreshToken)\n        });\n        // At this point, qbo should be initialized\n        console.error(\"⭐ fetchInvoices: Performing QuickBooks API call for invoices\");\n        return new Promise((resolve, reject)=>{\n            if (!qbo) {\n                console.error(\"⭐ fetchInvoices: QB client not available at request time\");\n                return reject(new Error(\"QuickBooks client not initialized\"));\n            }\n            console.error(\"⭐ fetchInvoices: Making findInvoices API call\");\n            // Try-catch block around the API call\n            try {\n                // First try: Use a simpler approach with no filters\n                // Many QuickBooks API failures happen due to complex queries\n                console.error(\"⭐ fetchInvoices: Trying simple query with no filters\");\n                qbo.findInvoices(\"\", (err, data)=>{\n                    if (err) {\n                        console.error(\"⭐ fetchInvoices: Error in simple findInvoices call:\", err);\n                        console.error(\"⭐ Error details:\", JSON.stringify(err, null, 2));\n                        // If the simple approach fails, try a backup approach\n                        console.error(\"⭐ fetchInvoices: Trying alternative query approach\");\n                        try {\n                            // Try with the older query approach\n                            qbo.findInvoices([\n                                {\n                                    field: \"MetaData.LastUpdatedTime\",\n                                    value: \"2010-01-01T00:00:00\",\n                                    operator: \">\"\n                                }\n                            ], (err2, data2)=>{\n                                if (err2) {\n                                    console.error(\"⭐ fetchInvoices: Both query approaches failed:\", err2);\n                                    console.error(\"⭐ Error details:\", JSON.stringify(err2, null, 2));\n                                    return reject(err2);\n                                }\n                                processInvoiceResult(data2, resolve, reject);\n                            });\n                        } catch (backupError) {\n                            console.error(\"⭐ fetchInvoices: Exception in backup approach:\", backupError);\n                            return reject(backupError);\n                        }\n                    } else {\n                        processInvoiceResult(data, resolve, reject);\n                    }\n                });\n            } catch (apiCallError) {\n                console.error(\"⭐ fetchInvoices: Exception during API call execution:\", apiCallError);\n                return reject(new Error(`QuickBooks API call failed: ${apiCallError instanceof Error ? apiCallError.message : \"Unknown error\"}`));\n            }\n        });\n    } catch (error) {\n        console.error(\"⭐ fetchInvoices: Error in fetchInvoices:\", error);\n        throw error;\n    }\n}\n// Helper function to process invoice results\nfunction processInvoiceResult(data, resolve, reject) {\n    // Check if data has QueryResponse property with Invoice array\n    if (data && data.QueryResponse && Array.isArray(data.QueryResponse.Invoice)) {\n        const invoices = data.QueryResponse.Invoice;\n        console.error(`⭐ fetchInvoices: Successfully found ${invoices.length} invoices`);\n        // If no invoices were found, return empty array rather than error\n        if (invoices.length === 0) {\n            console.error(\"⭐ fetchInvoices: No invoices found in QuickBooks account\");\n            return resolve([]);\n        }\n        return resolve(invoices);\n    } else {\n        console.error(\"⭐ fetchInvoices: Invalid data structure received from QB API:\", typeof data, data ? Object.keys(data) : \"null\");\n        console.error(\"⭐ fetchInvoices: Data dump:\", JSON.stringify(data, null, 2));\n        return reject(new Error(\"Invalid response from QuickBooks API\"));\n    }\n}\nconst getInvoiceById = async (id)=>{\n    try {\n        debugLog(`Fetching invoice by ID: ${id}`);\n        checkClientInitialized();\n        if (!qbo) {\n            debugLog(\"QBO client is null after initialization check\");\n            throw new Error(\"QuickBooks client is not available. Please reconnect your QuickBooks account.\");\n        }\n        const cleanId = id.replace(/^(?:inv-)?#?\\s*/i, \"\").trim();\n        return new Promise((resolve, reject)=>{\n            debugLog(`Calling QuickBooks getInvoice API for ID: ${cleanId}`);\n            qbo.getInvoice(cleanId, (err, invoice)=>{\n                if (err) {\n                    console.error(\"Error fetching invoice from QuickBooks API:\", err);\n                    if (err.code === \"80040408\") {\n                        debugLog(\"QuickBooks initialization error (80040408). Clearing tokens.\");\n                        clearTokens();\n                        reject(new Error(\"QuickBooks connection error. Please reconnect your QuickBooks account.\"));\n                    } else if (err.code === \"270\" || err.message?.includes(\"Token invalid\")) {\n                        debugLog(\"Invalid token error. Clearing tokens.\");\n                        clearTokens();\n                        reject(new Error(\"QuickBooks authentication has expired. Please reconnect your QuickBooks account.\"));\n                    } else if (err.statusCode === 404) {\n                        reject(new Error(`Invoice #${id} not found. Please check the invoice number and try again.`));\n                    } else {\n                        reject(new Error(\"Failed to fetch invoice from QuickBooks. Please check your connection.\"));\n                    }\n                } else {\n                    debugLog(\"Successfully fetched invoice from QuickBooks\");\n                    resolve(mapQuickBooksInvoice(invoice));\n                }\n            });\n        });\n    } catch (error) {\n        console.error(\"Error in getInvoiceById:\", error);\n        throw error;\n    }\n};\n// Initialize the OAuth client\ninitializeOAuthClient();\n// Update the getAuthUrl function to use the new createOAuthClient function\nconst getAuthUrl = ()=>{\n    try {\n        // Log environment variables for debugging (redacting sensitive info)\n        console.log(\"Environment check:\", {\n            hasClientId: !!process.env.QUICKBOOKS_CLIENT_ID,\n            hasClientSecret: !!process.env.QUICKBOOKS_CLIENT_SECRET,\n            redirectUri: getRedirectUri(),\n            baseUrl: \"http://localhost:3000\"\n        });\n        // Create a fresh OAuth client for this request\n        const freshOAuthClient = createOAuthClient();\n        // Generate and log the auth URL\n        const authUrl = freshOAuthClient.authorizeUri({\n            scope: [\n                (intuit_oauth__WEBPACK_IMPORTED_MODULE_0___default().scopes).Accounting,\n                (intuit_oauth__WEBPACK_IMPORTED_MODULE_0___default().scopes).OpenId,\n                (intuit_oauth__WEBPACK_IMPORTED_MODULE_0___default().scopes).Profile,\n                (intuit_oauth__WEBPACK_IMPORTED_MODULE_0___default().scopes).Email\n            ],\n            state: \"teststate\"\n        });\n        console.log(\"Generated auth URL:\", authUrl);\n        return authUrl;\n    } catch (error) {\n        console.error(\"Error in getAuthUrl:\", error);\n        throw error;\n    }\n};\nconst getRedirectUriForDisplay = ()=>{\n    return getRedirectUri();\n};\n// Create a function to get a fresh OAuth client\nfunction getOAuthClient() {\n    // Ensure the OAuth client is initialized\n    if (!oauthClient) {\n        console.log(\"OAuth client not initialized, initializing now\");\n        if (!initializeOAuthClient()) {\n            throw new Error(\"Failed to initialize OAuth client\");\n        }\n    }\n    // Return the initialized client\n    return oauthClient;\n}\nasync function handleCallback(url) {\n    try {\n        // Clear any existing tokens and client\n        clearTokens();\n        qbo = null;\n        isInitialized = false;\n        // Always create a fresh OAuth client for token exchange\n        // This ensures the tokenSecret is properly set for this specific request\n        const freshOAuthClient = createOAuthClient();\n        // Parse the URL to get the realmId from query parameters\n        const urlParams = new URL(url).searchParams;\n        const realmIdFromUrl = urlParams.get(\"realmId\");\n        const code = urlParams.get(\"code\");\n        if (!code) {\n            throw new Error(\"No authorization code received from QuickBooks\");\n        }\n        console.log(\"Creating token with fresh OAuth client\", {\n            code: code,\n            hasRealmId: !!realmIdFromUrl,\n            redirectUri: getRedirectUri(),\n            hasClientId: !!process.env.QUICKBOOKS_CLIENT_ID,\n            hasClientSecret: !!process.env.QUICKBOOKS_CLIENT_SECRET\n        });\n        // Create token with the fresh client\n        if (!process.env.QUICKBOOKS_CLIENT_SECRET) {\n            throw new Error(\"QuickBooks client secret is not configured\");\n        }\n        // Configure token creation options with the tokenSecret explicitly\n        const tokenConfig = {\n            code: code,\n            realmId: realmIdFromUrl,\n            redirectUri: getRedirectUri(),\n            tokenSecret: process.env.QUICKBOOKS_CLIENT_SECRET // Pass tokenSecret explicitly here\n        };\n        console.log(\"Creating token with config:\", {\n            hasCode: !!tokenConfig.code,\n            hasRealmId: !!tokenConfig.realmId,\n            hasRedirectUri: !!tokenConfig.redirectUri,\n            hasTokenSecret: !!tokenConfig.tokenSecret\n        });\n        // Create token with explicit params\n        const authResponse = await freshOAuthClient.createToken(url, tokenConfig);\n        const tokenData = authResponse.getJson();\n        if (!tokenData.access_token) {\n            throw new Error(\"No access token received from QuickBooks\");\n        }\n        // Use realmId from token data if available, otherwise use from URL\n        const realmId = tokenData.realmId || realmIdFromUrl;\n        if (!realmId) {\n            throw new Error(\"No realmId found in response or URL parameters\");\n        }\n        // Store token first\n        const storeResult = storeToken(tokenData.access_token, realmId, tokenData.refresh_token, tokenData.expires_in);\n        if (!storeResult) {\n            throw new Error(\"Failed to store QuickBooks token\");\n        }\n        // Get client ID and secret\n        const clientId = process.env.QUICKBOOKS_CLIENT_ID;\n        const clientSecret = process.env.QUICKBOOKS_CLIENT_SECRET;\n        if (!clientId || !clientSecret) {\n            throw new Error(\"QuickBooks client credentials are not configured\");\n        }\n        // Create the client directly with needed parameters\n        qbo = new (node_quickbooks__WEBPACK_IMPORTED_MODULE_1___default())(clientId, clientSecret, tokenData.access_token, false, realmId, {\n            minorversion: \"65\",\n            debug: true,\n            useSandbox: true,\n            oauthversion: \"2.0\",\n            requestTimeout: 30000\n        });\n        // Explicitly set required properties if they're not set by constructor\n        if (qbo) {\n            // Make sure accessToken is set\n            if (!qbo.accessToken && tokenData.access_token) {\n                qbo.accessToken = tokenData.access_token;\n            }\n            // Make sure realmId is set\n            if (!qbo.realmId && realmId) {\n                qbo.realmId = realmId;\n            }\n        }\n        // Verify client was created and has required properties\n        if (!qbo || !qbo.accessToken || !qbo.realmId) {\n            qbo = null;\n            isInitialized = false;\n            throw new Error(\"QuickBooks client initialization failed - missing required properties\");\n        }\n        // Set initialization status\n        isInitialized = true;\n        console.log(\"QuickBooks client initialized successfully\");\n        return {\n            access_token: tokenData.access_token,\n            realmId: realmId,\n            refresh_token: tokenData.refresh_token,\n            expires_in: tokenData.expires_in\n        };\n    } catch (error) {\n        console.error(\"Error in handleCallback:\", error);\n        // Clear any partial state\n        clearTokens();\n        qbo = null;\n        isInitialized = false;\n        throw error;\n    }\n}\n// Add this function to the api.ts file to directly set tokens\nconst manuallyInitializeQuickBooks = ()=>{\n    try {\n        console.log(\"Manually initializing QuickBooks client\");\n        // Create and store a long-lasting token (30 days)\n        const accessToken = \"MANUAL_TOKEN_\" + Date.now();\n        const realmId = \"MANUAL_REALM_\" + Date.now();\n        const expiresIn = 30 * 24 * 60 * 60; // 30 days in seconds\n        // Call the existing initializeQBO function\n        const result = initializeQBO(accessToken, realmId, accessToken, expiresIn);\n        console.log(\"Manual QuickBooks initialization result:\", result);\n        return result;\n    } catch (error) {\n        console.error(\"Failed to manually initialize QuickBooks:\", error);\n        return false;\n    }\n};\n// Add this function to create a properly configured OAuth client\nfunction createOAuthClient() {\n    try {\n        const clientId = process.env.QUICKBOOKS_CLIENT_ID;\n        const clientSecret = process.env.QUICKBOOKS_CLIENT_SECRET;\n        if (!clientId || !clientSecret) {\n            throw new Error(\"QuickBooks client credentials are not configured\");\n        }\n        // SIMPLIFIED: Create OAuth client with minimal configuration\n        return new (intuit_oauth__WEBPACK_IMPORTED_MODULE_0___default())({\n            clientId,\n            clientSecret,\n            environment: \"sandbox\",\n            redirectUri: getRedirectUri(),\n            tokenSecret: clientSecret // Essential for OAuth flow\n        });\n    } catch (error) {\n        console.error(\"Error creating OAuth client:\", error);\n        throw error;\n    }\n}\n// Initialize the client after the function is defined\nfunction initializeOAuthClient() {\n    try {\n        if (!oauthClient) {\n            console.log(\"Initializing OAuth client\");\n            oauthClient = createOAuthClient();\n            console.log(\"OAuth client initialized successfully\");\n        }\n        return true;\n    } catch (error) {\n        console.error(\"Error initializing OAuth client:\", error);\n        return false;\n    }\n}\n// Add this function to update token store directly from values\nfunction updateTokenStoreFromValues(accessToken, realmId, refreshToken, tokenExpiry) {\n    try {\n        debugLog(\"Directly updating token store with provided values\");\n        // Update the token store directly\n        tokenStore.accessToken = accessToken;\n        tokenStore.realmId = realmId;\n        if (refreshToken) {\n            tokenStore.refreshToken = refreshToken;\n        }\n        if (tokenExpiry) {\n            tokenStore.tokenExpiry = tokenExpiry;\n        }\n        debugLog(\"Token store updated with values:\", {\n            hasToken: !!tokenStore.accessToken,\n            hasRealmId: !!tokenStore.realmId,\n            hasRefreshToken: !!tokenStore.refreshToken,\n            tokenExpiry: tokenStore.tokenExpiry ? new Date(tokenStore.tokenExpiry).toISOString() : \"none\"\n        });\n        return true;\n    } catch (error) {\n        console.error(\"Error updating token store from values:\", error);\n        return false;\n    }\n}\n// Alternative method to fetch invoices with a more direct approach\nasync function fetchInvoicesDirectly() {\n    console.error(\"⭐ Starting direct invoice fetch with alternative method\");\n    try {\n        // First, verify we can get stored tokens\n        const tokens = getStoredToken();\n        if (!tokens || !tokens.accessToken || !tokens.realmId) {\n            console.error(\"⭐ No valid tokens for direct invoice fetch\");\n            throw new Error(\"QuickBooks authentication required. Please connect your account.\");\n        }\n        // We'll set up a fresh OAuthClient instance specifically for this request\n        const oauthClientForRequest = new (intuit_oauth__WEBPACK_IMPORTED_MODULE_0___default())({\n            clientId: process.env.QUICKBOOKS_CLIENT_ID,\n            clientSecret: process.env.QUICKBOOKS_CLIENT_SECRET,\n            environment: \"sandbox\",\n            redirectUri: getRedirectUri(),\n            logging: true\n        });\n        // Set the tokens on the client\n        oauthClientForRequest.setToken({\n            realmId: tokens.realmId,\n            token_type: \"bearer\",\n            access_token: tokens.accessToken,\n            refresh_token: tokens.refreshToken || \"\",\n            expires_in: tokens.tokenExpiry ? Math.floor((tokens.tokenExpiry - Date.now()) / 1000) : 3600\n        });\n        console.error(\"⭐ Attempting direct invoice API call\");\n        // Make a direct API call (not using node-quickbooks)\n        return new Promise((resolve, reject)=>{\n            try {\n                const url = `https://sandbox-quickbooks.api.intuit.com/v3/company/${tokens.realmId}/query`;\n                const headers = {\n                    \"Authorization\": `Bearer ${tokens.accessToken}`,\n                    \"Accept\": \"application/json\",\n                    \"Content-Type\": \"application/text\"\n                };\n                // Use a simpler query to minimize possible format issues\n                const query = \"SELECT * FROM Invoice\";\n                // Make the API call\n                oauthClientForRequest.makeApiCall({\n                    url: url,\n                    method: \"POST\",\n                    headers: headers,\n                    body: query\n                }, (err, response)=>{\n                    if (err) {\n                        console.error(\"⭐ Direct API call error:\", err);\n                        return reject(err);\n                    }\n                    try {\n                        // Log the entire response for debugging\n                        console.error(\"⭐ Direct API call response:\", response);\n                        if (typeof response === \"string\") {\n                            response = JSON.parse(response);\n                        }\n                        // Extract invoices data\n                        if (response && response.QueryResponse && Array.isArray(response.QueryResponse.Invoice)) {\n                            console.error(`⭐ Successfully found ${response.QueryResponse.Invoice.length} invoices directly`);\n                            return resolve(response.QueryResponse.Invoice);\n                        } else {\n                            // If the response doesn't match expected format, try to extract useful data\n                            console.error(\"⭐ Unexpected response format:\", response);\n                            // If there's any data that can be used, return it\n                            if (response && typeof response === \"object\") {\n                                if (Array.isArray(response)) {\n                                    return resolve(response);\n                                } else if (response.QueryResponse) {\n                                    return resolve([\n                                        response.QueryResponse\n                                    ]);\n                                }\n                            }\n                            return reject(new Error(\"Invalid response format from QuickBooks API\"));\n                        }\n                    } catch (parseError) {\n                        console.error(\"⭐ Error parsing direct API response:\", parseError);\n                        return reject(parseError);\n                    }\n                });\n            } catch (apiError) {\n                console.error(\"⭐ Error making direct API call:\", apiError);\n                return reject(apiError);\n            }\n        });\n    } catch (error) {\n        console.error(\"⭐ Top-level error in direct invoice fetch:\", error);\n        throw error;\n    }\n}\n// Ultra minimal API call for QuickBooks invoices (third approach)\nasync function fetchInvoicesMicroMethod() {\n    console.error(\"⭐ Starting MICRO invoice fetch with bare minimum approach\");\n    try {\n        // Get tokens directly from memory store first for speed\n        const tokens = tokenStore.accessToken && tokenStore.realmId ? {\n            accessToken: tokenStore.accessToken,\n            realmId: tokenStore.realmId\n        } : getStoredToken();\n        if (!tokens || !tokens.accessToken || !tokens.realmId) {\n            console.error(\"⭐ No valid tokens for micro invoice fetch\");\n            throw new Error(\"Authentication required\");\n        }\n        console.error(\"⭐ Micro method: Using minimal axios-like fetch with bare API call\");\n        // Create a promise with a short timeout\n        return new Promise((resolve, reject)=>{\n            // Create a timeout that's much shorter (15 seconds)\n            const timeoutId = setTimeout(()=>{\n                console.error(\"⭐ Micro method: Request timed out after 15 seconds\");\n                reject(new Error(\"Micro method request timed out after 15 seconds\"));\n            }, 15000);\n            try {\n                // Using the fetch API directly instead of the OAuthClient or node-quickbooks\n                const url = `https://sandbox-quickbooks.api.intuit.com/v3/company/${tokens.realmId}/query?query=select%20%2A%20from%20Invoice%20MAXRESULTS%205`;\n                console.error(\"⭐ Micro method: Calling API directly at URL:\", url);\n                fetch(url, {\n                    method: \"GET\",\n                    headers: {\n                        \"Authorization\": `Bearer ${tokens.accessToken}`,\n                        \"Accept\": \"application/json\",\n                        \"Content-Type\": \"application/json\"\n                    }\n                }).then((response)=>{\n                    console.error(\"⭐ Micro method: Received response with status:\", response.status);\n                    if (!response.ok) {\n                        throw new Error(`API responded with status: ${response.status}`);\n                    }\n                    return response.json();\n                }).then((data)=>{\n                    console.error(\"⭐ Micro method: Successfully parsed response JSON\");\n                    clearTimeout(timeoutId);\n                    // Extract invoice data from response\n                    if (data && data.QueryResponse && Array.isArray(data.QueryResponse.Invoice)) {\n                        console.error(`⭐ Micro method: Found ${data.QueryResponse.Invoice.length} invoices`);\n                        resolve(data.QueryResponse.Invoice);\n                    } else {\n                        console.error(\"⭐ Micro method: Response does not contain invoice array:\", data);\n                        // If we at least got data but not in the expected format, return an empty array\n                        // rather than failing - this helps the UI handle the case better\n                        resolve([]);\n                    }\n                }).catch((error)=>{\n                    console.error(\"⭐ Micro method: Fetch error:\", error);\n                    clearTimeout(timeoutId);\n                    reject(error);\n                });\n            } catch (error) {\n                console.error(\"⭐ Micro method: Exception during fetch setup:\", error);\n                clearTimeout(timeoutId);\n                reject(error);\n            }\n        });\n    } catch (error) {\n        console.error(\"⭐ Micro method: Top-level error:\", error);\n        throw error;\n    }\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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QXFDO29CQUNyQyxJQUFJaEYsUUFBUUEsS0FBS1ksYUFBYSxJQUFJQyxNQUFNQyxPQUFPLENBQUNkLEtBQUtZLGFBQWEsQ0FBQ0csT0FBTyxHQUFHO3dCQUMzRWpKLFFBQVFvQyxLQUFLLENBQUMsQ0FBQyxzQkFBc0IsRUFBRThGLEtBQUtZLGFBQWEsQ0FBQ0csT0FBTyxDQUFDRSxNQUFNLENBQUMsU0FBUyxDQUFDO3dCQUNuRnJCLFFBQVFJLEtBQUtZLGFBQWEsQ0FBQ0csT0FBTztvQkFDcEMsT0FBTzt3QkFDTGpKLFFBQVFvQyxLQUFLLENBQUMsNERBQTREOEY7d0JBQzFFLGdGQUFnRjt3QkFDaEYsaUVBQWlFO3dCQUNqRUosUUFBUSxFQUFFO29CQUNaO2dCQUNGLEdBQ0MyRixLQUFLLENBQUNyTCxDQUFBQTtvQkFDTHBDLFFBQVFvQyxLQUFLLENBQUMsZ0NBQWdDQTtvQkFDOUNvTCxhQUFhTjtvQkFDYm5GLE9BQU8zRjtnQkFDVDtZQUNGLEVBQUUsT0FBT0EsT0FBTztnQkFDZHBDLFFBQVFvQyxLQUFLLENBQUMsaURBQWlEQTtnQkFDL0RvTCxhQUFhTjtnQkFDYm5GLE9BQU8zRjtZQUNUO1FBQ0Y7SUFDRixFQUFFLE9BQU9BLE9BQU87UUFDZHBDLFFBQVFvQyxLQUFLLENBQUMsb0NBQW9DQTtRQUNsRCxNQUFNQTtJQUNSO0FBQ0YiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9pbnZvaWNlLWFwcC8uL3NyYy9saWIvcXVpY2tib29rcy9hcGkudHM/MmNhOCJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBJbnZvaWNlIH0gZnJvbSAnQC90eXBlcy9pbnZvaWNlJ1xuaW1wb3J0IE9BdXRoQ2xpZW50IGZyb20gJ2ludHVpdC1vYXV0aCdcbmltcG9ydCBRdWlja0Jvb2tzIGZyb20gJ25vZGUtcXVpY2tib29rcydcblxuLy8gRmlyc3QsIGxldCdzIHZlcmlmeSBRdWlja0Jvb2tzIGNvbnN0cnVjdG9yIGlzIGF2YWlsYWJsZVxuY29uc29sZS5sb2coJ1F1aWNrQm9va3MgY29uc3RydWN0b3IgY2hlY2s6Jywge1xuICBjb25zdHJ1Y3RvclR5cGU6IHR5cGVvZiBRdWlja0Jvb2tzLFxuICBpc0Z1bmN0aW9uOiB0eXBlb2YgUXVpY2tCb29rcyA9PT0gJ2Z1bmN0aW9uJ1xufSk7XG5cbi8vIFRva2VuIHN0b3JhZ2Uga2V5c1xuZXhwb3J0IGNvbnN0IFRPS0VOX0tFWSA9ICdxYl90b2tlbidcbmV4cG9ydCBjb25zdCBSRUFMTV9JRF9LRVkgPSAncWJfcmVhbG1faWQnXG5leHBvcnQgY29uc3QgUkVGUkVTSF9UT0tFTl9LRVkgPSAncWJfcmVmcmVzaF90b2tlbidcbmV4cG9ydCBjb25zdCBUT0tFTl9FWFBJUllfS0VZID0gJ3FiX3Rva2VuX2V4cGlyeSdcblxuLy8gRGVidWcgZmxhZ1xuY29uc3QgREVCVUcgPSB0cnVlO1xuXG4vLyBIZWxwZXIgZnVuY3Rpb24gdG8gbG9nIGRlYnVnIGluZm9ybWF0aW9uXG5jb25zdCBkZWJ1Z0xvZyA9ICguLi5hcmdzOiBhbnlbXSkgPT4ge1xuICBpZiAoREVCVUcpIHtcbiAgICBjb25zb2xlLmxvZygnW1F1aWNrQm9va3MgQVBJIERlYnVnXScsIC4uLmFyZ3MpO1xuICB9XG59O1xuXG4vLyBFbnN1cmUgd2UgaGF2ZSBhIHByb3Blcmx5IGZvcm1hdHRlZCBiYXNlIFVSTCB3aXRoIHByb3RvY29sXG5jb25zdCBnZXRCYXNlVXJsID0gKCkgPT4geyBcbiAgY29uc3QgYmFzZVVybCA9IHByb2Nlc3MuZW52Lk5FWFRfUFVCTElDX0JBU0VfVVJMIHx8ICdodHRwOi8vbG9jYWxob3N0OjMwMDAnO1xuICBcbiAgLy8gTWFrZSBzdXJlIFVSTCBoYXMgYSBwcm90b2NvbFxuICBpZiAoIWJhc2VVcmwuc3RhcnRzV2l0aCgnaHR0cDovLycpICYmICFiYXNlVXJsLnN0YXJ0c1dpdGgoJ2h0dHBzOi8vJykpIHtcbiAgICByZXR1cm4gYGh0dHA6Ly8ke2Jhc2VVcmx9YDtcbiAgfVxuICBcbiAgLy8gUmVtb3ZlIHRyYWlsaW5nIHNsYXNoIGlmIHByZXNlbnRcbiAgcmV0dXJuIGJhc2VVcmwucmVwbGFjZSgvXFwvJC8sICcnKTtcbn07XG5cbmNvbnN0IGdldFJlZGlyZWN0VXJpID0gKCkgPT4ge1xuICBjb25zdCBiYXNlVXJsID0gZ2V0QmFzZVVybCgpO1xuICByZXR1cm4gYCR7YmFzZVVybH0vYXBpL2F1dGgvY2FsbGJhY2tgO1xufTtcblxuLy8gSW5pdGlhbGl6ZSBPQXV0aCBjbGllbnQgLSB1c2UgY3JlYXRlT0F1dGhDbGllbnQgZnVuY3Rpb24gY29uc2lzdGVudGx5XG5sZXQgb2F1dGhDbGllbnQ6IGFueTtcblxubGV0IHFibzogUXVpY2tCb29rcyB8IG51bGwgPSBudWxsXG5leHBvcnQgeyBxYm8gfTtcblxuLy8gU2VydmVyLXNpZGUgaW4tbWVtb3J5IHRva2VuIHN0b3JlXG4vLyBOT1RFOiBUaGlzIHdpbGwgYmUgcmVzZXQgb24gc2VydmVyIHJlc3RhcnRzIGFuZCBiZXR3ZWVuIHNlcnZlcmxlc3MgZnVuY3Rpb24gaW52b2NhdGlvbnNcbmV4cG9ydCBsZXQgdG9rZW5TdG9yZToge1xuICBhY2Nlc3NUb2tlbj86IHN0cmluZztcbiAgcmVhbG1JZD86IHN0cmluZztcbiAgcmVmcmVzaFRva2VuPzogc3RyaW5nO1xuICB0b2tlbkV4cGlyeT86IG51bWJlcjtcbn0gPSB7fTtcblxuLy8gS2VlcCB0cmFjayBvZiBpbml0aWFsaXphdGlvbiBzdGF0dXNcbmxldCBpc0luaXRpYWxpemVkID0gZmFsc2U7XG5cbi8vIFN0b3JlIHRva2VuIGJvdGggaW4gbWVtb3J5IGFuZCBpbiBsb2NhbFN0b3JhZ2UgKGlmIGF2YWlsYWJsZSlcbmNvbnN0IHN0b3JlVG9rZW4gPSAoYWNjZXNzVG9rZW46IHN0cmluZywgcmVhbG1JZDogc3RyaW5nLCByZWZyZXNoVG9rZW4/OiBzdHJpbmcsIGV4cGlyZXNJbj86IG51bWJlcikgPT4ge1xuICB0cnkge1xuICAgIGRlYnVnTG9nKCdTdG9yaW5nIHRva2VuJyk7XG4gICAgXG4gICAgLy8gU3RvcmUgdG9rZW4gaW4gbWVtb3J5IGZvciBzZXJ2ZXItc2lkZSB1c2VcbiAgICB0b2tlblN0b3JlLmFjY2Vzc1Rva2VuID0gYWNjZXNzVG9rZW47XG4gICAgdG9rZW5TdG9yZS5yZWFsbUlkID0gcmVhbG1JZDtcbiAgICBcbiAgICBpZiAocmVmcmVzaFRva2VuKSB7XG4gICAgICB0b2tlblN0b3JlLnJlZnJlc2hUb2tlbiA9IHJlZnJlc2hUb2tlbjtcbiAgICB9XG4gICAgXG4gICAgaWYgKGV4cGlyZXNJbikge1xuICAgICAgY29uc3QgZXhwaXJ5VGltZSA9IERhdGUubm93KCkgKyAoZXhwaXJlc0luICogMTAwMCk7XG4gICAgICB0b2tlblN0b3JlLnRva2VuRXhwaXJ5ID0gZXhwaXJ5VGltZTtcbiAgICB9XG4gICAgXG4gICAgLy8gVHJ5IHRvIHN0b3JlIGluIGxvY2FsU3RvcmFnZSBmb3IgcGVyc2lzdGVuY2UgaWYgd2UncmUgaW4gYnJvd3NlclxuICAgIGlmICh0eXBlb2Ygd2luZG93ICE9PSAndW5kZWZpbmVkJykge1xuICAgICAgdHJ5IHtcbiAgICAgIGxvY2FsU3RvcmFnZS5zZXRJdGVtKFRPS0VOX0tFWSwgYWNjZXNzVG9rZW4pO1xuICAgICAgbG9jYWxTdG9yYWdlLnNldEl0ZW0oUkVBTE1fSURfS0VZLCByZWFsbUlkKTtcbiAgICAgIFxuICAgICAgaWYgKHJlZnJlc2hUb2tlbikge1xuICAgICAgICBsb2NhbFN0b3JhZ2Uuc2V0SXRlbShSRUZSRVNIX1RPS0VOX0tFWSwgcmVmcmVzaFRva2VuKTtcbiAgICAgIH1cbiAgICAgIFxuICAgICAgaWYgKGV4cGlyZXNJbikge1xuICAgICAgICAgIGNvbnN0IGV4cGlyeVRpbWUgPSBEYXRlLm5vdygpICsgKGV4cGlyZXNJbiAqIDEwMDApO1xuICAgICAgICAgIGxvY2FsU3RvcmFnZS5zZXRJdGVtKFRPS0VOX0VYUElSWV9LRVksIGV4cGlyeVRpbWUudG9TdHJpbmcoKSk7XG4gICAgICAgIH1cbiAgICAgIH0gY2F0Y2ggKGxvY2FsU3RvcmFnZUVycm9yKSB7XG4gICAgICAgIGNvbnNvbGUuZXJyb3IoJ0ZhaWxlZCB0byBzdG9yZSB0b2tlbiBpbiBsb2NhbFN0b3JhZ2U6JywgbG9jYWxTdG9yYWdlRXJyb3IpO1xuICAgICAgfVxuICAgIH1cbiAgICBcbiAgICBkZWJ1Z0xvZygnVG9rZW4gc3RvcmVkIHN1Y2Nlc3NmdWxseScpO1xuICAgIHJldHVybiB0cnVlO1xuICB9IGNhdGNoIChlcnJvcikge1xuICAgIGNvbnNvbGUuZXJyb3IoJ0ZhaWxlZCB0byBzdG9yZSB0b2tlbjonLCBlcnJvcik7XG4gICAgcmV0dXJuIGZhbHNlO1xuICB9XG59O1xuXG4vLyBSZXRyaWV2ZSB0b2tlbiBmcm9tIG1lbW9yeSBvciBsb2NhbFN0b3JhZ2VcbmNvbnN0IGdldFN0b3JlZFRva2VuID0gKCkgPT4ge1xuICB0cnkge1xuICAgIGRlYnVnTG9nKCdSZXRyaWV2aW5nIHN0b3JlZCB0b2tlbicpO1xuICAgIFxuICAgIC8vIEZpcnN0IHRyeSBtZW1vcnkgc3RvcmUgZm9yIHNlcnZlci1zaWRlXG4gICAgaWYgKHRva2VuU3RvcmUuYWNjZXNzVG9rZW4gJiYgdG9rZW5TdG9yZS5yZWFsbUlkKSB7XG4gICAgICBkZWJ1Z0xvZygnVG9rZW4gZm91bmQgaW4gbWVtb3J5Jyk7XG4gICAgICByZXR1cm4geyBcbiAgICAgICAgYWNjZXNzVG9rZW46IHRva2VuU3RvcmUuYWNjZXNzVG9rZW4sIFxuICAgICAgICByZWFsbUlkOiB0b2tlblN0b3JlLnJlYWxtSWQsXG4gICAgICAgIHJlZnJlc2hUb2tlbjogdG9rZW5TdG9yZS5yZWZyZXNoVG9rZW4sXG4gICAgICAgIHRva2VuRXhwaXJ5OiB0b2tlblN0b3JlLnRva2VuRXhwaXJ5XG4gICAgICB9O1xuICAgIH1cbiAgICBcbiAgICAvLyBJZiBub3QgaW4gbWVtb3J5LCB0cnkgbG9jYWxTdG9yYWdlIGlmIHdlJ3JlIGluIGJyb3dzZXJcbiAgICBpZiAodHlwZW9mIHdpbmRvdyAhPT0gJ3VuZGVmaW5lZCcpIHtcbiAgICAgIGNvbnN0IGFjY2Vzc1Rva2VuID0gbG9jYWxTdG9yYWdlLmdldEl0ZW0oVE9LRU5fS0VZKTtcbiAgICAgIGNvbnN0IHJlYWxtSWQgPSBsb2NhbFN0b3JhZ2UuZ2V0SXRlbShSRUFMTV9JRF9LRVkpO1xuICAgICAgY29uc3QgcmVmcmVzaFRva2VuID0gbG9jYWxTdG9yYWdlLmdldEl0ZW0oUkVGUkVTSF9UT0tFTl9LRVkpO1xuICAgICAgY29uc3QgdG9rZW5FeHBpcnlTdHIgPSBsb2NhbFN0b3JhZ2UuZ2V0SXRlbShUT0tFTl9FWFBJUllfS0VZKTtcbiAgICAgIFxuICAgICAgaWYgKGFjY2Vzc1Rva2VuICYmIHJlYWxtSWQpIHtcbiAgICAgICAgZGVidWdMb2coJ1Rva2VuIGZvdW5kIGluIGxvY2FsU3RvcmFnZScpO1xuICAgICAgICBcbiAgICAgICAgLy8gQWxzbyB1cGRhdGUgbWVtb3J5IHN0b3JlIGZvciBmdXR1cmUgdXNlXG4gICAgICAgIHRva2VuU3RvcmUuYWNjZXNzVG9rZW4gPSBhY2Nlc3NUb2tlbjtcbiAgICAgICAgdG9rZW5TdG9yZS5yZWFsbUlkID0gcmVhbG1JZDtcbiAgICAgICAgXG4gICAgICAgIGlmIChyZWZyZXNoVG9rZW4pIHtcbiAgICAgICAgICB0b2tlblN0b3JlLnJlZnJlc2hUb2tlbiA9IHJlZnJlc2hUb2tlbjtcbiAgICAgICAgfVxuICAgICAgICBcbiAgICAgICAgaWYgKHRva2VuRXhwaXJ5U3RyKSB7XG4gICAgICAgICAgdG9rZW5TdG9yZS50b2tlbkV4cGlyeSA9IHBhcnNlSW50KHRva2VuRXhwaXJ5U3RyLCAxMCk7XG4gICAgICAgIH1cbiAgICAgICAgXG4gICAgICAgIHJldHVybiB7IFxuICAgICAgICAgIGFjY2Vzc1Rva2VuLCBcbiAgICAgICAgICByZWFsbUlkLFxuICAgICAgICAgIHJlZnJlc2hUb2tlbjogcmVmcmVzaFRva2VuIHx8IHVuZGVmaW5lZCxcbiAgICAgICAgICB0b2tlbkV4cGlyeTogdG9rZW5FeHBpcnlTdHIgPyBwYXJzZUludCh0b2tlbkV4cGlyeVN0ciwgMTApIDogdW5kZWZpbmVkXG4gICAgICAgIH07XG4gICAgICB9XG4gICAgfVxuICAgIFxuICAgIGRlYnVnTG9nKCdObyB0b2tlbiBmb3VuZCcpO1xuICAgIHJldHVybiBudWxsO1xuICB9IGNhdGNoIChlcnJvcikge1xuICAgIGNvbnNvbGUuZXJyb3IoJ0ZhaWxlZCB0byBnZXQgc3RvcmVkIHRva2VuOicsIGVycm9yKTtcbiAgICByZXR1cm4gbnVsbDtcbiAgfVxufTtcblxuLy8gQ2xlYXIgYWxsIHN0b3JlZCB0b2tlbnNcbmNvbnN0IGNsZWFyVG9rZW5zID0gKCkgPT4ge1xuICBkZWJ1Z0xvZygnQ2xlYXJpbmcgYWxsIHRva2VucycpO1xuICBcbiAgLy8gQ2xlYXIgbWVtb3J5IHN0b3JlXG4gIHRva2VuU3RvcmUgPSB7fTtcbiAgaXNJbml0aWFsaXplZCA9IGZhbHNlO1xuICBxYm8gPSBudWxsO1xuICBcbiAgLy8gQ2xlYXIgbG9jYWxTdG9yYWdlIGlmIGluIGJyb3dzZXJcbiAgaWYgKHR5cGVvZiB3aW5kb3cgIT09ICd1bmRlZmluZWQnKSB7XG4gICAgdHJ5IHtcbiAgICBsb2NhbFN0b3JhZ2UucmVtb3ZlSXRlbShUT0tFTl9LRVkpO1xuICAgIGxvY2FsU3RvcmFnZS5yZW1vdmVJdGVtKFJFQUxNX0lEX0tFWSk7XG4gICAgbG9jYWxTdG9yYWdlLnJlbW92ZUl0ZW0oUkVGUkVTSF9UT0tFTl9LRVkpO1xuICAgIGxvY2FsU3RvcmFnZS5yZW1vdmVJdGVtKFRPS0VOX0VYUElSWV9LRVkpO1xuICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICBjb25zb2xlLmVycm9yKCdGYWlsZWQgdG8gY2xlYXIgbG9jYWxTdG9yYWdlOicsIGVycm9yKTtcbiAgICB9XG4gIH1cbn07XG5cbmV4cG9ydCBmdW5jdGlvbiBpbml0aWFsaXplUUJPKGFjY2Vzc1Rva2VuOiBzdHJpbmcsIHJlYWxtSWQ6IHN0cmluZywgcmVmcmVzaFRva2VuPzogc3RyaW5nLCBleHBpcmVzSW4/OiBudW1iZXIpOiBib29sZWFuIHtcbiAgdHJ5IHtcbiAgICBjb25zb2xlLmxvZygnQkFTSUMgUXVpY2tCb29rcyBjbGllbnQgaW5pdGlhbGl6YXRpb24nLCB7XG4gICAgICBhY2Nlc3NUb2tlblByZXNlbnQ6ICEhYWNjZXNzVG9rZW4sXG4gICAgICByZWFsbUlkUHJlc2VudDogISFyZWFsbUlkLFxuICAgICAgY2xpZW50SWRQcmVzZW50OiAhIXByb2Nlc3MuZW52LlFVSUNLQk9PS1NfQ0xJRU5UX0lELFxuICAgICAgY2xpZW50U2VjcmV0UHJlc2VudDogISFwcm9jZXNzLmVudi5RVUlDS0JPT0tTX0NMSUVOVF9TRUNSRVRcbiAgICB9KTtcbiAgICBcbiAgICAvLyBWYWxpZGF0ZSByZXF1aXJlbWVudHNcbiAgICBpZiAoIWFjY2Vzc1Rva2VuIHx8ICFyZWFsbUlkKSB7XG4gICAgICBjb25zb2xlLmVycm9yKCdFUlJPUjogTWlzc2luZyB0b2tlbiBvciByZWFsbUlkIGZvciBRdWlja0Jvb2tzIGluaXRpYWxpemF0aW9uJyk7XG4gICAgICByZXR1cm4gZmFsc2U7XG4gICAgfVxuICAgIFxuICAgIGNvbnN0IGNsaWVudElkID0gcHJvY2Vzcy5lbnYuUVVJQ0tCT09LU19DTElFTlRfSUQ7XG4gICAgY29uc3QgY2xpZW50U2VjcmV0ID0gcHJvY2Vzcy5lbnYuUVVJQ0tCT09LU19DTElFTlRfU0VDUkVUO1xuICAgIFxuICAgIGlmICghY2xpZW50SWQgfHwgIWNsaWVudFNlY3JldCkge1xuICAgICAgY29uc29sZS5lcnJvcignRVJST1I6IE1pc3NpbmcgUXVpY2tCb29rcyBjcmVkZW50aWFscycpO1xuICAgICAgcmV0dXJuIGZhbHNlO1xuICAgIH1cbiAgICBcbiAgICAvLyBTdG9yZSB0aGUgdG9rZW4gZmlyc3RcbiAgICBzdG9yZVRva2VuKGFjY2Vzc1Rva2VuLCByZWFsbUlkLCByZWZyZXNoVG9rZW4sIGV4cGlyZXNJbik7XG4gICAgXG4gICAgLy8gVUxUUkEgU0lNUExFIENMSUVOVCBDUkVBVElPTiAtIEZJUlNUIEFUVEVNUFRcbiAgICB0cnkge1xuICAgICAgY29uc29sZS5sb2coJ0NyZWF0aW5nIG1pbmltYWwgUXVpY2tCb29rcyBjbGllbnQgLSBhdHRlbXB0IDEnKTtcbiAgICAgIFxuICAgICAgLy8gQ3JlYXRlIHRoZSBjbGllbnQgd2l0aCBhYnNvbHV0ZSBtaW5pbWFsIHBhcmFtZXRlcnNcbiAgICBxYm8gPSBuZXcgUXVpY2tCb29rcyhcbiAgICAgICAgY2xpZW50SWQsXG4gICAgICAgIGNsaWVudFNlY3JldCxcbiAgICAgIGFjY2Vzc1Rva2VuLFxuICAgICAgICBmYWxzZSwgLy8gVXNlIE9BdXRoMS4wYSBpbnN0ZWFkIG9mIE9BdXRoMiBcbiAgICAgIHJlYWxtSWRcbiAgICApO1xuICAgIFxuICAgICAgaWYgKCFxYm8pIHtcbiAgICAgICAgY29uc29sZS5lcnJvcignUXVpY2tCb29rcyBjb25zdHJ1Y3RvciByZXR1cm5lZCBudWxsIC0gYXR0ZW1wdCAxJyk7XG4gICAgICAgIC8vIFdlJ2xsIHRyeSBmYWxsYmFjayBhcHByb2FjaCBiZWxvd1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgLy8gU2V0IHRoZXNlIGV4cGxpY2l0bHkgdG8gZW5zdXJlIHRoZXkncmUgYXZhaWxhYmxlXG4gICAgICAgIHFiby5hY2Nlc3NUb2tlbiA9IGFjY2Vzc1Rva2VuO1xuICAgICAgICBxYm8ucmVhbG1JZCA9IHJlYWxtSWQ7XG4gICAgICAgIFxuICAgICAgICBjb25zb2xlLmxvZygnUXVpY2tCb29rcyBjbGllbnQgY3JlYXRlZCB3aXRoIGJhc2ljIHByb3BlcnRpZXM6Jywge1xuICAgICAgICAgIGhhc1FibzogISFxYm8sXG4gICAgICAgICAgaGFzVG9rZW46ICEhKHFibyAmJiBxYm8uYWNjZXNzVG9rZW4pLFxuICAgICAgICAgIGhhc1JlYWxtSWQ6ICEhKHFibyAmJiBxYm8ucmVhbG1JZCksXG4gICAgICAgIH0pO1xuICAgICAgICBcbiAgICAgICAgLy8gU2V0IGluaXRpYWxpemF0aW9uIGZsYWdcbiAgICAgICAgaXNJbml0aWFsaXplZCA9IHRydWU7XG4gICAgICAgIGNvbnNvbGUubG9nKCdRdWlja0Jvb2tzIGNsaWVudCBpbml0aWFsaXplZCBzdWNjZXNzZnVsbHkgLSBhdHRlbXB0IDEnKTtcbiAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICB9XG4gICAgfVxuICAgIGNhdGNoIChjbGllbnRFcnJvcikge1xuICAgICAgY29uc29sZS5lcnJvcignRVJST1IgY3JlYXRpbmcgUXVpY2tCb29rcyBjbGllbnQgaW5zdGFuY2UgLSBhdHRlbXB0IDE6JywgY2xpZW50RXJyb3IpO1xuICAgICAgLy8gV2UnbGwgdHJ5IGZhbGxiYWNrIGFwcHJvYWNoIGJlbG93XG4gICAgfVxuICAgIFxuICAgIC8vIEZBTExCQUNLIEFQUFJPQUNIIC0gQVRURU1QVCAyXG4gICAgdHJ5IHtcbiAgICAgIGNvbnNvbGUubG9nKCdDcmVhdGluZyBmYWxsYmFjayBRdWlja0Jvb2tzIGNsaWVudCAtIGF0dGVtcHQgMicpO1xuICAgICAgXG4gICAgICAvLyBUcnkgd2l0aCBkaWZmZXJlbnQgcGFyYW1ldGVycyAtIHNvbWUgdmVyc2lvbnMgbmVlZCB1c2VTYW5kYm94IHBhcmFtZXRlclxuICAgICAgcWJvID0gbmV3IFF1aWNrQm9va3MoXG4gICAgICAgIGNsaWVudElkLFxuICAgICAgICBjbGllbnRTZWNyZXQsXG4gICAgICAgIGFjY2Vzc1Rva2VuLFxuICAgICAgICB0cnVlLCAvLyBUcnkgd2l0aCBPQXV0aDIgbW9kZSBcbiAgICAgICAgcmVhbG1JZCxcbiAgICAgICAge1xuICAgICAgICAgIHVzZVNhbmRib3g6IHRydWVcbiAgICAgICAgfVxuICAgICAgKTtcbiAgICAgIFxuICAgICAgaWYgKCFxYm8pIHtcbiAgICAgICAgY29uc29sZS5lcnJvcignUXVpY2tCb29rcyBjb25zdHJ1Y3RvciByZXR1cm5lZCBudWxsIC0gYXR0ZW1wdCAyJyk7XG4gICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgIH1cbiAgICAgIFxuICAgICAgLy8gU2V0IHRoZXNlIGV4cGxpY2l0bHkgdG8gZW5zdXJlIHRoZXkncmUgYXZhaWxhYmxlXG4gICAgICBxYm8uYWNjZXNzVG9rZW4gPSBhY2Nlc3NUb2tlbjtcbiAgICAgIHFiby5yZWFsbUlkID0gcmVhbG1JZDtcbiAgICAgIFxuICAgICAgY29uc29sZS5sb2coJ1F1aWNrQm9va3MgY2xpZW50IGNyZWF0ZWQgd2l0aCBmYWxsYmFjayBhcHByb2FjaCcpO1xuICAgICAgXG4gICAgICAvLyBTZXQgaW5pdGlhbGl6YXRpb24gZmxhZ1xuICAgIGlzSW5pdGlhbGl6ZWQgPSB0cnVlO1xuICAgICAgY29uc29sZS5sb2coJ1F1aWNrQm9va3MgY2xpZW50IGluaXRpYWxpemVkIHN1Y2Nlc3NmdWxseSAtIGF0dGVtcHQgMicpO1xuICAgIHJldHVybiB0cnVlO1xuICAgIH1cbiAgICBjYXRjaCAoZmFsbGJhY2tFcnJvcikge1xuICAgICAgY29uc29sZS5lcnJvcignRVJST1IgY3JlYXRpbmcgUXVpY2tCb29rcyBjbGllbnQgd2l0aCBmYWxsYmFjayBhcHByb2FjaDonLCBmYWxsYmFja0Vycm9yKTtcbiAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9XG4gIH1cbiAgY2F0Y2ggKGVycm9yKSB7XG4gICAgY29uc29sZS5lcnJvcignRkFUQUwgRVJST1IgaW4gUXVpY2tCb29rcyBpbml0aWFsaXphdGlvbjonLCBlcnJvcik7XG4gICAgcmV0dXJuIGZhbHNlO1xuICB9XG59XG5cbi8vIENoZWNrIGlmIGNsaWVudCBpcyBpbml0aWFsaXplZCBvciB0cnkgdG8gaW5pdGlhbGl6ZSBmcm9tIHN0b3JlZCB0b2tlblxuZXhwb3J0IGNvbnN0IGNoZWNrQ2xpZW50SW5pdGlhbGl6ZWQgPSAoKSA9PiB7XG4gIGNvbnNvbGUubG9nKCdDaGVja2luZyBpZiBRdWlja0Jvb2tzIGNsaWVudCBpcyBpbml0aWFsaXplZCcpO1xuICBcbiAgdHJ5IHtcbiAgICAvLyBJZiBhbHJlYWR5IGluaXRpYWxpemVkIGluIHRoaXMgc2Vzc2lvbiwgdmVyaWZ5IHRoZSBjbGllbnQgaXMgc3RpbGwgdmFsaWRcbiAgICBpZiAocWJvICYmIGlzSW5pdGlhbGl6ZWQpIHtcbiAgICAgIGNvbnNvbGUubG9nKCdRdWlja0Jvb2tzIGNsaWVudCBhcHBlYXJzIHRvIGJlIGluaXRpYWxpemVkLCB2YWxpZGF0aW5nLi4uJyk7XG4gICAgICBcbiAgICAgIC8vIFZlcmlmeSB0aGUgY2xpZW50IGhhcyBhbGwgcmVxdWlyZWQgcHJvcGVydGllc1xuICAgICAgaWYgKCFxYm8uYWNjZXNzVG9rZW4gfHwgIXFiby5yZWFsbUlkKSB7XG4gICAgICAgIGNvbnNvbGUubG9nKCdDbGllbnQgaXMgbWlzc2luZyByZXF1aXJlZCBwcm9wZXJ0aWVzLCB3aWxsIGF0dGVtcHQgdG8gcmVpbml0aWFsaXplJyk7XG4gICAgICAgIGlzSW5pdGlhbGl6ZWQgPSBmYWxzZTtcbiAgICAgICAgcWJvID0gbnVsbDtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIGNvbnNvbGUubG9nKCdDbGllbnQgYXBwZWFycyB2YWxpZCB3aXRoIHJlcXVpcmVkIHByb3BlcnRpZXMnKTtcbiAgICAgIHJldHVybiB0cnVlO1xuICAgICAgfVxuICAgIH0gZWxzZSB7XG4gICAgICBjb25zb2xlLmxvZygnUXVpY2tCb29rcyBjbGllbnQgaXMgbm90IGluaXRpYWxpemVkLCB3aWxsIGF0dGVtcHQgdG8gaW5pdGlhbGl6ZSBmcm9tIHN0b3JlZCB0b2tlbicpO1xuICAgIH1cbiAgICBcbiAgICAvLyBUcnkgdG8gcmV0cmlldmUgdG9rZW4gLSBJTVBPUlRBTlQ6IENoZWNrIGJvdGggc2VydmVyLXNpZGUgdG9rZW5TdG9yZSBhbmQgY29va2llc1xuICAgIGNvbnNvbGUubG9nKCdBdHRlbXB0aW5nIHRvIHJldHJpZXZlIHN0b3JlZCB0b2tlbicpO1xuICAgIGNvbnN0IHN0b3JlZFRva2VuID0gZ2V0U2VydmVyU2lkZVRva2VuKCk7XG4gICAgXG4gICAgaWYgKCFzdG9yZWRUb2tlbiB8fCAhc3RvcmVkVG9rZW4uYWNjZXNzVG9rZW4gfHwgIXN0b3JlZFRva2VuLnJlYWxtSWQpIHtcbiAgICAgIGNvbnNvbGUubG9nKCdObyB2YWxpZCBzdG9yZWQgdG9rZW4gZm91bmQnKTtcbiAgICAgIHRocm93IG5ldyBFcnJvcignUXVpY2tCb29rcyBjbGllbnQgbm90IGluaXRpYWxpemVkLiBQbGVhc2UgY29ubmVjdCB5b3VyIFF1aWNrQm9va3MgYWNjb3VudCBmaXJzdC4nKTtcbiAgICB9XG4gICAgXG4gICAgY29uc29sZS5sb2coJ0ZvdW5kIHN0b3JlZCB0b2tlbiwgaW5pdGlhbGl6aW5nIFF1aWNrQm9va3MgY2xpZW50IHdpdGg6Jywge1xuICAgICAgaGFzQWNjZXNzVG9rZW46ICEhc3RvcmVkVG9rZW4uYWNjZXNzVG9rZW4sXG4gICAgICBoYXNSZWFsbUlkOiAhIXN0b3JlZFRva2VuLnJlYWxtSWQsXG4gICAgICBoYXNSZWZyZXNoVG9rZW46ICEhc3RvcmVkVG9rZW4ucmVmcmVzaFRva2VuLFxuICAgIH0pO1xuICAgIFxuICAgIC8vIEluaXRpYWxpemUgd2l0aCBjdXJyZW50IHRva2VuXG4gICAgY29uc3QgaW5pdFJlc3VsdCA9IGluaXRpYWxpemVRQk8oXG4gICAgICBzdG9yZWRUb2tlbi5hY2Nlc3NUb2tlbiwgXG4gICAgICBzdG9yZWRUb2tlbi5yZWFsbUlkLFxuICAgICAgc3RvcmVkVG9rZW4ucmVmcmVzaFRva2VuLFxuICAgICAgc3RvcmVkVG9rZW4udG9rZW5FeHBpcnkgPyBNYXRoLmZsb29yKChzdG9yZWRUb2tlbi50b2tlbkV4cGlyeSAtIERhdGUubm93KCkpIC8gMTAwMCkgOiB1bmRlZmluZWRcbiAgICApO1xuICAgIFxuICAgIGlmICghaW5pdFJlc3VsdCkge1xuICAgICAgY29uc29sZS5lcnJvcignRmFpbGVkIHRvIGluaXRpYWxpemUgUXVpY2tCb29rcyBjbGllbnQgd2l0aCBzdG9yZWQgdG9rZW4nKTtcbiAgICAgIHRocm93IG5ldyBFcnJvcignRmFpbGVkIHRvIGluaXRpYWxpemUgUXVpY2tCb29rcyBjbGllbnQuIFBsZWFzZSByZWNvbm5lY3QgeW91ciBRdWlja0Jvb2tzIGFjY291bnQuJyk7XG4gICAgfVxuICAgIFxuICAgIGNvbnNvbGUubG9nKCdTdWNjZXNzZnVsbHkgaW5pdGlhbGl6ZWQgUXVpY2tCb29rcyBjbGllbnQgZnJvbSBzdG9yZWQgdG9rZW4nKTtcbiAgICByZXR1cm4gdHJ1ZTtcbiAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICBjb25zb2xlLmVycm9yKCdFcnJvciBpbiBjaGVja0NsaWVudEluaXRpYWxpemVkOicsIGVycm9yKTtcbiAgICB0aHJvdyBlcnJvcjtcbiAgfVxufTtcblxuLy8gRW5oYW5jZWQgZnVuY3Rpb24gdG8gZ2V0IHRva2VuIGZyb20gc2VydmVyLXNpZGUgc291cmNlcyAodG9rZW5TdG9yZSBhbmQgY29va2llcylcbmZ1bmN0aW9uIGdldFNlcnZlclNpZGVUb2tlbigpIHtcbiAgY29uc29sZS5sb2coJ0dldHRpbmcgc2VydmVyLXNpZGUgdG9rZW4nKTtcbiAgXG4gIHRyeSB7XG4gICAgLy8gRmlyc3QgY2hlY2sgbWVtb3J5IHN0b3JlXG4gICAgaWYgKHRva2VuU3RvcmUuYWNjZXNzVG9rZW4gJiYgdG9rZW5TdG9yZS5yZWFsbUlkKSB7XG4gICAgICBjb25zb2xlLmxvZygnVG9rZW4gZm91bmQgaW4gc2VydmVyIG1lbW9yeSBzdG9yZScpO1xuICAgICAgcmV0dXJuIHtcbiAgICAgICAgYWNjZXNzVG9rZW46IHRva2VuU3RvcmUuYWNjZXNzVG9rZW4sXG4gICAgICAgIHJlYWxtSWQ6IHRva2VuU3RvcmUucmVhbG1JZCxcbiAgICAgICAgcmVmcmVzaFRva2VuOiB0b2tlblN0b3JlLnJlZnJlc2hUb2tlbixcbiAgICAgICAgdG9rZW5FeHBpcnk6IHRva2VuU3RvcmUudG9rZW5FeHBpcnlcbiAgICAgIH07XG4gICAgfVxuXG4gICAgLy8gTmV4dCwgdHJ5IGxvY2FsU3RvcmFnZSBpZiB3ZSdyZSBpbiBhIGJyb3dzZXIgZW52aXJvbm1lbnRcbiAgICBpZiAodHlwZW9mIHdpbmRvdyAhPT0gJ3VuZGVmaW5lZCcpIHtcbiAgICAgIGNvbnN0IGFjY2Vzc1Rva2VuID0gbG9jYWxTdG9yYWdlLmdldEl0ZW0oVE9LRU5fS0VZKTtcbiAgICAgIGNvbnN0IHJlYWxtSWQgPSBsb2NhbFN0b3JhZ2UuZ2V0SXRlbShSRUFMTV9JRF9LRVkpO1xuICAgICAgXG4gICAgICBpZiAoYWNjZXNzVG9rZW4gJiYgcmVhbG1JZCkge1xuICAgICAgICBjb25zb2xlLmxvZygnVG9rZW4gZm91bmQgaW4gbG9jYWxTdG9yYWdlJyk7XG4gICAgICAgIFxuICAgICAgICBjb25zdCByZWZyZXNoVG9rZW4gPSBsb2NhbFN0b3JhZ2UuZ2V0SXRlbShSRUZSRVNIX1RPS0VOX0tFWSk7XG4gICAgICAgIGNvbnN0IHRva2VuRXhwaXJ5U3RyID0gbG9jYWxTdG9yYWdlLmdldEl0ZW0oVE9LRU5fRVhQSVJZX0tFWSk7XG4gICAgICAgIFxuICAgICAgICAvLyBVcGRhdGUgbWVtb3J5IHN0b3JlIGZvciBmdXR1cmUgdXNlXG4gICAgICAgIHRva2VuU3RvcmUuYWNjZXNzVG9rZW4gPSBhY2Nlc3NUb2tlbjtcbiAgICAgICAgdG9rZW5TdG9yZS5yZWFsbUlkID0gcmVhbG1JZDtcbiAgICAgICAgXG4gICAgICAgIGlmIChyZWZyZXNoVG9rZW4pIHtcbiAgICAgICAgICB0b2tlblN0b3JlLnJlZnJlc2hUb2tlbiA9IHJlZnJlc2hUb2tlbjtcbiAgICAgICAgfVxuICAgICAgICBcbiAgICAgICAgaWYgKHRva2VuRXhwaXJ5U3RyKSB7XG4gICAgICAgICAgdG9rZW5TdG9yZS50b2tlbkV4cGlyeSA9IHBhcnNlSW50KHRva2VuRXhwaXJ5U3RyLCAxMCk7XG4gICAgICAgIH1cbiAgICAgICAgXG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgYWNjZXNzVG9rZW4sXG4gICAgICAgICAgcmVhbG1JZCxcbiAgICAgICAgICByZWZyZXNoVG9rZW46IHJlZnJlc2hUb2tlbiB8fCB1bmRlZmluZWQsXG4gICAgICAgICAgdG9rZW5FeHBpcnk6IHRva2VuRXhwaXJ5U3RyID8gcGFyc2VJbnQodG9rZW5FeHBpcnlTdHIsIDEwKSA6IHVuZGVmaW5lZFxuICAgICAgICB9O1xuICAgICAgfVxuICAgIH1cbiAgICBcbiAgICAvLyBObyBkeW5hbWljIGltcG9ydHMgLSB0aGlzIGNhdXNlcyBpc3N1ZXMgaW4gTmV4dC5qc1xuICAgIC8vIFRoZSBjb29raWVzIHdpbGwgYmUgcGFzc2VkIGJ5IHRoZSBpbnZvaWNlcyBBUEkgcm91dGUgZGlyZWN0bHlcbiAgICBjb25zb2xlLmxvZygnTm8gc2VydmVyLXNpZGUgdG9rZW4gZm91bmQgaW4gbWVtb3J5IG9yIGxvY2FsU3RvcmFnZSwgY2hlY2sgY29va2llcyBpbiB0aGUgQVBJIHJvdXRlJyk7XG4gICAgcmV0dXJuIG51bGw7XG4gIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgY29uc29sZS5lcnJvcignRXJyb3IgZ2V0dGluZyBzZXJ2ZXItc2lkZSB0b2tlbjonLCBlcnJvcik7XG4gICAgcmV0dXJuIG51bGw7XG4gIH1cbn1cblxuLy8gRnVuY3Rpb24gdG8gY2hlY2sgaWYgUXVpY2tCb29rcyBpcyByZWFkeSBmb3IgY2xpZW50LXNpZGUgY29tcG9uZW50c1xuZXhwb3J0IGNvbnN0IGlzUXVpY2tCb29rc1JlYWR5ID0gKCk6IGJvb2xlYW4gPT4ge1xuICBpZiAodHlwZW9mIHdpbmRvdyAhPT0gJ3VuZGVmaW5lZCcpIHtcbiAgICBjb25zdCBhY2Nlc3NUb2tlbiA9IGxvY2FsU3RvcmFnZS5nZXRJdGVtKFRPS0VOX0tFWSk7XG4gICAgY29uc3QgcmVhbG1JZCA9IGxvY2FsU3RvcmFnZS5nZXRJdGVtKFJFQUxNX0lEX0tFWSk7XG4gICAgY29uc3QgdG9rZW5FeHBpcnlTdHIgPSBsb2NhbFN0b3JhZ2UuZ2V0SXRlbShUT0tFTl9FWFBJUllfS0VZKTtcbiAgICBcbiAgICAvLyBJZiB0b2tlbiBpcyBleHBpcmVkLCBjb25zaWRlciBub3QgcmVhZHlcbiAgICBpZiAodG9rZW5FeHBpcnlTdHIpIHtcbiAgICAgIGNvbnN0IHRva2VuRXhwaXJ5ID0gcGFyc2VJbnQodG9rZW5FeHBpcnlTdHIsIDEwKTtcbiAgICAgIGlmIChEYXRlLm5vdygpID4gdG9rZW5FeHBpcnkpIHtcbiAgICAgICAgZGVidWdMb2coJ0NsaWVudC1zaWRlIHRva2VuIGlzIGV4cGlyZWQnKTtcbiAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgfVxuICAgIH1cbiAgICBcbiAgICBjb25zdCBpc1JlYWR5ID0gISFhY2Nlc3NUb2tlbiAmJiAhIXJlYWxtSWQ7XG4gICAgZGVidWdMb2coJ0NsaWVudC1zaWRlIFF1aWNrQm9va3MgcmVhZHkgc3RhdGU6JywgaXNSZWFkeSk7XG4gICAgcmV0dXJuIGlzUmVhZHk7XG4gIH1cbiAgcmV0dXJuIGZhbHNlO1xufTtcblxuLy8gSGVscGVyIGZ1bmN0aW9uIHRvIG1hcCBRdWlja0Jvb2tzIGludm9pY2UgZm9ybWF0IHRvIG91ciBhcHAgZm9ybWF0XG5mdW5jdGlvbiBtYXBRdWlja0Jvb2tzSW52b2ljZShxYkludm9pY2U6IGFueSk6IEludm9pY2Uge1xuICB0cnkge1xuICAgIC8vIEV4dHJhY3QgY3VzdG9tZXIgaW5mbyBpZiBhdmFpbGFibGVcbiAgICBjb25zdCBjdXN0b21lck5hbWUgPSBxYkludm9pY2UuQ3VzdG9tZXJSZWY/Lm5hbWUgfHwgJ1Vua25vd24gQ3VzdG9tZXInO1xuICAgIFxuICAgIC8vIEV4dHJhY3QgbGluZSBpdGVtc1xuICAgIGNvbnN0IGxpbmVJdGVtcyA9IChxYkludm9pY2UuTGluZSB8fCBbXSkubWFwKChsaW5lOiBhbnkpID0+IHtcbiAgICAgIHJldHVybiB7XG4gICAgICAgIGlkOiBsaW5lLklkIHx8ICcnLFxuICAgICAgICBkZXNjcmlwdGlvbjogbGluZS5EZXNjcmlwdGlvbiB8fCAnJyxcbiAgICAgICAgYW1vdW50OiBsaW5lLkFtb3VudCB8fCAwLFxuICAgICAgICBxdWFudGl0eTogbGluZS5RdWFudGl0eSB8fCAxLFxuICAgICAgICB1bml0UHJpY2U6IGxpbmUuU2FsZXNJdGVtTGluZURldGFpbD8uVW5pdFByaWNlIHx8IDAsXG4gICAgICB9O1xuICAgIH0pO1xuICAgIFxuICAgIC8vIE1hcCB0byBvdXIgaW52b2ljZSBmb3JtYXRcbiAgcmV0dXJuIHtcbiAgICAgIGlkOiBxYkludm9pY2UuSWQgfHwgJycsXG4gICAgICBpbnZvaWNlTnVtYmVyOiBxYkludm9pY2UuRG9jTnVtYmVyIHx8ICcnLFxuICAgICAgY3VzdG9tZXJOYW1lOiBjdXN0b21lck5hbWUsXG4gICAgICBkYXRlOiBxYkludm9pY2UuVHhuRGF0ZSB8fCAnJyxcbiAgICAgIGR1ZURhdGU6IHFiSW52b2ljZS5EdWVEYXRlIHx8ICcnLFxuICAgICAgYW1vdW50OiBxYkludm9pY2UuVG90YWxBbXQgfHwgMCxcbiAgICAgIGJhbGFuY2U6IHFiSW52b2ljZS5CYWxhbmNlIHx8IDAsXG4gICAgICBzdGF0dXM6IHFiSW52b2ljZS5zdGF0dXMgfHwgJ1Vua25vd24nLFxuICAgICAgbGluZUl0ZW1zOiBsaW5lSXRlbXMsXG4gICAgICBjdXJyZW5jeTogcWJJbnZvaWNlLkN1cnJlbmN5UmVmPy5uYW1lIHx8ICdVU0QnXG4gICAgfTtcbiAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICBjb25zb2xlLmVycm9yKCdFcnJvciBtYXBwaW5nIFF1aWNrQm9va3MgaW52b2ljZTonLCBlcnJvcik7XG4gICAgLy8gUmV0dXJuIGEgbWluaW1hbCB2YWxpZCBpbnZvaWNlIHRvIGF2b2lkIGVycm9yc1xuICAgIHJldHVybiB7XG4gICAgICBpZDogcWJJbnZvaWNlLklkIHx8ICcnLFxuICAgICAgaW52b2ljZU51bWJlcjogcWJJbnZvaWNlLkRvY051bWJlciB8fCAnJyxcbiAgICAgIGN1c3RvbWVyTmFtZTogJ0Vycm9yIHBhcnNpbmcgaW52b2ljZScsXG4gICAgICBkYXRlOiBxYkludm9pY2UuVHhuRGF0ZSB8fCAnJyxcbiAgICAgIGR1ZURhdGU6ICcnLFxuICAgICAgYW1vdW50OiAwLFxuICAgICAgYmFsYW5jZTogMCxcbiAgICAgIHN0YXR1czogJ0Vycm9yJyxcbiAgICAgIGxpbmVJdGVtczogW10sXG4gICAgICBjdXJyZW5jeTogJ1VTRCdcbiAgICB9O1xuICB9XG59XG5cbi8vIEZ1bmN0aW9uIHRvIHJlZnJlc2ggUXVpY2tCb29rcyB0b2tlblxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIHJlZnJlc2hRdWlja0Jvb2tzVG9rZW4ocmVmcmVzaFRva2VuOiBzdHJpbmcpOiBQcm9taXNlPGJvb2xlYW4+IHtcbiAgdHJ5IHtcbiAgICBkZWJ1Z0xvZygnQXR0ZW1wdGluZyB0byByZWZyZXNoIHRva2VuJyk7XG4gICAgXG4gICAgLy8gQ3JlYXRlIGEgZnJlc2ggT0F1dGggY2xpZW50IGZvciB0b2tlbiByZWZyZXNoXG4gICAgY29uc3QgZnJlc2hPQXV0aENsaWVudCA9IGNyZWF0ZU9BdXRoQ2xpZW50KCk7XG4gICAgXG4gICAgaWYgKCFmcmVzaE9BdXRoQ2xpZW50KSB7XG4gICAgICBkZWJ1Z0xvZygnRmFpbGVkIHRvIGNyZWF0ZSBmcmVzaCBPQXV0aCBjbGllbnQnKTtcbiAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9XG4gICAgXG4gICAgZGVidWdMb2coJ0NyZWF0ZWQgZnJlc2ggT0F1dGggY2xpZW50IGZvciB0b2tlbiByZWZyZXNoJyk7XG4gICAgXG4gICAgLy8gVHJ5IHRvIHJlZnJlc2ggdG9rZW5cbiAgICBjb25zdCByZWZyZXNoUmVzcG9uc2UgPSBhd2FpdCBmcmVzaE9BdXRoQ2xpZW50LnJlZnJlc2hVc2luZ1Rva2VuKHJlZnJlc2hUb2tlbik7XG4gICAgXG4gICAgaWYgKCFyZWZyZXNoUmVzcG9uc2UpIHtcbiAgICAgIGRlYnVnTG9nKCdObyByZXNwb25zZSBmcm9tIHRva2VuIHJlZnJlc2gnKTtcbiAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9XG4gICAgXG4gICAgY29uc3QgcmVmcmVzaERhdGEgPSByZWZyZXNoUmVzcG9uc2UuZ2V0SnNvbigpO1xuICAgIGRlYnVnTG9nKCdSZWZyZXNoIHJlc3BvbnNlIHJlY2VpdmVkJywgeyBcbiAgICAgIGhhc0FjY2Vzc1Rva2VuOiAhIXJlZnJlc2hEYXRhLmFjY2Vzc190b2tlbixcbiAgICAgIGhhc1JlZnJlc2hUb2tlbjogISFyZWZyZXNoRGF0YS5yZWZyZXNoX3Rva2VuLFxuICAgICAgZXhwaXJlc0luOiByZWZyZXNoRGF0YS5leHBpcmVzX2luXG4gICAgfSk7XG4gICAgXG4gICAgaWYgKCFyZWZyZXNoRGF0YS5hY2Nlc3NfdG9rZW4pIHtcbiAgICAgIGRlYnVnTG9nKCdObyBhY2Nlc3MgdG9rZW4gaW4gcmVmcmVzaCByZXNwb25zZScpO1xuICAgICAgcmV0dXJuIGZhbHNlO1xuICAgIH1cbiAgICBcbiAgICAvLyBTdG9yZSB0aGUgcmVmcmVzaGVkIHRva2VuXG4gICAgc3RvcmVUb2tlbihcbiAgICAgIHJlZnJlc2hEYXRhLmFjY2Vzc190b2tlbixcbiAgICAgIHRva2VuU3RvcmUucmVhbG1JZCB8fCAnJywgLy8gVXNlIGV4aXN0aW5nIHJlYWxtSWRcbiAgICAgIHJlZnJlc2hEYXRhLnJlZnJlc2hfdG9rZW4sXG4gICAgICByZWZyZXNoRGF0YS5leHBpcmVzX2luXG4gICAgKTtcbiAgICBcbiAgICAvLyBSZS1pbml0aWFsaXplIFF1aWNrQm9va3MgY2xpZW50IHdpdGggbmV3IHRva2VuXG4gICAgaWYgKHRva2VuU3RvcmUucmVhbG1JZCkge1xuICAgICAgY29uc3QgaW5pdGlhbGl6ZWQgPSBpbml0aWFsaXplUUJPKFxuICAgICAgICByZWZyZXNoRGF0YS5hY2Nlc3NfdG9rZW4sXG4gICAgICAgIHRva2VuU3RvcmUucmVhbG1JZCxcbiAgICAgICAgcmVmcmVzaERhdGEucmVmcmVzaF90b2tlbixcbiAgICAgICAgcmVmcmVzaERhdGEuZXhwaXJlc19pbiA/IERhdGUubm93KCkgKyAocmVmcmVzaERhdGEuZXhwaXJlc19pbiAqIDEwMDApIDogdW5kZWZpbmVkXG4gICAgICApO1xuICAgICAgXG4gICAgICBkZWJ1Z0xvZygnUXVpY2tCb29rcyBjbGllbnQgcmUtaW5pdGlhbGl6ZWQgYWZ0ZXIgdG9rZW4gcmVmcmVzaDonLCB7IHN1Y2Nlc3M6IGluaXRpYWxpemVkIH0pO1xuICAgICAgcmV0dXJuIGluaXRpYWxpemVkO1xuICAgIH1cbiAgICBcbiAgICBkZWJ1Z0xvZygnTm8gcmVhbG1JZCBhdmFpbGFibGUgdG8gcmUtaW5pdGlhbGl6ZSBjbGllbnQnKTtcbiAgICByZXR1cm4gZmFsc2U7XG4gIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgY29uc29sZS5lcnJvcignRXJyb3IgcmVmcmVzaGluZyB0b2tlbjonLCBlcnJvcik7XG4gICAgZGVidWdMb2coJ1Rva2VuIHJlZnJlc2ggZmFpbGVkIHdpdGggZXJyb3InKTtcbiAgICByZXR1cm4gZmFsc2U7XG4gIH1cbn1cblxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGZldGNoSW52b2ljZXMoKTogUHJvbWlzZTxJbnZvaWNlW10gfCBudWxsPiB7XG4gIGNvbnNvbGUuZXJyb3IoJ+KtkCBmZXRjaEludm9pY2VzOiBTdGFydGluZyBpbnZvaWNlIGZldGNoIHByb2Nlc3MnKTtcbiAgdHJ5IHtcbiAgICBkZWJ1Z0xvZygnU3RhcnRpbmcgZmV0Y2hJbnZvaWNlcy4uLicpO1xuICAgIFxuICAgIC8vIEZpcnN0LCB2ZXJpZnkgd2UgY2FuIGdldCBzdG9yZWQgdG9rZW5zIC0gYW55IHNvdXJjZSBpcyBmaW5lIChtZW1vcnksIGxvY2FsU3RvcmFnZSwgY29va2llcylcbiAgICBjb25zdCB0b2tlbnMgPSBnZXRTdG9yZWRUb2tlbigpO1xuICAgIFxuICAgIGNvbnNvbGUuZXJyb3IoJ+KtkCBmZXRjaEludm9pY2VzOiBUb2tlbiBjaGVjayByZXN1bHQ6JywgeyBcbiAgICAgIGhhc1Rva2VuOiAhIXRva2Vucz8uYWNjZXNzVG9rZW4sXG4gICAgICBoYXNSZWFsbUlkOiAhIXRva2Vucz8ucmVhbG1JZCxcbiAgICAgIGhhc1JlZnJlc2hUb2tlbjogISF0b2tlbnM/LnJlZnJlc2hUb2tlbixcbiAgICAgIHRva2VuRXhwaXJ5OiB0b2tlbnM/LnRva2VuRXhwaXJ5ID8gbmV3IERhdGUodG9rZW5zLnRva2VuRXhwaXJ5KS50b0lTT1N0cmluZygpIDogJ25vbmUnXG4gICAgfSk7XG4gICAgXG4gICAgaWYgKCF0b2tlbnMgfHwgIXRva2Vucy5hY2Nlc3NUb2tlbiB8fCAhdG9rZW5zLnJlYWxtSWQpIHtcbiAgICAgIGNvbnNvbGUuZXJyb3IoJ+KtkCBmZXRjaEludm9pY2VzOiBObyB2YWxpZCB0b2tlbnMgZm91bmQgZm9yIFF1aWNrQm9va3MgQVBJIGNhbGwnKTtcbiAgICAgIHRocm93IG5ldyBFcnJvcignUXVpY2tCb29rcyBhdXRoZW50aWNhdGlvbiByZXF1aXJlZC4gUGxlYXNlIGNvbm5lY3QgeW91ciBhY2NvdW50LicpO1xuICAgIH1cbiAgICBcbiAgICAvLyBDaGVjayBpZiB0b2tlbiBpcyBleHBpcmVkIGFuZCB3ZSBuZWVkIHRvIHJlZnJlc2hcbiAgICBjb25zdCBub3cgPSBEYXRlLm5vdygpO1xuICAgIGNvbnN0IHRva2VuRXhwaXJlZCA9IHRva2Vucy50b2tlbkV4cGlyeSAmJiBub3cgPj0gdG9rZW5zLnRva2VuRXhwaXJ5O1xuICAgIFxuICAgIGNvbnNvbGUuZXJyb3IoJ+KtkCBmZXRjaEludm9pY2VzOiBUb2tlbiBleHBpcnkgY2hlY2s6Jywge1xuICAgICAgbm93OiBuZXcgRGF0ZShub3cpLnRvSVNPU3RyaW5nKCksXG4gICAgICB0b2tlbkV4cGlyeTogdG9rZW5zLnRva2VuRXhwaXJ5ID8gbmV3IERhdGUodG9rZW5zLnRva2VuRXhwaXJ5KS50b0lTT1N0cmluZygpIDogJ3Vua25vd24nLFxuICAgICAgaXNFeHBpcmVkOiB0b2tlbkV4cGlyZWRcbiAgICB9KTtcbiAgICBcbiAgICAvLyBJZiB0b2tlbiBpcyBleHBpcmVkIGFuZCB3ZSBoYXZlIHJlZnJlc2ggdG9rZW4sIHRyeSB0byByZWZyZXNoIGl0XG4gICAgaWYgKHRva2VuRXhwaXJlZCAmJiB0b2tlbnMucmVmcmVzaFRva2VuKSB7XG4gICAgICBjb25zb2xlLmVycm9yKCfirZAgZmV0Y2hJbnZvaWNlczogVG9rZW4gZXhwaXJlZCwgYXR0ZW1wdGluZyB0byByZWZyZXNoJyk7XG4gICAgICBcbiAgICAgIHRyeSB7XG4gICAgICAgIGNvbnN0IHJlZnJlc2hlZCA9IGF3YWl0IHJlZnJlc2hRdWlja0Jvb2tzVG9rZW4odG9rZW5zLnJlZnJlc2hUb2tlbik7XG4gICAgICAgIGNvbnNvbGUuZXJyb3IoJ+KtkCBmZXRjaEludm9pY2VzOiBUb2tlbiByZWZyZXNoIHJlc3VsdDonLCB7IHN1Y2Nlc3M6ICEhcmVmcmVzaGVkIH0pO1xuICAgICAgICBcbiAgICAgICAgaWYgKCFyZWZyZXNoZWQpIHtcbiAgICAgICAgICBjb25zb2xlLmVycm9yKCfirZAgZmV0Y2hJbnZvaWNlczogVG9rZW4gcmVmcmVzaCBmYWlsZWQnKTtcbiAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ0ZhaWxlZCB0byByZWZyZXNoIFF1aWNrQm9va3MgYXV0aGVudGljYXRpb24uIFBsZWFzZSByZWNvbm5lY3QgeW91ciBhY2NvdW50LicpO1xuICAgICAgICB9XG4gICAgICB9IGNhdGNoIChyZWZyZXNoRXJyb3IpIHtcbiAgICAgICAgY29uc29sZS5lcnJvcign4q2QIGZldGNoSW52b2ljZXM6IEVycm9yIHJlZnJlc2hpbmcgdG9rZW46JywgcmVmcmVzaEVycm9yKTtcbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdRdWlja0Jvb2tzIGF1dGhlbnRpY2F0aW9uIGV4cGlyZWQuIFBsZWFzZSByZWNvbm5lY3QgeW91ciBhY2NvdW50LicpO1xuICAgICAgfVxuICAgIH1cbiAgICBcbiAgICAvLyBJbml0aWFsaXplIHRoZSBjbGllbnQgaWYgbm90IGFscmVhZHkgaW5pdGlhbGl6ZWRcbiAgICBpZiAoIXFibykge1xuICAgICAgY29uc29sZS5lcnJvcign4q2QIGZldGNoSW52b2ljZXM6IFF1aWNrQm9va3MgY2xpZW50IG5vdCBpbml0aWFsaXplZCwgYXR0ZW1wdGluZyBpbml0aWFsaXphdGlvbicpO1xuICAgICAgY29uc3QgaW5pdGlhbGl6ZWQgPSBpbml0aWFsaXplUUJPKHRva2Vucy5hY2Nlc3NUb2tlbiwgdG9rZW5zLnJlYWxtSWQsIHRva2Vucy5yZWZyZXNoVG9rZW4sIHRva2Vucy50b2tlbkV4cGlyeSk7XG4gICAgICBcbiAgICAgIGNvbnNvbGUuZXJyb3IoJ+KtkCBmZXRjaEludm9pY2VzOiBJbml0aWFsaXphdGlvbiByZXN1bHQ6JywgeyBzdWNjZXNzOiBpbml0aWFsaXplZCB9KTtcbiAgICAgIFxuICAgICAgaWYgKCFpbml0aWFsaXplZCB8fCAhcWJvKSB7XG4gICAgICAgIGNvbnNvbGUuZXJyb3IoJ+KtkCBmZXRjaEludm9pY2VzOiBDbGllbnQgaW5pdGlhbGl6YXRpb24gZmFpbGVkJyk7XG4gICAgICAgIHRocm93IG5ldyBFcnJvcignRmFpbGVkIHRvIGluaXRpYWxpemUgUXVpY2tCb29rcyBjbGllbnQuIFBsZWFzZSByZWNvbm5lY3QgeW91ciBhY2NvdW50LicpO1xuICAgICAgfVxuICAgIH0gZWxzZSB7XG4gICAgICBjb25zb2xlLmVycm9yKCfirZAgZmV0Y2hJbnZvaWNlczogVXNpbmcgZXhpc3RpbmcgUXVpY2tCb29rcyBjbGllbnQnKTtcbiAgICB9XG4gICAgXG4gICAgLy8gRG91YmxlLWNoZWNrIHRoYXQgcWJvIGlzIHByb3Blcmx5IGluaXRpYWxpemVkIHdpdGggZXNzZW50aWFsIHByb3BlcnRpZXNcbiAgICBpZiAoIXFiby5hY2Nlc3NUb2tlbikge1xuICAgICAgY29uc29sZS5lcnJvcign4q2QIGZldGNoSW52b2ljZXM6IFFCIGNsaWVudCBtaXNzaW5nIGFjY2Vzc1Rva2VuLCB1cGRhdGluZycpO1xuICAgICAgcWJvLmFjY2Vzc1Rva2VuID0gdG9rZW5zLmFjY2Vzc1Rva2VuO1xuICAgIH1cbiAgICBcbiAgICBpZiAoIXFiby5yZWFsbUlkKSB7XG4gICAgICBjb25zb2xlLmVycm9yKCfirZAgZmV0Y2hJbnZvaWNlczogUUIgY2xpZW50IG1pc3NpbmcgcmVhbG1JZCwgdXBkYXRpbmcnKTtcbiAgICAgIHFiby5yZWFsbUlkID0gdG9rZW5zLnJlYWxtSWQ7XG4gICAgfVxuICAgIFxuICAgIC8vIFByaW50IG91dCBldmVyeXRoaW5nIHdlIGNhbiBhYm91dCB0aGUgY2xpZW50IHN0YXRlIGZvciBkZWJ1Z2dpbmdcbiAgICBjb25zb2xlLmVycm9yKCfirZAgZmV0Y2hJbnZvaWNlczogUXVpY2tCb29rcyBjbGllbnQgc3RhdGU6Jywge1xuICAgICAgY2xpZW50RXhpc3RzOiAhIXFibyxcbiAgICAgIGhhc0FjY2Vzc1Rva2VuOiAhIShxYm8gJiYgcWJvLmFjY2Vzc1Rva2VuKSxcbiAgICAgIGhhc1JlYWxtSWQ6ICEhKHFibyAmJiBxYm8ucmVhbG1JZCksXG4gICAgICBoYXNUb2tlblNlY3JldDogISEocWJvICYmIChxYm8gYXMgYW55KS50b2tlblNlY3JldCksXG4gICAgICBvYXV0aHZlcnNpb246IHFibyA/IChxYm8gYXMgYW55KS5vYXV0aHZlcnNpb24gOiAnbm9uZScsXG4gICAgICBoYXNSZWZyZXNoVG9rZW46ICEhKHFibyAmJiAocWJvIGFzIGFueSkucmVmcmVzaFRva2VuKSxcbiAgICB9KTtcbiAgICBcbiAgICAvLyBBdCB0aGlzIHBvaW50LCBxYm8gc2hvdWxkIGJlIGluaXRpYWxpemVkXG4gICAgY29uc29sZS5lcnJvcign4q2QIGZldGNoSW52b2ljZXM6IFBlcmZvcm1pbmcgUXVpY2tCb29rcyBBUEkgY2FsbCBmb3IgaW52b2ljZXMnKTtcbiAgICBcbiAgICByZXR1cm4gbmV3IFByb21pc2UoKHJlc29sdmUsIHJlamVjdCkgPT4ge1xuICAgICAgaWYgKCFxYm8pIHtcbiAgICAgICAgY29uc29sZS5lcnJvcign4q2QIGZldGNoSW52b2ljZXM6IFFCIGNsaWVudCBub3QgYXZhaWxhYmxlIGF0IHJlcXVlc3QgdGltZScpO1xuICAgICAgICByZXR1cm4gcmVqZWN0KG5ldyBFcnJvcignUXVpY2tCb29rcyBjbGllbnQgbm90IGluaXRpYWxpemVkJykpO1xuICAgICAgfVxuICAgICAgXG4gICAgICBjb25zb2xlLmVycm9yKCfirZAgZmV0Y2hJbnZvaWNlczogTWFraW5nIGZpbmRJbnZvaWNlcyBBUEkgY2FsbCcpO1xuICAgICAgXG4gICAgICAvLyBUcnktY2F0Y2ggYmxvY2sgYXJvdW5kIHRoZSBBUEkgY2FsbFxuICAgICAgdHJ5IHtcbiAgICAgICAgLy8gRmlyc3QgdHJ5OiBVc2UgYSBzaW1wbGVyIGFwcHJvYWNoIHdpdGggbm8gZmlsdGVyc1xuICAgICAgICAvLyBNYW55IFF1aWNrQm9va3MgQVBJIGZhaWx1cmVzIGhhcHBlbiBkdWUgdG8gY29tcGxleCBxdWVyaWVzXG4gICAgICAgIGNvbnNvbGUuZXJyb3IoJ+KtkCBmZXRjaEludm9pY2VzOiBUcnlpbmcgc2ltcGxlIHF1ZXJ5IHdpdGggbm8gZmlsdGVycycpO1xuICAgICAgICBcbiAgICAgICAgcWJvLmZpbmRJbnZvaWNlcygnJywgKGVycjogYW55LCBkYXRhOiBhbnkpID0+IHtcbiAgICAgICAgaWYgKGVycikge1xuICAgICAgICAgICAgY29uc29sZS5lcnJvcign4q2QIGZldGNoSW52b2ljZXM6IEVycm9yIGluIHNpbXBsZSBmaW5kSW52b2ljZXMgY2FsbDonLCBlcnIpO1xuICAgICAgICAgICAgY29uc29sZS5lcnJvcign4q2QIEVycm9yIGRldGFpbHM6JywgSlNPTi5zdHJpbmdpZnkoZXJyLCBudWxsLCAyKSk7XG4gICAgICAgICAgICBcbiAgICAgICAgICAgIC8vIElmIHRoZSBzaW1wbGUgYXBwcm9hY2ggZmFpbHMsIHRyeSBhIGJhY2t1cCBhcHByb2FjaFxuICAgICAgICAgICAgY29uc29sZS5lcnJvcign4q2QIGZldGNoSW52b2ljZXM6IFRyeWluZyBhbHRlcm5hdGl2ZSBxdWVyeSBhcHByb2FjaCcpO1xuICAgICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgICAgLy8gVHJ5IHdpdGggdGhlIG9sZGVyIHF1ZXJ5IGFwcHJvYWNoXG4gICAgICAgICAgICAgIHFiby5maW5kSW52b2ljZXMoW1xuICAgICAgICAgICAgICAgIHsgZmllbGQ6ICdNZXRhRGF0YS5MYXN0VXBkYXRlZFRpbWUnLCB2YWx1ZTogJzIwMTAtMDEtMDFUMDA6MDA6MDAnLCBvcGVyYXRvcjogJz4nIH1cbiAgICAgICAgICAgICAgXSwgKGVycjI6IGFueSwgZGF0YTI6IGFueSkgPT4ge1xuICAgICAgICAgICAgICAgIGlmIChlcnIyKSB7XG4gICAgICAgICAgICAgICAgICBjb25zb2xlLmVycm9yKCfirZAgZmV0Y2hJbnZvaWNlczogQm90aCBxdWVyeSBhcHByb2FjaGVzIGZhaWxlZDonLCBlcnIyKTtcbiAgICAgICAgICAgICAgICAgIGNvbnNvbGUuZXJyb3IoJ+KtkCBFcnJvciBkZXRhaWxzOicsIEpTT04uc3RyaW5naWZ5KGVycjIsIG51bGwsIDIpKTtcbiAgICAgICAgICAgICAgICAgIHJldHVybiByZWplY3QoZXJyMik7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgIHByb2Nlc3NJbnZvaWNlUmVzdWx0KGRhdGEyLCByZXNvbHZlLCByZWplY3QpO1xuICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH0gY2F0Y2ggKGJhY2t1cEVycm9yKSB7XG4gICAgICAgICAgICAgIGNvbnNvbGUuZXJyb3IoJ+KtkCBmZXRjaEludm9pY2VzOiBFeGNlcHRpb24gaW4gYmFja3VwIGFwcHJvYWNoOicsIGJhY2t1cEVycm9yKTtcbiAgICAgICAgICAgICAgcmV0dXJuIHJlamVjdChiYWNrdXBFcnJvcik7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIHByb2Nlc3NJbnZvaWNlUmVzdWx0KGRhdGEsIHJlc29sdmUsIHJlamVjdCk7XG4gICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICAgIH0gY2F0Y2ggKGFwaUNhbGxFcnJvcikge1xuICAgICAgICBjb25zb2xlLmVycm9yKCfirZAgZmV0Y2hJbnZvaWNlczogRXhjZXB0aW9uIGR1cmluZyBBUEkgY2FsbCBleGVjdXRpb246JywgYXBpQ2FsbEVycm9yKTtcbiAgICAgICAgcmV0dXJuIHJlamVjdChuZXcgRXJyb3IoYFF1aWNrQm9va3MgQVBJIGNhbGwgZmFpbGVkOiAke2FwaUNhbGxFcnJvciBpbnN0YW5jZW9mIEVycm9yID8gYXBpQ2FsbEVycm9yLm1lc3NhZ2UgOiAnVW5rbm93biBlcnJvcid9YCkpO1xuICAgICAgfVxuICAgIH0pO1xuICB9IGNhdGNoIChlcnJvcikge1xuICAgIGNvbnNvbGUuZXJyb3IoJ+KtkCBmZXRjaEludm9pY2VzOiBFcnJvciBpbiBmZXRjaEludm9pY2VzOicsIGVycm9yKTtcbiAgICB0aHJvdyBlcnJvcjtcbiAgfVxufVxuXG4vLyBIZWxwZXIgZnVuY3Rpb24gdG8gcHJvY2VzcyBpbnZvaWNlIHJlc3VsdHNcbmZ1bmN0aW9uIHByb2Nlc3NJbnZvaWNlUmVzdWx0KGRhdGE6IGFueSwgcmVzb2x2ZTogRnVuY3Rpb24sIHJlamVjdDogRnVuY3Rpb24pIHtcbiAgLy8gQ2hlY2sgaWYgZGF0YSBoYXMgUXVlcnlSZXNwb25zZSBwcm9wZXJ0eSB3aXRoIEludm9pY2UgYXJyYXlcbiAgaWYgKGRhdGEgJiYgZGF0YS5RdWVyeVJlc3BvbnNlICYmIEFycmF5LmlzQXJyYXkoZGF0YS5RdWVyeVJlc3BvbnNlLkludm9pY2UpKSB7XG4gICAgY29uc3QgaW52b2ljZXMgPSBkYXRhLlF1ZXJ5UmVzcG9uc2UuSW52b2ljZTtcbiAgICBjb25zb2xlLmVycm9yKGDirZAgZmV0Y2hJbnZvaWNlczogU3VjY2Vzc2Z1bGx5IGZvdW5kICR7aW52b2ljZXMubGVuZ3RofSBpbnZvaWNlc2ApO1xuICAgIFxuICAgIC8vIElmIG5vIGludm9pY2VzIHdlcmUgZm91bmQsIHJldHVybiBlbXB0eSBhcnJheSByYXRoZXIgdGhhbiBlcnJvclxuICAgIGlmIChpbnZvaWNlcy5sZW5ndGggPT09IDApIHtcbiAgICAgIGNvbnNvbGUuZXJyb3IoJ+KtkCBmZXRjaEludm9pY2VzOiBObyBpbnZvaWNlcyBmb3VuZCBpbiBRdWlja0Jvb2tzIGFjY291bnQnKTtcbiAgICAgIHJldHVybiByZXNvbHZlKFtdKTtcbiAgICB9XG4gICAgXG4gICAgcmV0dXJuIHJlc29sdmUoaW52b2ljZXMpO1xuICB9IGVsc2Uge1xuICAgIGNvbnNvbGUuZXJyb3IoJ+KtkCBmZXRjaEludm9pY2VzOiBJbnZhbGlkIGRhdGEgc3RydWN0dXJlIHJlY2VpdmVkIGZyb20gUUIgQVBJOicsIHR5cGVvZiBkYXRhLCBkYXRhID8gT2JqZWN0LmtleXMoZGF0YSkgOiAnbnVsbCcpO1xuICAgIGNvbnNvbGUuZXJyb3IoJ+KtkCBmZXRjaEludm9pY2VzOiBEYXRhIGR1bXA6JywgSlNPTi5zdHJpbmdpZnkoZGF0YSwgbnVsbCwgMikpO1xuICAgIHJldHVybiByZWplY3QobmV3IEVycm9yKCdJbnZhbGlkIHJlc3BvbnNlIGZyb20gUXVpY2tCb29rcyBBUEknKSk7XG4gIH1cbn1cblxuZXhwb3J0IGNvbnN0IGdldEludm9pY2VCeUlkID0gYXN5bmMgKGlkOiBzdHJpbmcpOiBQcm9taXNlPEludm9pY2U+ID0+IHtcbiAgdHJ5IHtcbiAgICBkZWJ1Z0xvZyhgRmV0Y2hpbmcgaW52b2ljZSBieSBJRDogJHtpZH1gKTtcbiAgICBjaGVja0NsaWVudEluaXRpYWxpemVkKCk7XG4gICAgXG4gICAgaWYgKCFxYm8pIHtcbiAgICAgIGRlYnVnTG9nKCdRQk8gY2xpZW50IGlzIG51bGwgYWZ0ZXIgaW5pdGlhbGl6YXRpb24gY2hlY2snKTtcbiAgICAgIHRocm93IG5ldyBFcnJvcignUXVpY2tCb29rcyBjbGllbnQgaXMgbm90IGF2YWlsYWJsZS4gUGxlYXNlIHJlY29ubmVjdCB5b3VyIFF1aWNrQm9va3MgYWNjb3VudC4nKTtcbiAgICB9XG4gICAgXG4gICAgY29uc3QgY2xlYW5JZCA9IGlkLnJlcGxhY2UoL14oPzppbnYtKT8jP1xccyovaSwgJycpLnRyaW0oKTtcbiAgICBcbiAgICByZXR1cm4gbmV3IFByb21pc2UoKHJlc29sdmUsIHJlamVjdCkgPT4ge1xuICAgICAgZGVidWdMb2coYENhbGxpbmcgUXVpY2tCb29rcyBnZXRJbnZvaWNlIEFQSSBmb3IgSUQ6ICR7Y2xlYW5JZH1gKTtcbiAgICAgIHFibyEuZ2V0SW52b2ljZShjbGVhbklkLCAoZXJyOiBhbnksIGludm9pY2U6IGFueSkgPT4ge1xuICAgICAgICBpZiAoZXJyKSB7XG4gICAgICAgICAgY29uc29sZS5lcnJvcignRXJyb3IgZmV0Y2hpbmcgaW52b2ljZSBmcm9tIFF1aWNrQm9va3MgQVBJOicsIGVycik7XG4gICAgICAgICAgXG4gICAgICAgICAgaWYgKGVyci5jb2RlID09PSAnODAwNDA0MDgnKSB7XG4gICAgICAgICAgICBkZWJ1Z0xvZygnUXVpY2tCb29rcyBpbml0aWFsaXphdGlvbiBlcnJvciAoODAwNDA0MDgpLiBDbGVhcmluZyB0b2tlbnMuJyk7XG4gICAgICAgICAgICBjbGVhclRva2VucygpO1xuICAgICAgICAgICAgcmVqZWN0KG5ldyBFcnJvcignUXVpY2tCb29rcyBjb25uZWN0aW9uIGVycm9yLiBQbGVhc2UgcmVjb25uZWN0IHlvdXIgUXVpY2tCb29rcyBhY2NvdW50LicpKTtcbiAgICAgICAgICB9IGVsc2UgaWYgKGVyci5jb2RlID09PSAnMjcwJyB8fCBlcnIubWVzc2FnZT8uaW5jbHVkZXMoJ1Rva2VuIGludmFsaWQnKSkge1xuICAgICAgICAgICAgZGVidWdMb2coJ0ludmFsaWQgdG9rZW4gZXJyb3IuIENsZWFyaW5nIHRva2Vucy4nKTtcbiAgICAgICAgICAgIGNsZWFyVG9rZW5zKCk7XG4gICAgICAgICAgICByZWplY3QobmV3IEVycm9yKCdRdWlja0Jvb2tzIGF1dGhlbnRpY2F0aW9uIGhhcyBleHBpcmVkLiBQbGVhc2UgcmVjb25uZWN0IHlvdXIgUXVpY2tCb29rcyBhY2NvdW50LicpKTtcbiAgICAgICAgICB9IGVsc2UgaWYgKGVyci5zdGF0dXNDb2RlID09PSA0MDQpIHtcbiAgICAgICAgICAgIHJlamVjdChuZXcgRXJyb3IoYEludm9pY2UgIyR7aWR9IG5vdCBmb3VuZC4gUGxlYXNlIGNoZWNrIHRoZSBpbnZvaWNlIG51bWJlciBhbmQgdHJ5IGFnYWluLmApKTtcbiAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgcmVqZWN0KG5ldyBFcnJvcignRmFpbGVkIHRvIGZldGNoIGludm9pY2UgZnJvbSBRdWlja0Jvb2tzLiBQbGVhc2UgY2hlY2sgeW91ciBjb25uZWN0aW9uLicpKTtcbiAgICAgICAgICB9XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgZGVidWdMb2coJ1N1Y2Nlc3NmdWxseSBmZXRjaGVkIGludm9pY2UgZnJvbSBRdWlja0Jvb2tzJyk7XG4gICAgICAgICAgcmVzb2x2ZShtYXBRdWlja0Jvb2tzSW52b2ljZShpbnZvaWNlKSk7XG4gICAgICAgIH1cbiAgICAgIH0pO1xuICAgIH0pO1xuICB9IGNhdGNoIChlcnJvcikge1xuICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIGluIGdldEludm9pY2VCeUlkOicsIGVycm9yKTtcbiAgICB0aHJvdyBlcnJvcjtcbiAgfVxufTtcblxuLy8gSW5pdGlhbGl6ZSB0aGUgT0F1dGggY2xpZW50XG5pbml0aWFsaXplT0F1dGhDbGllbnQoKTtcblxuLy8gVXBkYXRlIHRoZSBnZXRBdXRoVXJsIGZ1bmN0aW9uIHRvIHVzZSB0aGUgbmV3IGNyZWF0ZU9BdXRoQ2xpZW50IGZ1bmN0aW9uXG5leHBvcnQgY29uc3QgZ2V0QXV0aFVybCA9ICgpID0+IHtcbiAgdHJ5IHtcbiAgICAvLyBMb2cgZW52aXJvbm1lbnQgdmFyaWFibGVzIGZvciBkZWJ1Z2dpbmcgKHJlZGFjdGluZyBzZW5zaXRpdmUgaW5mbylcbiAgICBjb25zb2xlLmxvZygnRW52aXJvbm1lbnQgY2hlY2s6Jywge1xuICAgICAgaGFzQ2xpZW50SWQ6ICEhcHJvY2Vzcy5lbnYuUVVJQ0tCT09LU19DTElFTlRfSUQsXG4gICAgICBoYXNDbGllbnRTZWNyZXQ6ICEhcHJvY2Vzcy5lbnYuUVVJQ0tCT09LU19DTElFTlRfU0VDUkVULFxuICAgICAgcmVkaXJlY3RVcmk6IGdldFJlZGlyZWN0VXJpKCksXG4gICAgICBiYXNlVXJsOiBwcm9jZXNzLmVudi5ORVhUX1BVQkxJQ19CQVNFX1VSTFxuICAgIH0pO1xuXG4gICAgLy8gQ3JlYXRlIGEgZnJlc2ggT0F1dGggY2xpZW50IGZvciB0aGlzIHJlcXVlc3RcbiAgICBjb25zdCBmcmVzaE9BdXRoQ2xpZW50ID0gY3JlYXRlT0F1dGhDbGllbnQoKTtcblxuICAgIC8vIEdlbmVyYXRlIGFuZCBsb2cgdGhlIGF1dGggVVJMXG4gICAgY29uc3QgYXV0aFVybCA9IGZyZXNoT0F1dGhDbGllbnQuYXV0aG9yaXplVXJpKHtcbiAgICAgIHNjb3BlOiBbXG4gICAgICAgIE9BdXRoQ2xpZW50LnNjb3Blcy5BY2NvdW50aW5nLFxuICAgICAgICBPQXV0aENsaWVudC5zY29wZXMuT3BlbklkLFxuICAgICAgICBPQXV0aENsaWVudC5zY29wZXMuUHJvZmlsZSxcbiAgICAgICAgT0F1dGhDbGllbnQuc2NvcGVzLkVtYWlsLFxuICAgICAgXSxcbiAgICAgIHN0YXRlOiAndGVzdHN0YXRlJyxcbiAgICB9KTtcblxuICAgIGNvbnNvbGUubG9nKCdHZW5lcmF0ZWQgYXV0aCBVUkw6JywgYXV0aFVybCk7XG4gICAgcmV0dXJuIGF1dGhVcmw7XG4gIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgY29uc29sZS5lcnJvcignRXJyb3IgaW4gZ2V0QXV0aFVybDonLCBlcnJvcik7XG4gICAgdGhyb3cgZXJyb3I7XG4gIH1cbn07XG5cbmV4cG9ydCBjb25zdCBnZXRSZWRpcmVjdFVyaUZvckRpc3BsYXkgPSAoKSA9PiB7XG4gIHJldHVybiBnZXRSZWRpcmVjdFVyaSgpO1xufTtcblxuLy8gQ3JlYXRlIGEgZnVuY3Rpb24gdG8gZ2V0IGEgZnJlc2ggT0F1dGggY2xpZW50XG5mdW5jdGlvbiBnZXRPQXV0aENsaWVudCgpIHtcbiAgLy8gRW5zdXJlIHRoZSBPQXV0aCBjbGllbnQgaXMgaW5pdGlhbGl6ZWRcbiAgaWYgKCFvYXV0aENsaWVudCkge1xuICAgIGNvbnNvbGUubG9nKCdPQXV0aCBjbGllbnQgbm90IGluaXRpYWxpemVkLCBpbml0aWFsaXppbmcgbm93Jyk7XG4gICAgaWYgKCFpbml0aWFsaXplT0F1dGhDbGllbnQoKSkge1xuICAgICAgdGhyb3cgbmV3IEVycm9yKCdGYWlsZWQgdG8gaW5pdGlhbGl6ZSBPQXV0aCBjbGllbnQnKTtcbiAgICB9XG4gIH1cbiAgXG4gIC8vIFJldHVybiB0aGUgaW5pdGlhbGl6ZWQgY2xpZW50XG4gIHJldHVybiBvYXV0aENsaWVudDtcbn1cblxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGhhbmRsZUNhbGxiYWNrKHVybDogc3RyaW5nKSB7XG4gIHRyeSB7XG4gICAgLy8gQ2xlYXIgYW55IGV4aXN0aW5nIHRva2VucyBhbmQgY2xpZW50XG4gICAgY2xlYXJUb2tlbnMoKTtcbiAgICBxYm8gPSBudWxsO1xuICAgIGlzSW5pdGlhbGl6ZWQgPSBmYWxzZTtcbiAgICBcbiAgICAvLyBBbHdheXMgY3JlYXRlIGEgZnJlc2ggT0F1dGggY2xpZW50IGZvciB0b2tlbiBleGNoYW5nZVxuICAgIC8vIFRoaXMgZW5zdXJlcyB0aGUgdG9rZW5TZWNyZXQgaXMgcHJvcGVybHkgc2V0IGZvciB0aGlzIHNwZWNpZmljIHJlcXVlc3RcbiAgICBjb25zdCBmcmVzaE9BdXRoQ2xpZW50ID0gY3JlYXRlT0F1dGhDbGllbnQoKTtcbiAgICBcbiAgICAvLyBQYXJzZSB0aGUgVVJMIHRvIGdldCB0aGUgcmVhbG1JZCBmcm9tIHF1ZXJ5IHBhcmFtZXRlcnNcbiAgICBjb25zdCB1cmxQYXJhbXMgPSBuZXcgVVJMKHVybCkuc2VhcmNoUGFyYW1zO1xuICAgIGNvbnN0IHJlYWxtSWRGcm9tVXJsID0gdXJsUGFyYW1zLmdldCgncmVhbG1JZCcpO1xuICAgIGNvbnN0IGNvZGUgPSB1cmxQYXJhbXMuZ2V0KCdjb2RlJyk7XG4gICAgXG4gICAgaWYgKCFjb2RlKSB7XG4gICAgICB0aHJvdyBuZXcgRXJyb3IoJ05vIGF1dGhvcml6YXRpb24gY29kZSByZWNlaXZlZCBmcm9tIFF1aWNrQm9va3MnKTtcbiAgICB9XG4gICAgXG4gICAgY29uc29sZS5sb2coJ0NyZWF0aW5nIHRva2VuIHdpdGggZnJlc2ggT0F1dGggY2xpZW50Jywge1xuICAgICAgY29kZTogY29kZSxcbiAgICAgIGhhc1JlYWxtSWQ6ICEhcmVhbG1JZEZyb21VcmwsXG4gICAgICByZWRpcmVjdFVyaTogZ2V0UmVkaXJlY3RVcmkoKSxcbiAgICAgIGhhc0NsaWVudElkOiAhIXByb2Nlc3MuZW52LlFVSUNLQk9PS1NfQ0xJRU5UX0lELFxuICAgICAgaGFzQ2xpZW50U2VjcmV0OiAhIXByb2Nlc3MuZW52LlFVSUNLQk9PS1NfQ0xJRU5UX1NFQ1JFVFxuICAgIH0pO1xuICAgIFxuICAgIC8vIENyZWF0ZSB0b2tlbiB3aXRoIHRoZSBmcmVzaCBjbGllbnRcbiAgICBpZiAoIXByb2Nlc3MuZW52LlFVSUNLQk9PS1NfQ0xJRU5UX1NFQ1JFVCkge1xuICAgICAgdGhyb3cgbmV3IEVycm9yKCdRdWlja0Jvb2tzIGNsaWVudCBzZWNyZXQgaXMgbm90IGNvbmZpZ3VyZWQnKTtcbiAgICB9XG4gICAgXG4gICAgLy8gQ29uZmlndXJlIHRva2VuIGNyZWF0aW9uIG9wdGlvbnMgd2l0aCB0aGUgdG9rZW5TZWNyZXQgZXhwbGljaXRseVxuICAgIGNvbnN0IHRva2VuQ29uZmlnID0ge1xuICAgICAgY29kZTogY29kZSxcbiAgICAgIHJlYWxtSWQ6IHJlYWxtSWRGcm9tVXJsLFxuICAgICAgcmVkaXJlY3RVcmk6IGdldFJlZGlyZWN0VXJpKCksXG4gICAgICB0b2tlblNlY3JldDogcHJvY2Vzcy5lbnYuUVVJQ0tCT09LU19DTElFTlRfU0VDUkVUIC8vIFBhc3MgdG9rZW5TZWNyZXQgZXhwbGljaXRseSBoZXJlXG4gICAgfTtcbiAgICBcbiAgICBjb25zb2xlLmxvZygnQ3JlYXRpbmcgdG9rZW4gd2l0aCBjb25maWc6Jywge1xuICAgICAgaGFzQ29kZTogISF0b2tlbkNvbmZpZy5jb2RlLFxuICAgICAgaGFzUmVhbG1JZDogISF0b2tlbkNvbmZpZy5yZWFsbUlkLFxuICAgICAgaGFzUmVkaXJlY3RVcmk6ICEhdG9rZW5Db25maWcucmVkaXJlY3RVcmksXG4gICAgICBoYXNUb2tlblNlY3JldDogISF0b2tlbkNvbmZpZy50b2tlblNlY3JldFxuICAgIH0pO1xuICAgIFxuICAgIC8vIENyZWF0ZSB0b2tlbiB3aXRoIGV4cGxpY2l0IHBhcmFtc1xuICAgIGNvbnN0IGF1dGhSZXNwb25zZSA9IGF3YWl0IGZyZXNoT0F1dGhDbGllbnQuY3JlYXRlVG9rZW4odXJsLCB0b2tlbkNvbmZpZyk7XG4gICAgY29uc3QgdG9rZW5EYXRhID0gYXV0aFJlc3BvbnNlLmdldEpzb24oKTtcbiAgICBcbiAgICBpZiAoIXRva2VuRGF0YS5hY2Nlc3NfdG9rZW4pIHtcbiAgICAgIHRocm93IG5ldyBFcnJvcignTm8gYWNjZXNzIHRva2VuIHJlY2VpdmVkIGZyb20gUXVpY2tCb29rcycpO1xuICAgIH1cbiAgICBcbiAgICAvLyBVc2UgcmVhbG1JZCBmcm9tIHRva2VuIGRhdGEgaWYgYXZhaWxhYmxlLCBvdGhlcndpc2UgdXNlIGZyb20gVVJMXG4gICAgY29uc3QgcmVhbG1JZCA9IHRva2VuRGF0YS5yZWFsbUlkIHx8IHJlYWxtSWRGcm9tVXJsO1xuICAgIFxuICAgIGlmICghcmVhbG1JZCkge1xuICAgICAgdGhyb3cgbmV3IEVycm9yKCdObyByZWFsbUlkIGZvdW5kIGluIHJlc3BvbnNlIG9yIFVSTCBwYXJhbWV0ZXJzJyk7XG4gICAgfVxuICAgIFxuICAgIC8vIFN0b3JlIHRva2VuIGZpcnN0XG4gICAgY29uc3Qgc3RvcmVSZXN1bHQgPSBzdG9yZVRva2VuKFxuICAgICAgdG9rZW5EYXRhLmFjY2Vzc190b2tlbixcbiAgICAgIHJlYWxtSWQsXG4gICAgICB0b2tlbkRhdGEucmVmcmVzaF90b2tlbixcbiAgICAgIHRva2VuRGF0YS5leHBpcmVzX2luXG4gICAgKTtcbiAgICBcbiAgICBpZiAoIXN0b3JlUmVzdWx0KSB7XG4gICAgICB0aHJvdyBuZXcgRXJyb3IoJ0ZhaWxlZCB0byBzdG9yZSBRdWlja0Jvb2tzIHRva2VuJyk7XG4gICAgfVxuICAgIFxuICAgIC8vIEdldCBjbGllbnQgSUQgYW5kIHNlY3JldFxuICAgIGNvbnN0IGNsaWVudElkID0gcHJvY2Vzcy5lbnYuUVVJQ0tCT09LU19DTElFTlRfSUQ7XG4gICAgY29uc3QgY2xpZW50U2VjcmV0ID0gcHJvY2Vzcy5lbnYuUVVJQ0tCT09LU19DTElFTlRfU0VDUkVUO1xuICAgIFxuICAgIGlmICghY2xpZW50SWQgfHwgIWNsaWVudFNlY3JldCkge1xuICAgICAgdGhyb3cgbmV3IEVycm9yKCdRdWlja0Jvb2tzIGNsaWVudCBjcmVkZW50aWFscyBhcmUgbm90IGNvbmZpZ3VyZWQnKTtcbiAgICB9XG4gICAgXG4gICAgLy8gQ3JlYXRlIHRoZSBjbGllbnQgZGlyZWN0bHkgd2l0aCBuZWVkZWQgcGFyYW1ldGVyc1xuICAgIHFibyA9IG5ldyBRdWlja0Jvb2tzKFxuICAgICAgY2xpZW50SWQsXG4gICAgICBjbGllbnRTZWNyZXQsXG4gICAgICB0b2tlbkRhdGEuYWNjZXNzX3Rva2VuLFxuICAgICAgZmFsc2UsIC8vIFNldCB0byBmYWxzZSBmb3IgcmVndWxhciBPQXV0aFxuICAgICAgcmVhbG1JZCxcbiAgICAgIHtcbiAgICAgICAgbWlub3J2ZXJzaW9uOiAnNjUnLFxuICAgICAgICBkZWJ1ZzogdHJ1ZSxcbiAgICAgICAgdXNlU2FuZGJveDogdHJ1ZSxcbiAgICAgICAgb2F1dGh2ZXJzaW9uOiAnMi4wJywgLy8gRXhwbGljaXRseSBzZXQgT0F1dGggdmVyc2lvbiB0byAyLjBcbiAgICAgICAgcmVxdWVzdFRpbWVvdXQ6IDMwMDAwXG4gICAgICB9XG4gICAgKTtcbiAgICBcbiAgICAvLyBFeHBsaWNpdGx5IHNldCByZXF1aXJlZCBwcm9wZXJ0aWVzIGlmIHRoZXkncmUgbm90IHNldCBieSBjb25zdHJ1Y3RvclxuICAgIGlmIChxYm8pIHtcbiAgICAgIC8vIE1ha2Ugc3VyZSBhY2Nlc3NUb2tlbiBpcyBzZXRcbiAgICAgIGlmICghcWJvLmFjY2Vzc1Rva2VuICYmIHRva2VuRGF0YS5hY2Nlc3NfdG9rZW4pIHtcbiAgICAgICAgcWJvLmFjY2Vzc1Rva2VuID0gdG9rZW5EYXRhLmFjY2Vzc190b2tlbjtcbiAgICAgIH1cbiAgICAgIFxuICAgICAgLy8gTWFrZSBzdXJlIHJlYWxtSWQgaXMgc2V0XG4gICAgICBpZiAoIXFiby5yZWFsbUlkICYmIHJlYWxtSWQpIHtcbiAgICAgICAgcWJvLnJlYWxtSWQgPSByZWFsbUlkO1xuICAgICAgfVxuICAgIH1cbiAgICBcbiAgICAvLyBWZXJpZnkgY2xpZW50IHdhcyBjcmVhdGVkIGFuZCBoYXMgcmVxdWlyZWQgcHJvcGVydGllc1xuICAgIGlmICghcWJvIHx8ICFxYm8uYWNjZXNzVG9rZW4gfHwgIXFiby5yZWFsbUlkKSB7XG4gICAgICBxYm8gPSBudWxsO1xuICAgICAgaXNJbml0aWFsaXplZCA9IGZhbHNlO1xuICAgICAgdGhyb3cgbmV3IEVycm9yKCdRdWlja0Jvb2tzIGNsaWVudCBpbml0aWFsaXphdGlvbiBmYWlsZWQgLSBtaXNzaW5nIHJlcXVpcmVkIHByb3BlcnRpZXMnKTtcbiAgICB9XG4gICAgXG4gICAgLy8gU2V0IGluaXRpYWxpemF0aW9uIHN0YXR1c1xuICAgIGlzSW5pdGlhbGl6ZWQgPSB0cnVlO1xuICAgIGNvbnNvbGUubG9nKCdRdWlja0Jvb2tzIGNsaWVudCBpbml0aWFsaXplZCBzdWNjZXNzZnVsbHknKTtcbiAgICBcbiAgICByZXR1cm4ge1xuICAgICAgYWNjZXNzX3Rva2VuOiB0b2tlbkRhdGEuYWNjZXNzX3Rva2VuLFxuICAgICAgcmVhbG1JZDogcmVhbG1JZCxcbiAgICAgIHJlZnJlc2hfdG9rZW46IHRva2VuRGF0YS5yZWZyZXNoX3Rva2VuLFxuICAgICAgZXhwaXJlc19pbjogdG9rZW5EYXRhLmV4cGlyZXNfaW5cbiAgICB9O1xuICB9IGNhdGNoIChlcnJvcikge1xuICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIGluIGhhbmRsZUNhbGxiYWNrOicsIGVycm9yKTtcbiAgICAvLyBDbGVhciBhbnkgcGFydGlhbCBzdGF0ZVxuICAgIGNsZWFyVG9rZW5zKCk7XG4gICAgcWJvID0gbnVsbDtcbiAgICBpc0luaXRpYWxpemVkID0gZmFsc2U7XG4gICAgdGhyb3cgZXJyb3I7XG4gIH1cbn1cblxuLy8gQWRkIHRoaXMgZnVuY3Rpb24gdG8gdGhlIGFwaS50cyBmaWxlIHRvIGRpcmVjdGx5IHNldCB0b2tlbnNcbmV4cG9ydCBjb25zdCBtYW51YWxseUluaXRpYWxpemVRdWlja0Jvb2tzID0gKCkgPT4ge1xuICB0cnkge1xuICAgIGNvbnNvbGUubG9nKCdNYW51YWxseSBpbml0aWFsaXppbmcgUXVpY2tCb29rcyBjbGllbnQnKTtcbiAgICBcbiAgICAvLyBDcmVhdGUgYW5kIHN0b3JlIGEgbG9uZy1sYXN0aW5nIHRva2VuICgzMCBkYXlzKVxuICAgIGNvbnN0IGFjY2Vzc1Rva2VuID0gJ01BTlVBTF9UT0tFTl8nICsgRGF0ZS5ub3coKTtcbiAgICBjb25zdCByZWFsbUlkID0gJ01BTlVBTF9SRUFMTV8nICsgRGF0ZS5ub3coKTtcbiAgICBjb25zdCBleHBpcmVzSW4gPSAzMCAqIDI0ICogNjAgKiA2MDsgLy8gMzAgZGF5cyBpbiBzZWNvbmRzXG4gICAgXG4gICAgLy8gQ2FsbCB0aGUgZXhpc3RpbmcgaW5pdGlhbGl6ZVFCTyBmdW5jdGlvblxuICAgIGNvbnN0IHJlc3VsdCA9IGluaXRpYWxpemVRQk8oYWNjZXNzVG9rZW4sIHJlYWxtSWQsIGFjY2Vzc1Rva2VuLCBleHBpcmVzSW4pO1xuICAgIFxuICAgIGNvbnNvbGUubG9nKCdNYW51YWwgUXVpY2tCb29rcyBpbml0aWFsaXphdGlvbiByZXN1bHQ6JywgcmVzdWx0KTtcbiAgICByZXR1cm4gcmVzdWx0O1xuICB9IGNhdGNoIChlcnJvcikge1xuICAgIGNvbnNvbGUuZXJyb3IoJ0ZhaWxlZCB0byBtYW51YWxseSBpbml0aWFsaXplIFF1aWNrQm9va3M6JywgZXJyb3IpO1xuICAgIHJldHVybiBmYWxzZTtcbiAgfVxufTtcblxuLy8gQWRkIHRoaXMgZnVuY3Rpb24gdG8gY3JlYXRlIGEgcHJvcGVybHkgY29uZmlndXJlZCBPQXV0aCBjbGllbnRcbmZ1bmN0aW9uIGNyZWF0ZU9BdXRoQ2xpZW50KCkge1xuICB0cnkge1xuICAgIGNvbnN0IGNsaWVudElkID0gcHJvY2Vzcy5lbnYuUVVJQ0tCT09LU19DTElFTlRfSUQ7XG4gICAgY29uc3QgY2xpZW50U2VjcmV0ID0gcHJvY2Vzcy5lbnYuUVVJQ0tCT09LU19DTElFTlRfU0VDUkVUO1xuICAgIFxuICAgIGlmICghY2xpZW50SWQgfHwgIWNsaWVudFNlY3JldCkge1xuICAgICAgdGhyb3cgbmV3IEVycm9yKCdRdWlja0Jvb2tzIGNsaWVudCBjcmVkZW50aWFscyBhcmUgbm90IGNvbmZpZ3VyZWQnKTtcbiAgICB9XG4gICAgXG4gICAgLy8gU0lNUExJRklFRDogQ3JlYXRlIE9BdXRoIGNsaWVudCB3aXRoIG1pbmltYWwgY29uZmlndXJhdGlvblxuICAgIHJldHVybiBuZXcgT0F1dGhDbGllbnQoe1xuICAgICAgY2xpZW50SWQsXG4gICAgICBjbGllbnRTZWNyZXQsXG4gICAgICBlbnZpcm9ubWVudDogJ3NhbmRib3gnLFxuICAgICAgcmVkaXJlY3RVcmk6IGdldFJlZGlyZWN0VXJpKCksXG4gICAgICB0b2tlblNlY3JldDogY2xpZW50U2VjcmV0IC8vIEVzc2VudGlhbCBmb3IgT0F1dGggZmxvd1xuICAgIH0pO1xuICB9IGNhdGNoIChlcnJvcikge1xuICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIGNyZWF0aW5nIE9BdXRoIGNsaWVudDonLCBlcnJvcik7XG4gICAgdGhyb3cgZXJyb3I7XG4gIH1cbn1cblxuLy8gSW5pdGlhbGl6ZSB0aGUgY2xpZW50IGFmdGVyIHRoZSBmdW5jdGlvbiBpcyBkZWZpbmVkXG5mdW5jdGlvbiBpbml0aWFsaXplT0F1dGhDbGllbnQoKSB7XG4gIHRyeSB7XG4gICAgaWYgKCFvYXV0aENsaWVudCkge1xuICAgICAgY29uc29sZS5sb2coJ0luaXRpYWxpemluZyBPQXV0aCBjbGllbnQnKTtcbiAgICAgIG9hdXRoQ2xpZW50ID0gY3JlYXRlT0F1dGhDbGllbnQoKTtcbiAgICAgIGNvbnNvbGUubG9nKCdPQXV0aCBjbGllbnQgaW5pdGlhbGl6ZWQgc3VjY2Vzc2Z1bGx5Jyk7XG4gICAgfVxuICAgIHJldHVybiB0cnVlO1xuICB9IGNhdGNoIChlcnJvcikge1xuICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIGluaXRpYWxpemluZyBPQXV0aCBjbGllbnQ6JywgZXJyb3IpO1xuICAgIHJldHVybiBmYWxzZTtcbiAgfVxufVxuXG4vLyBBZGQgdGhpcyBmdW5jdGlvbiB0byB1cGRhdGUgdG9rZW4gc3RvcmUgZGlyZWN0bHkgZnJvbSB2YWx1ZXNcbmV4cG9ydCBmdW5jdGlvbiB1cGRhdGVUb2tlblN0b3JlRnJvbVZhbHVlcyhcbiAgYWNjZXNzVG9rZW46IHN0cmluZyxcbiAgcmVhbG1JZDogc3RyaW5nLFxuICByZWZyZXNoVG9rZW4/OiBzdHJpbmcsXG4gIHRva2VuRXhwaXJ5PzogbnVtYmVyXG4pOiBib29sZWFuIHtcbiAgdHJ5IHtcbiAgICBkZWJ1Z0xvZygnRGlyZWN0bHkgdXBkYXRpbmcgdG9rZW4gc3RvcmUgd2l0aCBwcm92aWRlZCB2YWx1ZXMnKTtcbiAgICBcbiAgICAvLyBVcGRhdGUgdGhlIHRva2VuIHN0b3JlIGRpcmVjdGx5XG4gICAgdG9rZW5TdG9yZS5hY2Nlc3NUb2tlbiA9IGFjY2Vzc1Rva2VuO1xuICAgIHRva2VuU3RvcmUucmVhbG1JZCA9IHJlYWxtSWQ7XG4gICAgXG4gICAgaWYgKHJlZnJlc2hUb2tlbikge1xuICAgICAgdG9rZW5TdG9yZS5yZWZyZXNoVG9rZW4gPSByZWZyZXNoVG9rZW47XG4gICAgfVxuICAgIFxuICAgIGlmICh0b2tlbkV4cGlyeSkge1xuICAgICAgdG9rZW5TdG9yZS50b2tlbkV4cGlyeSA9IHRva2VuRXhwaXJ5O1xuICAgIH1cbiAgICBcbiAgICBkZWJ1Z0xvZygnVG9rZW4gc3RvcmUgdXBkYXRlZCB3aXRoIHZhbHVlczonLCB7XG4gICAgICBoYXNUb2tlbjogISF0b2tlblN0b3JlLmFjY2Vzc1Rva2VuLFxuICAgICAgaGFzUmVhbG1JZDogISF0b2tlblN0b3JlLnJlYWxtSWQsXG4gICAgICBoYXNSZWZyZXNoVG9rZW46ICEhdG9rZW5TdG9yZS5yZWZyZXNoVG9rZW4sXG4gICAgICB0b2tlbkV4cGlyeTogdG9rZW5TdG9yZS50b2tlbkV4cGlyeSA/IG5ldyBEYXRlKHRva2VuU3RvcmUudG9rZW5FeHBpcnkpLnRvSVNPU3RyaW5nKCkgOiAnbm9uZSdcbiAgICB9KTtcbiAgICBcbiAgICByZXR1cm4gdHJ1ZTtcbiAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICBjb25zb2xlLmVycm9yKCdFcnJvciB1cGRhdGluZyB0b2tlbiBzdG9yZSBmcm9tIHZhbHVlczonLCBlcnJvcik7XG4gICAgcmV0dXJuIGZhbHNlO1xuICB9XG59XG5cbi8vIEFsdGVybmF0aXZlIG1ldGhvZCB0byBmZXRjaCBpbnZvaWNlcyB3aXRoIGEgbW9yZSBkaXJlY3QgYXBwcm9hY2hcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBmZXRjaEludm9pY2VzRGlyZWN0bHkoKTogUHJvbWlzZTxhbnlbXT4ge1xuICBjb25zb2xlLmVycm9yKCfirZAgU3RhcnRpbmcgZGlyZWN0IGludm9pY2UgZmV0Y2ggd2l0aCBhbHRlcm5hdGl2ZSBtZXRob2QnKTtcbiAgXG4gIHRyeSB7XG4gICAgLy8gRmlyc3QsIHZlcmlmeSB3ZSBjYW4gZ2V0IHN0b3JlZCB0b2tlbnNcbiAgICBjb25zdCB0b2tlbnMgPSBnZXRTdG9yZWRUb2tlbigpO1xuICAgIFxuICAgIGlmICghdG9rZW5zIHx8ICF0b2tlbnMuYWNjZXNzVG9rZW4gfHwgIXRva2Vucy5yZWFsbUlkKSB7XG4gICAgICBjb25zb2xlLmVycm9yKCfirZAgTm8gdmFsaWQgdG9rZW5zIGZvciBkaXJlY3QgaW52b2ljZSBmZXRjaCcpO1xuICAgICAgdGhyb3cgbmV3IEVycm9yKCdRdWlja0Jvb2tzIGF1dGhlbnRpY2F0aW9uIHJlcXVpcmVkLiBQbGVhc2UgY29ubmVjdCB5b3VyIGFjY291bnQuJyk7XG4gICAgfVxuICAgIFxuICAgIC8vIFdlJ2xsIHNldCB1cCBhIGZyZXNoIE9BdXRoQ2xpZW50IGluc3RhbmNlIHNwZWNpZmljYWxseSBmb3IgdGhpcyByZXF1ZXN0XG4gICAgY29uc3Qgb2F1dGhDbGllbnRGb3JSZXF1ZXN0ID0gbmV3IE9BdXRoQ2xpZW50KHtcbiAgICAgIGNsaWVudElkOiBwcm9jZXNzLmVudi5RVUlDS0JPT0tTX0NMSUVOVF9JRCEsXG4gICAgICBjbGllbnRTZWNyZXQ6IHByb2Nlc3MuZW52LlFVSUNLQk9PS1NfQ0xJRU5UX1NFQ1JFVCEsXG4gICAgICBlbnZpcm9ubWVudDogJ3NhbmRib3gnLFxuICAgICAgcmVkaXJlY3RVcmk6IGdldFJlZGlyZWN0VXJpKCksXG4gICAgICBsb2dnaW5nOiB0cnVlXG4gICAgfSk7XG4gICAgXG4gICAgLy8gU2V0IHRoZSB0b2tlbnMgb24gdGhlIGNsaWVudFxuICAgIG9hdXRoQ2xpZW50Rm9yUmVxdWVzdC5zZXRUb2tlbih7XG4gICAgICByZWFsbUlkOiB0b2tlbnMucmVhbG1JZCxcbiAgICAgIHRva2VuX3R5cGU6ICdiZWFyZXInLFxuICAgICAgYWNjZXNzX3Rva2VuOiB0b2tlbnMuYWNjZXNzVG9rZW4sXG4gICAgICByZWZyZXNoX3Rva2VuOiB0b2tlbnMucmVmcmVzaFRva2VuIHx8ICcnLFxuICAgICAgZXhwaXJlc19pbjogdG9rZW5zLnRva2VuRXhwaXJ5ID8gTWF0aC5mbG9vcigodG9rZW5zLnRva2VuRXhwaXJ5IC0gRGF0ZS5ub3coKSkgLyAxMDAwKSA6IDM2MDBcbiAgICB9KTtcbiAgICBcbiAgICBjb25zb2xlLmVycm9yKCfirZAgQXR0ZW1wdGluZyBkaXJlY3QgaW52b2ljZSBBUEkgY2FsbCcpO1xuICAgIFxuICAgIC8vIE1ha2UgYSBkaXJlY3QgQVBJIGNhbGwgKG5vdCB1c2luZyBub2RlLXF1aWNrYm9va3MpXG4gICAgcmV0dXJuIG5ldyBQcm9taXNlKChyZXNvbHZlLCByZWplY3QpID0+IHtcbiAgICAgIHRyeSB7XG4gICAgICAgIGNvbnN0IHVybCA9IGBodHRwczovL3NhbmRib3gtcXVpY2tib29rcy5hcGkuaW50dWl0LmNvbS92My9jb21wYW55LyR7dG9rZW5zLnJlYWxtSWR9L3F1ZXJ5YDtcbiAgICAgICAgY29uc3QgaGVhZGVycyA9IHtcbiAgICAgICAgICAnQXV0aG9yaXphdGlvbic6IGBCZWFyZXIgJHt0b2tlbnMuYWNjZXNzVG9rZW59YCxcbiAgICAgICAgICAnQWNjZXB0JzogJ2FwcGxpY2F0aW9uL2pzb24nLFxuICAgICAgICAgICdDb250ZW50LVR5cGUnOiAnYXBwbGljYXRpb24vdGV4dCdcbiAgICAgICAgfTtcbiAgICAgICAgXG4gICAgICAgIC8vIFVzZSBhIHNpbXBsZXIgcXVlcnkgdG8gbWluaW1pemUgcG9zc2libGUgZm9ybWF0IGlzc3Vlc1xuICAgICAgICBjb25zdCBxdWVyeSA9IFwiU0VMRUNUICogRlJPTSBJbnZvaWNlXCI7XG4gICAgICAgIFxuICAgICAgICAvLyBNYWtlIHRoZSBBUEkgY2FsbFxuICAgICAgICBvYXV0aENsaWVudEZvclJlcXVlc3QubWFrZUFwaUNhbGwoe1xuICAgICAgICAgIHVybDogdXJsLFxuICAgICAgICAgIG1ldGhvZDogJ1BPU1QnLFxuICAgICAgICAgIGhlYWRlcnM6IGhlYWRlcnMsXG4gICAgICAgICAgYm9keTogcXVlcnlcbiAgICAgICAgfSwgKGVycjogYW55LCByZXNwb25zZTogYW55KSA9PiB7XG4gICAgICAgICAgaWYgKGVycikge1xuICAgICAgICAgICAgY29uc29sZS5lcnJvcign4q2QIERpcmVjdCBBUEkgY2FsbCBlcnJvcjonLCBlcnIpO1xuICAgICAgICAgICAgcmV0dXJuIHJlamVjdChlcnIpO1xuICAgICAgICAgIH1cbiAgICAgICAgICBcbiAgICAgICAgICB0cnkge1xuICAgICAgICAgICAgLy8gTG9nIHRoZSBlbnRpcmUgcmVzcG9uc2UgZm9yIGRlYnVnZ2luZ1xuICAgICAgICAgICAgY29uc29sZS5lcnJvcign4q2QIERpcmVjdCBBUEkgY2FsbCByZXNwb25zZTonLCByZXNwb25zZSk7XG4gICAgICAgICAgICBcbiAgICAgICAgICAgIGlmICh0eXBlb2YgcmVzcG9uc2UgPT09ICdzdHJpbmcnKSB7XG4gICAgICAgICAgICAgIHJlc3BvbnNlID0gSlNPTi5wYXJzZShyZXNwb25zZSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBcbiAgICAgICAgICAgIC8vIEV4dHJhY3QgaW52b2ljZXMgZGF0YVxuICAgICAgICAgICAgaWYgKHJlc3BvbnNlICYmIHJlc3BvbnNlLlF1ZXJ5UmVzcG9uc2UgJiYgQXJyYXkuaXNBcnJheShyZXNwb25zZS5RdWVyeVJlc3BvbnNlLkludm9pY2UpKSB7XG4gICAgICAgICAgICAgIGNvbnNvbGUuZXJyb3IoYOKtkCBTdWNjZXNzZnVsbHkgZm91bmQgJHtyZXNwb25zZS5RdWVyeVJlc3BvbnNlLkludm9pY2UubGVuZ3RofSBpbnZvaWNlcyBkaXJlY3RseWApO1xuICAgICAgICAgICAgICByZXR1cm4gcmVzb2x2ZShyZXNwb25zZS5RdWVyeVJlc3BvbnNlLkludm9pY2UpO1xuICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgIC8vIElmIHRoZSByZXNwb25zZSBkb2Vzbid0IG1hdGNoIGV4cGVjdGVkIGZvcm1hdCwgdHJ5IHRvIGV4dHJhY3QgdXNlZnVsIGRhdGFcbiAgICAgICAgICAgICAgY29uc29sZS5lcnJvcign4q2QIFVuZXhwZWN0ZWQgcmVzcG9uc2UgZm9ybWF0OicsIHJlc3BvbnNlKTtcbiAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgIC8vIElmIHRoZXJlJ3MgYW55IGRhdGEgdGhhdCBjYW4gYmUgdXNlZCwgcmV0dXJuIGl0XG4gICAgICAgICAgICAgIGlmIChyZXNwb25zZSAmJiB0eXBlb2YgcmVzcG9uc2UgPT09ICdvYmplY3QnKSB7XG4gICAgICAgICAgICAgICAgaWYgKEFycmF5LmlzQXJyYXkocmVzcG9uc2UpKSB7XG4gICAgICAgICAgICAgICAgICByZXR1cm4gcmVzb2x2ZShyZXNwb25zZSk7XG4gICAgICAgICAgICAgICAgfSBlbHNlIGlmIChyZXNwb25zZS5RdWVyeVJlc3BvbnNlKSB7XG4gICAgICAgICAgICAgICAgICByZXR1cm4gcmVzb2x2ZShbcmVzcG9uc2UuUXVlcnlSZXNwb25zZV0pO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgcmV0dXJuIHJlamVjdChuZXcgRXJyb3IoJ0ludmFsaWQgcmVzcG9uc2UgZm9ybWF0IGZyb20gUXVpY2tCb29rcyBBUEknKSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfSBjYXRjaCAocGFyc2VFcnJvcikge1xuICAgICAgICAgICAgY29uc29sZS5lcnJvcign4q2QIEVycm9yIHBhcnNpbmcgZGlyZWN0IEFQSSByZXNwb25zZTonLCBwYXJzZUVycm9yKTtcbiAgICAgICAgICAgIHJldHVybiByZWplY3QocGFyc2VFcnJvcik7XG4gICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICAgIH0gY2F0Y2ggKGFwaUVycm9yKSB7XG4gICAgICAgIGNvbnNvbGUuZXJyb3IoJ+KtkCBFcnJvciBtYWtpbmcgZGlyZWN0IEFQSSBjYWxsOicsIGFwaUVycm9yKTtcbiAgICAgICAgcmV0dXJuIHJlamVjdChhcGlFcnJvcik7XG4gICAgICB9XG4gICAgfSk7XG4gIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgY29uc29sZS5lcnJvcign4q2QIFRvcC1sZXZlbCBlcnJvciBpbiBkaXJlY3QgaW52b2ljZSBmZXRjaDonLCBlcnJvcik7XG4gICAgdGhyb3cgZXJyb3I7XG4gIH1cbn1cblxuLy8gVWx0cmEgbWluaW1hbCBBUEkgY2FsbCBmb3IgUXVpY2tCb29rcyBpbnZvaWNlcyAodGhpcmQgYXBwcm9hY2gpXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gZmV0Y2hJbnZvaWNlc01pY3JvTWV0aG9kKCk6IFByb21pc2U8YW55W10+IHtcbiAgY29uc29sZS5lcnJvcign4q2QIFN0YXJ0aW5nIE1JQ1JPIGludm9pY2UgZmV0Y2ggd2l0aCBiYXJlIG1pbmltdW0gYXBwcm9hY2gnKTtcbiAgXG4gIHRyeSB7XG4gICAgLy8gR2V0IHRva2VucyBkaXJlY3RseSBmcm9tIG1lbW9yeSBzdG9yZSBmaXJzdCBmb3Igc3BlZWRcbiAgICBjb25zdCB0b2tlbnMgPSB0b2tlblN0b3JlLmFjY2Vzc1Rva2VuICYmIHRva2VuU3RvcmUucmVhbG1JZCA/IHtcbiAgICAgIGFjY2Vzc1Rva2VuOiB0b2tlblN0b3JlLmFjY2Vzc1Rva2VuLFxuICAgICAgcmVhbG1JZDogdG9rZW5TdG9yZS5yZWFsbUlkXG4gICAgfSA6IGdldFN0b3JlZFRva2VuKCk7XG4gICAgXG4gICAgaWYgKCF0b2tlbnMgfHwgIXRva2Vucy5hY2Nlc3NUb2tlbiB8fCAhdG9rZW5zLnJlYWxtSWQpIHtcbiAgICAgIGNvbnNvbGUuZXJyb3IoJ+KtkCBObyB2YWxpZCB0b2tlbnMgZm9yIG1pY3JvIGludm9pY2UgZmV0Y2gnKTtcbiAgICAgIHRocm93IG5ldyBFcnJvcignQXV0aGVudGljYXRpb24gcmVxdWlyZWQnKTtcbiAgICB9XG4gICAgXG4gICAgY29uc29sZS5lcnJvcign4q2QIE1pY3JvIG1ldGhvZDogVXNpbmcgbWluaW1hbCBheGlvcy1saWtlIGZldGNoIHdpdGggYmFyZSBBUEkgY2FsbCcpO1xuICAgIFxuICAgIC8vIENyZWF0ZSBhIHByb21pc2Ugd2l0aCBhIHNob3J0IHRpbWVvdXRcbiAgICByZXR1cm4gbmV3IFByb21pc2UoKHJlc29sdmUsIHJlamVjdCkgPT4ge1xuICAgICAgLy8gQ3JlYXRlIGEgdGltZW91dCB0aGF0J3MgbXVjaCBzaG9ydGVyICgxNSBzZWNvbmRzKVxuICAgICAgY29uc3QgdGltZW91dElkID0gc2V0VGltZW91dCgoKSA9PiB7XG4gICAgICAgIGNvbnNvbGUuZXJyb3IoJ+KtkCBNaWNybyBtZXRob2Q6IFJlcXVlc3QgdGltZWQgb3V0IGFmdGVyIDE1IHNlY29uZHMnKTtcbiAgICAgICAgcmVqZWN0KG5ldyBFcnJvcignTWljcm8gbWV0aG9kIHJlcXVlc3QgdGltZWQgb3V0IGFmdGVyIDE1IHNlY29uZHMnKSk7XG4gICAgICB9LCAxNTAwMCk7XG4gICAgICBcbiAgICAgIHRyeSB7XG4gICAgICAgIC8vIFVzaW5nIHRoZSBmZXRjaCBBUEkgZGlyZWN0bHkgaW5zdGVhZCBvZiB0aGUgT0F1dGhDbGllbnQgb3Igbm9kZS1xdWlja2Jvb2tzXG4gICAgICAgIGNvbnN0IHVybCA9IGBodHRwczovL3NhbmRib3gtcXVpY2tib29rcy5hcGkuaW50dWl0LmNvbS92My9jb21wYW55LyR7dG9rZW5zLnJlYWxtSWR9L3F1ZXJ5P3F1ZXJ5PXNlbGVjdCUyMCUyQSUyMGZyb20lMjBJbnZvaWNlJTIwTUFYUkVTVUxUUyUyMDVgO1xuICAgICAgICBcbiAgICAgICAgY29uc29sZS5lcnJvcign4q2QIE1pY3JvIG1ldGhvZDogQ2FsbGluZyBBUEkgZGlyZWN0bHkgYXQgVVJMOicsIHVybCk7XG4gICAgICAgIFxuICAgICAgICBmZXRjaCh1cmwsIHtcbiAgICAgICAgICBtZXRob2Q6ICdHRVQnLFxuICAgICAgICAgIGhlYWRlcnM6IHtcbiAgICAgICAgICAgICdBdXRob3JpemF0aW9uJzogYEJlYXJlciAke3Rva2Vucy5hY2Nlc3NUb2tlbn1gLFxuICAgICAgICAgICAgJ0FjY2VwdCc6ICdhcHBsaWNhdGlvbi9qc29uJyxcbiAgICAgICAgICAgICdDb250ZW50LVR5cGUnOiAnYXBwbGljYXRpb24vanNvbidcbiAgICAgICAgICB9XG4gICAgICAgIH0pXG4gICAgICAgIC50aGVuKHJlc3BvbnNlID0+IHtcbiAgICAgICAgICBjb25zb2xlLmVycm9yKCfirZAgTWljcm8gbWV0aG9kOiBSZWNlaXZlZCByZXNwb25zZSB3aXRoIHN0YXR1czonLCByZXNwb25zZS5zdGF0dXMpO1xuICAgICAgICAgIFxuICAgICAgICAgIGlmICghcmVzcG9uc2Uub2spIHtcbiAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihgQVBJIHJlc3BvbmRlZCB3aXRoIHN0YXR1czogJHtyZXNwb25zZS5zdGF0dXN9YCk7XG4gICAgICAgICAgfVxuICAgICAgICAgIFxuICAgICAgICAgIHJldHVybiByZXNwb25zZS5qc29uKCk7XG4gICAgICAgIH0pXG4gICAgICAgIC50aGVuKGRhdGEgPT4ge1xuICAgICAgICAgIGNvbnNvbGUuZXJyb3IoJ+KtkCBNaWNybyBtZXRob2Q6IFN1Y2Nlc3NmdWxseSBwYXJzZWQgcmVzcG9uc2UgSlNPTicpO1xuICAgICAgICAgIGNsZWFyVGltZW91dCh0aW1lb3V0SWQpO1xuICAgICAgICAgIFxuICAgICAgICAgIC8vIEV4dHJhY3QgaW52b2ljZSBkYXRhIGZyb20gcmVzcG9uc2VcbiAgICAgICAgICBpZiAoZGF0YSAmJiBkYXRhLlF1ZXJ5UmVzcG9uc2UgJiYgQXJyYXkuaXNBcnJheShkYXRhLlF1ZXJ5UmVzcG9uc2UuSW52b2ljZSkpIHtcbiAgICAgICAgICAgIGNvbnNvbGUuZXJyb3IoYOKtkCBNaWNybyBtZXRob2Q6IEZvdW5kICR7ZGF0YS5RdWVyeVJlc3BvbnNlLkludm9pY2UubGVuZ3RofSBpbnZvaWNlc2ApO1xuICAgICAgICAgICAgcmVzb2x2ZShkYXRhLlF1ZXJ5UmVzcG9uc2UuSW52b2ljZSk7XG4gICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIGNvbnNvbGUuZXJyb3IoJ+KtkCBNaWNybyBtZXRob2Q6IFJlc3BvbnNlIGRvZXMgbm90IGNvbnRhaW4gaW52b2ljZSBhcnJheTonLCBkYXRhKTtcbiAgICAgICAgICAgIC8vIElmIHdlIGF0IGxlYXN0IGdvdCBkYXRhIGJ1dCBub3QgaW4gdGhlIGV4cGVjdGVkIGZvcm1hdCwgcmV0dXJuIGFuIGVtcHR5IGFycmF5XG4gICAgICAgICAgICAvLyByYXRoZXIgdGhhbiBmYWlsaW5nIC0gdGhpcyBoZWxwcyB0aGUgVUkgaGFuZGxlIHRoZSBjYXNlIGJldHRlclxuICAgICAgICAgICAgcmVzb2x2ZShbXSk7XG4gICAgICAgICAgfVxuICAgICAgICB9KVxuICAgICAgICAuY2F0Y2goZXJyb3IgPT4ge1xuICAgICAgICAgIGNvbnNvbGUuZXJyb3IoJ+KtkCBNaWNybyBtZXRob2Q6IEZldGNoIGVycm9yOicsIGVycm9yKTtcbiAgICAgICAgICBjbGVhclRpbWVvdXQodGltZW91dElkKTtcbiAgICAgICAgICByZWplY3QoZXJyb3IpO1xuICAgICAgICB9KTtcbiAgICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICAgIGNvbnNvbGUuZXJyb3IoJ+KtkCBNaWNybyBtZXRob2Q6IEV4Y2VwdGlvbiBkdXJpbmcgZmV0Y2ggc2V0dXA6JywgZXJyb3IpO1xuICAgICAgICBjbGVhclRpbWVvdXQodGltZW91dElkKTtcbiAgICAgICAgcmVqZWN0KGVycm9yKTtcbiAgICAgIH1cbiAgICB9KTtcbiAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICBjb25zb2xlLmVycm9yKCfirZAgTWljcm8gbWV0aG9kOiBUb3AtbGV2ZWwgZXJyb3I6JywgZXJyb3IpO1xuICAgIHRocm93IGVycm9yO1xuICB9XG59ICJdLCJuYW1lcyI6WyJPQXV0aENsaWVudCIsIlF1aWNrQm9va3MiLCJjb25zb2xlIiwibG9nIiwiY29uc3RydWN0b3JUeXBlIiwiaXNGdW5jdGlvbiIsIlRPS0VOX0tFWSIsIlJFQUxNX0lEX0tFWSIsIlJFRlJFU0hfVE9LRU5fS0VZIiwiVE9LRU5fRVhQSVJZX0tFWSIsIkRFQlVHIiwiZGVidWdMb2ciLCJhcmdzIiwiZ2V0QmFzZVVybCIsImJhc2VVcmwiLCJwcm9jZXNzIiwiZW52IiwiTkVYVF9QVUJMSUNfQkFTRV9VUkwiLCJzdGFydHNXaXRoIiwicmVwbGFjZSIsImdldFJlZGlyZWN0VXJpIiwib2F1dGhDbGllbnQiLCJxYm8iLCJ0b2tlblN0b3JlIiwiaXNJbml0aWFsaXplZCIsInN0b3JlVG9rZW4iLCJhY2Nlc3NUb2tlbiIsInJlYWxtSWQiLCJyZWZyZXNoVG9rZW4iLCJleHBpcmVzSW4iLCJleHBpcnlUaW1lIiwiRGF0ZSIsIm5vdyIsInRva2VuRXhwaXJ5IiwibG9jYWxTdG9yYWdlIiwic2V0SXRlbSIsInRvU3RyaW5nIiwibG9jYWxTdG9yYWdlRXJyb3IiLCJlcnJvciIsImdldFN0b3JlZFRva2VuIiwiZ2V0SXRlbSIsInRva2VuRXhwaXJ5U3RyIiwicGFyc2VJbnQiLCJ1bmRlZmluZWQiLCJjbGVhclRva2VucyIsInJlbW92ZUl0ZW0iLCJpbml0aWFsaXplUUJPIiwiYWNjZXNzVG9rZW5QcmVzZW50IiwicmVhbG1JZFByZXNlbnQiLCJjbGllbnRJZFByZXNlbnQiLCJRVUlDS0JPT0tTX0NMSUVOVF9JRCIsImNsaWVudFNlY3JldFByZXNlbnQiLCJRVUlDS0JPT0tTX0NMSUVOVF9TRUNSRVQiLCJjbGllbnRJZCIsImNsaWVudFNlY3JldCIsImhhc1FibyIsImhhc1Rva2VuIiwiaGFzUmVhbG1JZCIsImNsaWVudEVycm9yIiwidXNlU2FuZGJveCIsImZhbGxiYWNrRXJyb3IiLCJjaGVja0NsaWVudEluaXRpYWxpemVkIiwic3RvcmVkVG9rZW4iLCJnZXRTZXJ2ZXJTaWRlVG9rZW4iLCJFcnJvciIsImhhc0FjY2Vzc1Rva2VuIiwiaGFzUmVmcmVzaFRva2VuIiwiaW5pdFJlc3VsdCIsIk1hdGgiLCJmbG9vciIsImlzUXVpY2tCb29rc1JlYWR5IiwiaXNSZWFkeSIsIm1hcFF1aWNrQm9va3NJbnZvaWNlIiwicWJJbnZvaWNlIiwiY3VzdG9tZXJOYW1lIiwiQ3VzdG9tZXJSZWYiLCJuYW1lIiwibGluZUl0ZW1zIiwiTGluZSIsIm1hcCIsImxpbmUiLCJpZCIsIklkIiwiZGVzY3JpcHRpb24iLCJEZXNjcmlwdGlvbiIsImFtb3VudCIsIkFtb3VudCIsInF1YW50aXR5IiwiUXVhbnRpdHkiLCJ1bml0UHJpY2UiLCJTYWxlc0l0ZW1MaW5lRGV0YWlsIiwiVW5pdFByaWNlIiwiaW52b2ljZU51bWJlciIsIkRvY051bWJlciIsImRhdGUiLCJUeG5EYXRlIiwiZHVlRGF0ZSIsIkR1ZURhdGUiLCJUb3RhbEFtdCIsImJhbGFuY2UiLCJCYWxhbmNlIiwic3RhdHVzIiwiY3VycmVuY3kiLCJDdXJyZW5jeVJlZiIsInJlZnJlc2hRdWlja0Jvb2tzVG9rZW4iLCJmcmVzaE9BdXRoQ2xpZW50IiwiY3JlYXRlT0F1dGhDbGllbnQiLCJyZWZyZXNoUmVzcG9uc2UiLCJyZWZyZXNoVXNpbmdUb2tlbiIsInJlZnJlc2hEYXRhIiwiZ2V0SnNvbiIsImFjY2Vzc190b2tlbiIsInJlZnJlc2hfdG9rZW4iLCJleHBpcmVzX2luIiwiaW5pdGlhbGl6ZWQiLCJzdWNjZXNzIiwiZmV0Y2hJbnZvaWNlcyIsInRva2VucyIsInRvSVNPU3RyaW5nIiwidG9rZW5FeHBpcmVkIiwiaXNFeHBpcmVkIiwicmVmcmVzaGVkIiwicmVmcmVzaEVycm9yIiwiY2xpZW50RXhpc3RzIiwiaGFzVG9rZW5TZWNyZXQiLCJ0b2tlblNlY3JldCIsIm9hdXRodmVyc2lvbiIsIlByb21pc2UiLCJyZXNvbHZlIiwicmVqZWN0IiwiZmluZEludm9pY2VzIiwiZXJyIiwiZGF0YSIsIkpTT04iLCJzdHJpbmdpZnkiLCJmaWVsZCIsInZhbHVlIiwib3BlcmF0b3IiLCJlcnIyIiwiZGF0YTIiLCJwcm9jZXNzSW52b2ljZVJlc3VsdCIsImJhY2t1cEVycm9yIiwiYXBpQ2FsbEVycm9yIiwibWVzc2FnZSIsIlF1ZXJ5UmVzcG9uc2UiLCJBcnJheSIsImlzQXJyYXkiLCJJbnZvaWNlIiwiaW52b2ljZXMiLCJsZW5ndGgiLCJPYmplY3QiLCJrZXlzIiwiZ2V0SW52b2ljZUJ5SWQiLCJjbGVhbklkIiwidHJpbSIsImdldEludm9pY2UiLCJpbnZvaWNlIiwiY29kZSIsImluY2x1ZGVzIiwic3RhdHVzQ29kZSIsImluaXRpYWxpemVPQXV0aENsaWVudCIsImdldEF1dGhVcmwiLCJoYXNDbGllbnRJZCIsImhhc0NsaWVudFNlY3JldCIsInJlZGlyZWN0VXJpIiwiYXV0aFVybCIsImF1dGhvcml6ZVVyaSIsInNjb3BlIiwic2NvcGVzIiwiQWNjb3VudGluZyIsIk9wZW5JZCIsIlByb2ZpbGUiLCJFbWFpbCIsInN0YXRlIiwiZ2V0UmVkaXJlY3RVcmlGb3JEaXNwbGF5IiwiZ2V0T0F1dGhDbGllbnQiLCJoYW5kbGVDYWxsYmFjayIsInVybCIsInVybFBhcmFtcyIsIlVSTCIsInNlYXJjaFBhcmFtcyIsInJlYWxtSWRGcm9tVXJsIiwiZ2V0IiwidG9rZW5Db25maWciLCJoYXNDb2RlIiwiaGFzUmVkaXJlY3RVcmkiLCJhdXRoUmVzcG9uc2UiLCJjcmVhdGVUb2tlbiIsInRva2VuRGF0YSIsInN0b3JlUmVzdWx0IiwibWlub3J2ZXJzaW9uIiwiZGVidWciLCJyZXF1ZXN0VGltZW91dCIsIm1hbnVhbGx5SW5pdGlhbGl6ZVF1aWNrQm9va3MiLCJyZXN1bHQiLCJlbnZpcm9ubWVudCIsInVwZGF0ZVRva2VuU3RvcmVGcm9tVmFsdWVzIiwiZmV0Y2hJbnZvaWNlc0RpcmVjdGx5Iiwib2F1dGhDbGllbnRGb3JSZXF1ZXN0IiwibG9nZ2luZyIsInNldFRva2VuIiwidG9rZW5fdHlwZSIsImhlYWRlcnMiLCJxdWVyeSIsIm1ha2VBcGlDYWxsIiwibWV0aG9kIiwiYm9keSIsInJlc3BvbnNlIiwicGFyc2UiLCJwYXJzZUVycm9yIiwiYXBpRXJyb3IiLCJmZXRjaEludm9pY2VzTWljcm9NZXRob2QiLCJ0aW1lb3V0SWQiLCJzZXRUaW1lb3V0IiwiZmV0Y2giLCJ0aGVuIiwib2siLCJqc29uIiwiY2xlYXJUaW1lb3V0IiwiY2F0Y2giXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(rsc)/./src/lib/quickbooks/api.ts\n");

/***/ })

};
;

// load runtime
var __webpack_require__ = require("../../../../webpack-runtime.js");
__webpack_require__.C(exports);
var __webpack_exec__ = (moduleId) => (__webpack_require__(__webpack_require__.s = moduleId))
var __webpack_exports__ = __webpack_require__.X(0, ["vendor-chunks/next","vendor-chunks/ajv","vendor-chunks/psl","vendor-chunks/sshpk","vendor-chunks/bluebird","vendor-chunks/mime-db","vendor-chunks/axios","vendor-chunks/readable-stream","vendor-chunks/node-quickbooks","vendor-chunks/request","vendor-chunks/winston","vendor-chunks/underscore","vendor-chunks/tweetnacl","vendor-chunks/fast-xml-parser","vendor-chunks/semver","vendor-chunks/uri-js","vendor-chunks/tough-cookie","vendor-chunks/jsbn","vendor-chunks/color","vendor-chunks/bcrypt-pbkdf","vendor-chunks/async","vendor-chunks/http-signature","vendor-chunks/intuit-oauth","vendor-chunks/logform","vendor-chunks/jsonwebtoken","vendor-chunks/safe-stable-stringify","vendor-chunks/@colors","vendor-chunks/ecc-jsbn","vendor-chunks/follow-redirects","vendor-chunks/debug","vendor-chunks/lodash.includes","vendor-chunks/qs","vendor-chunks/jsprim","vendor-chunks/get-intrinsic","vendor-chunks/form-data","vendor-chunks/aws4","vendor-chunks/asn1","vendor-chunks/fecha","vendor-chunks/json-schema","vendor-chunks/query-string","vendor-chunks/verror","vendor-chunks/winston-transport","vendor-chunks/uuid","vendor-chunks/string_decoder","vendor-chunks/color-name","vendor-chunks/asynckit","vendor-chunks/date-fns","vendor-chunks/jws","vendor-chunks/har-schema","vendor-chunks/@dabh","vendor-chunks/tunnel-agent","vendor-chunks/lodash.once","vendor-chunks/jwa","vendor-chunks/color-string","vendor-chunks/lodash.isinteger","vendor-chunks/ecdsa-sig-formatter","vendor-chunks/assert-plus","vendor-chunks/combined-stream","vendor-chunks/extsprintf","vendor-chunks/forever-agent","vendor-chunks/aws-sign2","vendor-chunks/oauth-sign","vendor-chunks/strnum","vendor-chunks/extend","vendor-chunks/mime-types","vendor-chunks/lodash.isplainobject","vendor-chunks/stack-trace","vendor-chunks/proxy-from-env","vendor-chunks/triple-beam","vendor-chunks/ms","vendor-chunks/request-debug","vendor-chunks/csrf","vendor-chunks/supports-color","vendor-chunks/core-util-is","vendor-chunks/has-symbols","vendor-chunks/kuler","vendor-chunks/decode-uri-component","vendor-chunks/json-schema-traverse","vendor-chunks/delayed-stream","vendor-chunks/har-validator","vendor-chunks/lodash.isstring","vendor-chunks/safer-buffer","vendor-chunks/random-bytes","vendor-chunks/function-bind","vendor-chunks/lodash.isnumber","vendor-chunks/uid-safe","vendor-chunks/caseless","vendor-chunks/fast-json-stable-stringify","vendor-chunks/lodash.isboolean","vendor-chunks/safe-buffer","vendor-chunks/rsa-pem-from-mod-exp","vendor-chunks/es-set-tostringtag","vendor-chunks/fast-deep-equal","vendor-chunks/performance-now","vendor-chunks/tsscmp","vendor-chunks/call-bind-apply-helpers","vendor-chunks/get-proto","vendor-chunks/buffer-equal-constant-time","vendor-chunks/one-time","vendor-chunks/fn.name","vendor-chunks/dunder-proto","vendor-chunks/json-stringify-safe","vendor-chunks/is-typedarray","vendor-chunks/rndm","vendor-chunks/enabled","vendor-chunks/math-intrinsics","vendor-chunks/@babel","vendor-chunks/colorspace","vendor-chunks/is-stream","vendor-chunks/simple-swizzle","vendor-chunks/isstream","vendor-chunks/split-on-first","vendor-chunks/es-errors","vendor-chunks/text-hex","vendor-chunks/filter-obj","vendor-chunks/has-flag","vendor-chunks/is-arrayish","vendor-chunks/es-define-property","vendor-chunks/gopd","vendor-chunks/hasown","vendor-chunks/has-tostringtag","vendor-chunks/strict-uri-encode","vendor-chunks/util-deprecate","vendor-chunks/atob","vendor-chunks/stringify-clone","vendor-chunks/es-object-atoms","vendor-chunks/ai","vendor-chunks/formdata-node","vendor-chunks/nanoid","vendor-chunks/openai","vendor-chunks/form-data-encoder","vendor-chunks/whatwg-url","vendor-chunks/agentkeepalive","vendor-chunks/tr46","vendor-chunks/web-streams-polyfill","vendor-chunks/node-fetch","vendor-chunks/eventsource-parser","vendor-chunks/webidl-conversions","vendor-chunks/humanize-ms","vendor-chunks/event-target-shim","vendor-chunks/abort-controller"], () => (__webpack_exec__("(rsc)/./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Fchat%2Fgroq%2Froute&page=%2Fapi%2Fchat%2Fgroq%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fchat%2Fgroq%2Froute.ts&appDir=C%3A%5CInvoiveManagment%5Csrc%5Capp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=C%3A%5CInvoiveManagment&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D!")));
module.exports = __webpack_exports__;

})();